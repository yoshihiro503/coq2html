
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.classical.mathcomp_extra</title>
<meta name="description" content="Documentation of Coq module mathcomp.classical.mathcomp_extra" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
  <link rel="stylesheet" href="../css/texmath.css">
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
  <script src="../texmath.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module mathcomp.classical.mathcomp_extra</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.PArith.BinPos.html">BinPos</a></span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="id">choice</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">choice.Choice.mixin</span> : <span class="id">choice.Choice.class_of</span> &gt;-&gt; <span class="id">choice.Choice.mixin_of</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">finmap</span> <span class="id">ssralg</span> <span class="id">ssrnum</span> <span class="id">ssrint</span> <span class="id">rat</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">finset</span> <span class="id">interval</span>.<br/>
<br/>
<pre>
(***************************)
(* MathComp 1.15 additions *)
(***************************)
</pre>
<pre>
(******************************************************************************)
(* This files contains lemmas and definitions missing from MathComp.          *)
(*                                                                            *)
(*               f \max g := fun x =&gt; Num.max (f x) (g x)                     *)
(*               f \min g := fun x =&gt; Num.min (f x) (g x)                     *)
(*                oflit f := Some \o f                                        *)
(*          pred_oapp T D := [pred x | oapp (mem D) false x]                  *)
(*                 f \* g := fun x =&gt; f x * g x                               *)
(*                   \- f := fun x =&gt; - f x                                   *)
(*     lteBSide, bnd_simp == multirule to simplify inequalities between       *)
(*                           interval bounds                                  *)
(*               miditv i == middle point of interval i                       *)
(*                                                                            *)
(*               proj i f == f i, where f : forall i, T i                     *)
(*             dfwith f x == fun j =&gt; x if j = i, and f j otherwise           *)
(*                           given x : T i                                    *)
(*                 swap x := (x.2, x.1)                                       *)
(*                                                                            *)
(******************************************************************************)
</pre>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> \* <span class="id">g</span>" (<span class="kwd">at</span> <span class="id">level</span> 40, <span class="id">left</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> \- <span class="id">g</span>" (<span class="kwd">at</span> <span class="id">level</span> 50, <span class="id">left</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "\- <span class="id">f</span>"  (<span class="kwd">at</span> <span class="id">level</span> 35, <span class="id">f</span> <span class="kwd">at</span> <span class="id">level</span> 35).<br/>
<br/>
<span class="id">Number</span> <span class="kwd">Notation</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.BinNums.html#positive">positive</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.PArith.BinPos.html#Pos.of_num_int">Pos.of_num_int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.PArith.BinPos.html#Pos.to_num_uint">Pos.to_num_uint</a></span> : <span class="id">AC_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_sig2_cond">all_sig2_cond</a></span> {<span class="id">I</span> : <span class="kwd">Type</span>} {<span class="id">T</span> : <span class="kwd">Type</span>} (<span class="id">D</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span> : <span class="id">I</span> -&gt; <span class="id">T</span> -&gt; <span class="kwd">Prop</span>) : <span class="id">T</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> : <span class="id">I</span>, <span class="id">D</span> <span class="id">x</span> -&gt; {<span class="id">y</span> : <span class="id">T</span> | <span class="id">P</span> <span class="id">x</span> <span class="id">y</span> &amp; <span class="id">Q</span> <span class="id">x</span> <span class="id">y</span>}) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">f</span> : <span class="kwd">forall</span> <span class="id">x</span> : <span class="id">I</span>, <span class="id">T</span> | <span class="kwd">forall</span> <span class="id">x</span> : <span class="id">I</span>, <span class="id">D</span> <span class="id">x</span> -&gt; <span class="id">P</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">x</span>) &amp; <span class="kwd">forall</span> <span class="id">x</span> : <span class="id">I</span>, <span class="id">D</span> <span class="id">x</span> -&gt; <span class="id">Q</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">x</span>)}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#all_sig_cond">all_sig_cond</a></span>/[<span class="id">apply</span>]-[<span class="id">f</span> <span class="id">Pf</span>]; <span class="kwd">exists</span> <span class="id">f</span> =&gt; <span class="id">i</span> <span class="id">Di</span>; <span class="id">have</span> [] := <span class="id">Pf</span> <span class="id">i</span> <span class="id">Di</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="olift">olift</a></span> <span class="id">aT</span> <span class="id">rT</span> (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> \<span class="id">o</span> <span class="id">f</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oapp_comp">oapp_comp</a></span> <span class="id">aT</span> <span class="id">rT</span> <span class="id">sT</span> (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) (<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id">sT</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) <span class="id">x</span> =1 (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> <span class="id">_</span> <span class="id">_</span>)^~ <span class="id">x</span> <span class="id">g</span> \<span class="id">o</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="kwd">by</span> <span class="id">case</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="olift_comp">olift_comp</a></span> <span class="id">aT</span> <span class="id">rT</span> <span class="id">sT</span> (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) (<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#olift">olift</a></span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#olift">olift</a></span> <span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compA">compA</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">A</span>) (<span class="id">g</span> : <span class="id">C</span> -&gt; <span class="id">B</span>) (<span class="id">h</span> : <span class="id">D</span> -&gt; <span class="id">C</span>) :<br/>
&nbsp;&nbsp;<span class="id">f</span> \<span class="id">o</span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">h</span>) = (<span class="id">f</span> \<span class="id">o</span> <span class="id">g</span>) \<span class="id">o</span> <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="can_in_pcan">can_in_pcan</a></span> [<span class="id">rT</span> <span class="id">aT</span> : <span class="kwd">Type</span>] (<span class="id">A</span> : {<span class="id">pred</span> <span class="id">aT</span>}) [<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>] [<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id">aT</span>] :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">A</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id">f</span> <span class="id">g</span>} -&gt; {<span class="kwd">in</span> <span class="id">A</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#pcancel">pcancel</a></span> <span class="id">f</span> (<span class="kwd">fun</span> <span class="id">y</span> : <span class="id">rT</span> =&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">g</span> <span class="id">y</span>))}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fK</span> <span class="id">x</span> <span class="id">Ax</span>; <span class="id">rewrite</span> <span class="id">fK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pcan_in_inj">pcan_in_inj</a></span> [<span class="id">rT</span> <span class="id">aT</span> : <span class="kwd">Type</span>] [<span class="id">A</span> : {<span class="id">pred</span> <span class="id">aT</span>}] [<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>] [<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">aT</span>] :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">A</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#pcancel">pcancel</a></span> <span class="id">f</span> <span class="id">g</span>} -&gt; {<span class="kwd">in</span> <span class="id">A</span> &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> <span class="id">f</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fK</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Ax</span> <span class="id">Ay</span> /(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#congr1">congr1</a></span> <span class="id">g</span>); <span class="id">rewrite</span> !<span class="id">fK</span>// =&gt; -[]. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pred_oapp">pred_oapp</a></span> <span class="id">T</span> (<span class="id">D</span> : {<span class="id">pred</span> <span class="id">T</span>}) : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">T</span>) :=<br/>
&nbsp;&nbsp;[<span class="id">pred</span> <span class="id">x</span> | <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#mem">mem</a></span> <span class="id">D</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">x</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ocan_in_comp">ocan_in_comp</a></span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>] (<span class="id">D</span> : {<span class="id">pred</span> <span class="id">B</span>}) (<span class="id">D</span>' : {<span class="id">pred</span> <span class="id">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>] [<span class="id">h</span> : <span class="id">C</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span>' : <span class="id">A</span> -&gt; <span class="id">B</span>] [<span class="id">h</span>' : <span class="id">B</span> -&gt; <span class="id">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id">homo</span> <span class="id">h</span> : <span class="id">x</span> / <span class="id">x</span> \<span class="kwd">in</span> <span class="id">D</span>' &gt;-&gt; <span class="id">x</span> \<span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#pred_oapp">pred_oapp</a></span> <span class="id">D</span>} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> <span class="id">f</span> <span class="id">f</span>'} -&gt; {<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> <span class="id">h</span> <span class="id">h</span>'} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#obind">obind</a></span> <span class="id">f</span> \<span class="id">o</span> <span class="id">h</span>) (<span class="id">h</span>' \<span class="id">o</span> <span class="id">f</span>')}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">move</span>=&gt; <span class="id">hD</span> <span class="id">fK</span> <span class="id">hK</span> <span class="id">c</span> <span class="id">cD</span> /=; <span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">hK</span>/=; <span class="id">case</span> <span class="id">hcE</span> : (<span class="id">h</span> <span class="id">c</span>) =&gt; [<span class="id">b</span>|]//=.<br/>
<span class="id">have</span> <span class="id">bD</span> : <span class="id">b</span> \<span class="kwd">in</span> <span class="id">D</span> <span class="kwd">by</span> <span class="id">have</span> := <span class="id">hD</span> <span class="id">_</span> <span class="id">cD</span>; <span class="id">rewrite</span> <span class="id">hcE</span> <span class="id">inE</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">b</span> <span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">fK</span>; <span class="id">case</span>: (<span class="id">f</span> <span class="id">b</span>) =&gt; //=; <span class="id">have</span> /<span class="id">hK</span> := <span class="id">cD</span>; <span class="id">rewrite</span> <span class="id">hcE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eqbRL">eqbRL</a></span> (<span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) : <span class="id">b1</span> = <span class="id">b2</span> -&gt; <span class="id">b2</span> -&gt; <span class="id">b1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="kwd">by</span> <span class="id">move</span>-&gt;. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mul_fun">mul_fun</a></span> <span class="id">T</span> (<span class="id">R</span> : <span class="id">ringType</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) <span class="id">x</span> := (<span class="id">f</span> <span class="id">x</span> * <span class="id">g</span> <span class="id">x</span>)%<span class="id">R</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">f</span> \* <span class="id">g</span>" := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#mul_fun">mul_fun</a></span> <span class="id">f</span> <span class="id">g</span>) : <span class="id">ring_scope</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#mul_fun">mul_fun</a></span> {<span class="id">T</span> <span class="id">R</span>} <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> /.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="opp_fun">opp_fun</a></span> <span class="id">T</span> (<span class="id">R</span> : <span class="id">zmodType</span>) (<span class="id">f</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) <span class="id">x</span> := (- <span class="id">f</span> <span class="id">x</span>)%<span class="id">R</span>.<br/>
<span class="kwd">Notation</span> "\- <span class="id">f</span>" := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#opp_fun">opp_fun</a></span> <span class="id">f</span>) : <span class="id">ring_scope</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#opp_fun">opp_fun</a></span> {<span class="id">T</span> <span class="id">R</span>} <span class="id">_</span> <span class="id">_</span> /.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id"><a name="pair_of_interval">pair_of_interval</a></span> <span class="id">T</span> (<span class="id">I</span> : <span class="id">interval</span> <span class="id">T</span>) : <span class="id">itv_bound</span> <span class="id">T</span> * <span class="id">itv_bound</span> <span class="id">T</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">Interval</span> <span class="id">b1</span> <span class="id">b2</span> := <span class="id">I</span> <span class="kwd">in</span> (<span class="id">b1</span>, <span class="id">b2</span>).<br/>
<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Theory</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="itv_simp">itv_simp</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="itv_simp.d">d</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span class="id"><a name="itv_simp.T">T</a></span> : <span class="id">porderType</span> <span class="id">d</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltBSide">ltBSide</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> <span class="id">b</span>' :<br/>
&nbsp;&nbsp;((<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt; <span class="id">BSide</span> <span class="id">b</span>' <span class="id">y</span>) = (<span class="id">x</span> &lt; <span class="id">y</span> ?&lt;= <span class="kwd">if</span> <span class="id">b</span> &amp;&amp; ~~ <span class="id">b</span>'))%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="leBSide">leBSide</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> <span class="id">b</span>' :<br/>
&nbsp;&nbsp;((<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt;= <span class="id">BSide</span> <span class="id">b</span>' <span class="id">y</span>) = (<span class="id">x</span> &lt; <span class="id">y</span> ?&lt;= <span class="kwd">if</span> <span class="id">b</span>' ==&gt; <span class="id">b</span>))%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lteBSide">lteBSide</a></span> := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltBSide">ltBSide</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leBSide">leBSide</a></span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BLeft_ltE">BLeft_ltE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt; <span class="id">BLeft</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt; <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BRight_leE">BRight_leE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt;= <span class="id">BRight</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt;= <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BRight_BLeft_leE">BRight_BLeft_leE</a></span> <span class="id">x</span> <span class="id">y</span> : (<span class="id">BRight</span> <span class="id">x</span> &lt;= <span class="id">BLeft</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt; <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
 <span class="kwd">by</span> []. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BLeft_BRight_ltE">BLeft_BRight_ltE</a></span> <span class="id">x</span> <span class="id">y</span> : (<span class="id">BLeft</span> <span class="id">x</span> &lt; <span class="id">BRight</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt;= <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
 <span class="kwd">by</span> []. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BRight_BSide_ltE">BRight_BSide_ltE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BRight</span> <span class="id">x</span> &lt; <span class="id">BSide</span> <span class="id">b</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt; <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BLeft_BSide_leE">BLeft_BSide_leE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BLeft</span> <span class="id">x</span> &lt;= <span class="id">BSide</span> <span class="id">b</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt;= <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BSide_ltE">BSide_ltE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt; <span class="id">BSide</span> <span class="id">b</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt; <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BSide_leE">BSide_leE</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">b</span> : (<span class="id">BSide</span> <span class="id">b</span> <span class="id">x</span> &lt;= <span class="id">BSide</span> <span class="id">b</span> <span class="id">y</span>)%<span class="id">O</span> = (<span class="id">x</span> &lt;= <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_leE">BInfty_leE</a></span> <span class="id">a</span> : (<span class="id">a</span> &lt;= <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>)%<span class="id">O</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_geE">BInfty_geE</a></span> <span class="id">a</span> : (<span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> &lt;= <span class="id">a</span>)%<span class="id">O</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_le_eqE">BInfty_le_eqE</a></span> <span class="id">a</span> : (<span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span> &lt;= <span class="id">a</span>)%<span class="id">O</span> = (<span class="id">a</span> == <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_ge_eqE">BInfty_ge_eqE</a></span> <span class="id">a</span> : (<span class="id">a</span> &lt;= <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>)%<span class="id">O</span> = (<span class="id">a</span> == <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_ltE">BInfty_ltE</a></span> <span class="id">a</span> : (<span class="id">a</span> &lt; <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>)%<span class="id">O</span> = (<span class="id">a</span> != <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_gtE">BInfty_gtE</a></span> <span class="id">a</span> : (<span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> &lt; <span class="id">a</span>)%<span class="id">O</span> = (<span class="id">a</span> != <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_ltF">BInfty_ltF</a></span> <span class="id">a</span> : (<span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span> &lt; <span class="id">a</span>)%<span class="id">O</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_gtF">BInfty_gtF</a></span> <span class="id">a</span> : (<span class="id">a</span> &lt; <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>)%<span class="id">O</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="itv_simp.BInfty_BInfty_ltE">BInfty_BInfty_ltE</a></span> : (<span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> &lt; <span class="id">BInfty</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>)%<span class="id">O</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltBRight_leBLeft">ltBRight_leBLeft</a></span> (<span class="id">a</span> : <span class="id">itv_bound</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) (<span class="id">r</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">a</span> &lt; <span class="id">BRight</span> <span class="id">r</span>)%<span class="id">O</span> = (<span class="id">a</span> &lt;= <span class="id">BLeft</span> <span class="id">r</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="leBRight_ltBLeft">leBRight_ltBLeft</a></span> (<span class="id">a</span> : <span class="id">itv_bound</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) (<span class="id">r</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">BRight</span> <span class="id">r</span> &lt;= <span class="id">a</span>)%<span class="id">O</span> = (<span class="id">BLeft</span> <span class="id">r</span> &lt; <span class="id">a</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">a</span> =&gt; [[] <span class="id">a</span>|[]]. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bnd_simp">bnd_simp</a></span> := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BLeft_ltE">BLeft_ltE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BRight_leE">BRight_leE</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BRight_BLeft_leE">BRight_BLeft_leE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BLeft_BRight_ltE">BLeft_BRight_ltE</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BRight_BSide_ltE">BRight_BSide_ltE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BLeft_BSide_leE">BLeft_BSide_leE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BSide_ltE">BSide_ltE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BSide_leE">BSide_leE</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_leE">BInfty_leE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_geE">BInfty_geE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_BInfty_ltE">BInfty_BInfty_ltE</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_le_eqE">BInfty_le_eqE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_ge_eqE">BInfty_ge_eqE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_ltE">BInfty_ltE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_gtE">BInfty_gtE</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_ltF">BInfty_ltF</a></span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.BInfty_gtF">BInfty_gtF</a></span>,<br/>
&nbsp;&nbsp;@<span class="id">lexx</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>, @<span class="id">ltxx</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>, @<span class="id">eqxx</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="itv_splitU1">itv_splitU1</a></span> (<span class="id">a</span> : <span class="id">itv_bound</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) (<span class="id">x</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) : (<span class="id">a</span> &lt;= <span class="id">BLeft</span> <span class="id">x</span>)%<span class="id">O</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Interval</span> <span class="id">a</span> (<span class="id">BRight</span> <span class="id">x</span>) =<span class="id">i</span> [<span class="id">predU1</span> <span class="id">x</span> &amp; <span class="id">Interval</span> <span class="id">a</span> (<span class="id">BLeft</span> <span class="id">x</span>)].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move</span>=&gt; <span class="id">ax</span> <span class="id">z</span>; <span class="id">rewrite</span> !<span class="id">inE</span>/= !<span class="id">subitvE</span> ?<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bnd_simp">bnd_simp</a></span>//= <span class="id">lt_neqAle</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">eqVneq</span> <span class="id">z</span> <span class="id">x</span>) =&gt; [-&gt;|]//=; <span class="id">rewrite</span> <span class="id">lexx</span> <span class="id">ax</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="itv_split1U">itv_split1U</a></span> (<span class="id">a</span> : <span class="id">itv_bound</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) (<span class="id">x</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp.T">T</a></span>) : (<span class="id">BRight</span> <span class="id">x</span> &lt;= <span class="id">a</span>)%<span class="id">O</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Interval</span> (<span class="id">BLeft</span> <span class="id">x</span>) <span class="id">a</span> =<span class="id">i</span> [<span class="id">predU1</span> <span class="id">x</span> &amp; <span class="id">Interval</span> (<span class="id">BRight</span> <span class="id">x</span>) <span class="id">a</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">move</span>=&gt; <span class="id">ax</span> <span class="id">z</span>; <span class="id">rewrite</span> !<span class="id">inE</span>/= !<span class="id">subitvE</span> ?<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bnd_simp">bnd_simp</a></span>//= <span class="id">lt_neqAle</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">eqVneq</span> <span class="id">z</span> <span class="id">x</span>) =&gt; [-&gt;|]//=; <span class="id">rewrite</span> <span class="id">lexx</span> <span class="id">ax</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_simp">itv_simp</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="miditv">miditv</a></span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">i</span> : <span class="id">interval</span> <span class="id">R</span>) : <span class="id">R</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">i</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Interval</span> (<span class="id">BSide</span> <span class="id">_</span> <span class="id">a</span>) (<span class="id">BSide</span> <span class="id">_</span> <span class="id">b</span>) =&gt; (<span class="id">a</span> + <span class="id">b</span>) / 2%:<span class="id">R</span><br/>
&nbsp;&nbsp;| <span class="id">Interval</span> -<span class="id">oo</span>%<span class="id">O</span> (<span class="id">BSide</span> <span class="id">_</span> <span class="id">b</span>) =&gt; <span class="id">b</span> - 1<br/>
&nbsp;&nbsp;| <span class="id">Interval</span> (<span class="id">BSide</span> <span class="id">_</span> <span class="id">a</span>) +<span class="id">oo</span>%<span class="id">O</span> =&gt; <span class="id">a</span> + 1<br/>
&nbsp;&nbsp;| <span class="id">Interval</span> -<span class="id">oo</span>%<span class="id">O</span> +<span class="id">oo</span>%<span class="id">O</span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; 0<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="miditv_lemmas">miditv_lemmas</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="miditv_lemmas.R">R</a></span> : <span class="id">numFieldType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">i</span> : <span class="id">interval</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#miditv_lemmas.R">R</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mem_miditv">mem_miditv</a></span> <span class="id">i</span> : (<span class="id">i</span>.1 &lt; <span class="id">i</span>.2)%<span class="id">O</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#miditv">miditv</a></span> <span class="id">i</span> \<span class="kwd">in</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">move</span>: <span class="id">i</span> =&gt; [[<span class="id">ba</span> <span class="id">a</span>|[]] [<span class="id">bb</span> <span class="id">b</span>|[]]] //= <span class="id">ab</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">mid_in_itv</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">in_itv</span> -<span class="id">lteif_subl_addl</span> <span class="id">subrr</span> <span class="id">lteif01</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">in_itv</span> <span class="id">lteif_subl_addr</span> -<span class="id">lteif_subl_addl</span> <span class="id">subrr</span> <span class="id">lteif01</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="miditv_le_left">miditv_le_left</a></span> <span class="id">i</span> <span class="id">b</span> : (<span class="id">i</span>.1 &lt; <span class="id">i</span>.2)%<span class="id">O</span> -&gt; (<span class="id">BSide</span> <span class="id">b</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#miditv">miditv</a></span> <span class="id">i</span>) &lt;= <span class="id">i</span>.2)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">case</span>: <span class="id">i</span> =&gt; [<span class="id">x</span> <span class="id">y</span>] <span class="id">lti</span>; <span class="id">have</span> := <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#mem_miditv">mem_miditv</a></span> <span class="id">lti</span>; <span class="id">rewrite</span> <span class="id">inE</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">_</span> ].<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_trans</span>; <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bnd_simp">bnd_simp</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="miditv_ge_right">miditv_ge_right</a></span> <span class="id">i</span> <span class="id">b</span> : (<span class="id">i</span>.1 &lt; <span class="id">i</span>.2)%<span class="id">O</span> -&gt; (<span class="id">i</span>.1 &lt;= <span class="id">BSide</span> <span class="id">b</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#miditv">miditv</a></span> <span class="id">i</span>))%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">case</span>: <span class="id">i</span> =&gt; [<span class="id">x</span> <span class="id">y</span>] <span class="id">lti</span>; <span class="id">have</span> := <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#mem_miditv">mem_miditv</a></span> <span class="id">lti</span>; <span class="id">rewrite</span> <span class="id">inE</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[+ <span class="id">_</span>].<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">le_trans</span>; <span class="id">apply</span>; <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bnd_simp">bnd_simp</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#miditv_lemmas">miditv_lemmas</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="itv_porderType">itv_porderType</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="itv_porderType.d">d</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span class="id"><a name="itv_porderType.T">T</a></span> : <span class="id">orderType</span> <span class="id">d</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">a</span> : <span class="id">itv_bound</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_porderType.T">T</a></span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_porderType.T">T</a></span>) (<span class="id">i</span> <span class="id">j</span> : <span class="id">interval</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_porderType.T">T</a></span>) (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="predC_itvl">predC_itvl</a></span> <span class="id">a</span> : [<span class="id">predC</span> <span class="id">Interval</span> -<span class="id">oo</span>%<span class="id">O</span> <span class="id">a</span>] =<span class="id">i</span> <span class="id">Interval</span> <span class="id">a</span> +<span class="id">oo</span>%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">case</span>: <span class="id">a</span> =&gt; [<span class="id">b</span> <span class="id">x</span>|[]//] <span class="id">y</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">inE</span> !<span class="id">subitvE</span>/= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bnd_simp">bnd_simp</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#lteBSide">lteBSide</a></span>/= <span class="id">lteifNE</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="predC_itvr">predC_itvr</a></span> <span class="id">a</span> : [<span class="id">predC</span> <span class="id">Interval</span> <span class="id">a</span> +<span class="id">oo</span>%<span class="id">O</span>] =<span class="id">i</span> <span class="id">Interval</span> -<span class="id">oo</span>%<span class="id">O</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span>; <span class="id">rewrite</span> <span class="id">inE</span>/= -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#predC_itvl">predC_itvl</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="predC_itv">predC_itv</a></span> <span class="id">i</span> : [<span class="id">predC</span> <span class="id">i</span>] =<span class="id">i</span> [<span class="id">predU</span> <span class="id">Interval</span> -<span class="id">oo</span>%<span class="id">O</span> <span class="id">i</span>.1 &amp; <span class="id">Interval</span> <span class="id">i</span>.2 +<span class="id">oo</span>%<span class="id">O</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">case</span>: <span class="id">i</span> =&gt; [<span class="id">a</span> <span class="id">a</span>']; <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">inE</span>/= <span class="id">itv_splitI</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negb_and">negb_and</a></span>.<br/>
<span class="kwd">by</span> <span class="id">symmetry</span>; <span class="id">rewrite</span> <span class="id">inE</span>/= -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#predC_itvl">predC_itvl</a></span> -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#predC_itvr">predC_itvr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itv_porderType">itv_porderType</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sumr_le0">sumr_le0</a></span> (<span class="id">R</span> : <span class="id">numDomainType</span>) <span class="id">I</span> (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F</span> <span class="id">i</span> &lt;= 0)%<span class="id">R</span> -&gt; (\<span class="id">sum_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= 0)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">F0</span>; <span class="id">elim</span>/<span class="id">big_rec</span> : <span class="id">_</span> =&gt; // <span class="id">i</span> <span class="id">x</span> <span class="id">Pi</span>; <span class="id">apply</span>/<span class="id">ler_naddl</span>/<span class="id">F0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="enum_ord0">enum_ord0</a></span> : <span class="id">enum</span> '<span class="id">I_0</span> = [::].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> -<span class="id">size_eq0</span> <span class="id">size_enum_ord</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="enum_ordSr">enum_ordSr</a></span> <span class="id">n</span> : <span class="id">enum</span> '<span class="id">I_n</span>.+1 =<br/>
&nbsp;&nbsp;<span class="id">rcons</span> (<span class="id">map</span> (<span class="id">widen_ord</span> (<span class="id">leqnSn</span> <span class="id">_</span>)) (<span class="id">enum</span> '<span class="id">I_n</span>)) <span class="id">ord_max</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">apply</span>: (<span class="id">inj_map</span> <span class="id">val_inj</span>); <span class="id">rewrite</span> <span class="id">val_enum_ord</span>.<br/>
<span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">iota</span> <span class="id">_</span>  <span class="id">_</span>]<span class="id">addn1</span> <span class="id">iotaD</span>/= <span class="id">cats1</span> <span class="id">map_rcons</span>; <span class="id">congr</span> (<span class="id">rcons</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">map_comp</span>/= (@<span class="id">eq_map</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">val</span>) ?<span class="id">val_enum_ord</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="obindEapp">obindEapp</a></span> {<span class="id">aT</span> <span class="id">rT</span>} (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">rT</span>) : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#obind">obind</a></span> <span class="id">f</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> <span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="omapEbind">omapEbind</a></span> {<span class="id">aT</span> <span class="id">rT</span>} (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">f</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#obind">obind</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#olift">olift</a></span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="omapEapp">omapEapp</a></span> {<span class="id">aT</span> <span class="id">rT</span>} (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">f</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#olift">olift</a></span> <span class="id">f</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oappEmap">oappEmap</a></span> {<span class="id">aT</span> <span class="id">rT</span>} (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) (<span class="id">y0</span> : <span class="id">rT</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> <span class="id">f</span> <span class="id">y0</span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#odflt">odflt</a></span> <span class="id">y0</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">f</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="omap_comp">omap_comp</a></span> <span class="id">aT</span> <span class="id">rT</span> <span class="id">sT</span> (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) (<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id">sT</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) =1 <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">g</span> \<span class="id">o</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#omap">omap</a></span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
 <span class="kwd">by</span> <span class="id">case</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oapp_comp_f">oapp_comp_f</a></span> {<span class="id">aT</span> <span class="id">rT</span> <span class="id">sT</span>} (<span class="id">f</span> : <span class="id">aT</span> -&gt; <span class="id">rT</span>) (<span class="id">g</span> : <span class="id">rT</span> -&gt; <span class="id">sT</span>) (<span class="id">x</span> : <span class="id">rT</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) (<span class="id">g</span> <span class="id">x</span>) =1 <span class="id">g</span> \<span class="id">o</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
 <span class="kwd">by</span> <span class="id">case</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="can_in_comp">can_in_comp</a></span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>] (<span class="id">D</span> : {<span class="id">pred</span> <span class="id">B</span>}) (<span class="id">D</span>' : {<span class="id">pred</span> <span class="id">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">A</span>] [<span class="id">h</span> : <span class="id">C</span> -&gt; <span class="id">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span>' : <span class="id">A</span> -&gt; <span class="id">B</span>] [<span class="id">h</span>' : <span class="id">B</span> -&gt; <span class="id">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id">homo</span> <span class="id">h</span> : <span class="id">x</span> / <span class="id">x</span> \<span class="kwd">in</span> <span class="id">D</span>' &gt;-&gt; <span class="id">x</span> \<span class="kwd">in</span> <span class="id">D</span>} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id">f</span> <span class="id">f</span>'} -&gt; {<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id">h</span> <span class="id">h</span>'} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> (<span class="id">f</span> \<span class="id">o</span> <span class="id">h</span>) (<span class="id">h</span>' \<span class="id">o</span> <span class="id">f</span>')}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">hD</span> <span class="id">fK</span> <span class="id">hK</span> <span class="id">c</span> <span class="id">cD</span> /=; <span class="id">rewrite</span> <span class="id">fK</span> ?<span class="id">hK</span> ?<span class="id">hD</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_inj_comp">in_inj_comp</a></span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">A</span>) (<span class="id">h</span> : <span class="id">C</span> -&gt; <span class="id">B</span>) (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">B</span>) (<span class="id">Q</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">C</span>) :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">P</span> &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> <span class="id">f</span>} -&gt; {<span class="kwd">in</span> <span class="id">Q</span> &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> <span class="id">h</span>} -&gt; {<span class="id">homo</span> <span class="id">h</span> : <span class="id">x</span> / <span class="id">Q</span> <span class="id">x</span> &gt;-&gt; <span class="id">P</span> <span class="id">x</span>} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Q</span> &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> (<span class="id">f</span> \<span class="id">o</span> <span class="id">h</span>)}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pf</span> <span class="id">Qh</span> <span class="id">QP</span> <span class="id">x</span> <span class="id">y</span> <span class="id">xQ</span> <span class="id">yQ</span> <span class="id">xy</span>; <span class="id">apply</span> <span class="id">Qh</span> =&gt; //; <span class="id">apply</span> <span class="id">Pf</span> =&gt; //; <span class="id">apply</span> <span class="id">QP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pcan_in_comp">pcan_in_comp</a></span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>] (<span class="id">D</span> : {<span class="id">pred</span> <span class="id">B</span>}) (<span class="id">D</span>' : {<span class="id">pred</span> <span class="id">C</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id">A</span>] [<span class="id">h</span> : <span class="id">C</span> -&gt; <span class="id">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span>' : <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span>] [<span class="id">h</span>' : <span class="id">B</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">C</span>] :<br/>
&nbsp;&nbsp;{<span class="id">homo</span> <span class="id">h</span> : <span class="id">x</span> / <span class="id">x</span> \<span class="kwd">in</span> <span class="id">D</span>' &gt;-&gt; <span class="id">x</span> \<span class="kwd">in</span> <span class="id">D</span>} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#pcancel">pcancel</a></span> <span class="id">f</span> <span class="id">f</span>'} -&gt; {<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#pcancel">pcancel</a></span> <span class="id">h</span> <span class="id">h</span>'} -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">D</span>', <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#pcancel">pcancel</a></span> (<span class="id">f</span> \<span class="id">o</span> <span class="id">h</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#obind">obind</a></span> <span class="id">h</span>' \<span class="id">o</span> <span class="id">f</span>')}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">hD</span> <span class="id">fK</span> <span class="id">hK</span> <span class="id">c</span> <span class="id">cD</span> /=; <span class="id">rewrite</span> <span class="id">fK</span>/= ?<span class="id">hK</span> ?<span class="id">hD</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ocan_comp">ocan_comp</a></span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> : <span class="kwd">Type</span>] [<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>] [<span class="id">h</span> : <span class="id">C</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">B</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">f</span>' : <span class="id">A</span> -&gt; <span class="id">B</span>] [<span class="id">h</span>' : <span class="id">B</span> -&gt; <span class="id">C</span>] :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> <span class="id">f</span> <span class="id">f</span>' -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> <span class="id">h</span> <span class="id">h</span>' -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#ocancel">ocancel</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#obind">obind</a></span> <span class="id">f</span> \<span class="id">o</span> <span class="id">h</span>) (<span class="id">h</span>' \<span class="id">o</span> <span class="id">f</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">move</span>=&gt; <span class="id">fK</span> <span class="id">hK</span> <span class="id">c</span> /=; <span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">hK</span>/=; <span class="id">case</span> <span class="id">hcE</span> : (<span class="id">h</span> <span class="id">c</span>) =&gt; [<span class="id">b</span>|]//=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">b</span> <span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">fK</span>; <span class="id">case</span>: (<span class="id">f</span> <span class="id">b</span>) =&gt; //=; <span class="id">have</span> := <span class="id">hK</span> <span class="id">c</span>; <span class="id">rewrite</span> <span class="id">hcE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eqbLR">eqbLR</a></span> (<span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) : <span class="id">b1</span> = <span class="id">b2</span> -&gt; <span class="id">b1</span> -&gt; <span class="id">b2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
 <span class="kwd">by</span> <span class="id">move</span>-&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="gtr_opp">gtr_opp</a></span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">r</span> : <span class="id">R</span>) : (0 &lt; <span class="id">r</span>)%<span class="id">R</span> -&gt; (- <span class="id">r</span> &lt; <span class="id">r</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n0</span>; <span class="id">rewrite</span> -<span class="id">subr_lt0</span> -<span class="id">opprD</span> <span class="id">oppr_lt0</span> <span class="id">addr_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_le_trans">le_le_trans</a></span> {<span class="id">disp</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>} {<span class="id">T</span> : <span class="id">porderType</span> <span class="id">disp</span>} (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">t</span> : <span class="id">T</span>) :<br/>
&nbsp;&nbsp;(<span class="id">z</span> &lt;= <span class="id">x</span>)%<span class="id">O</span> -&gt; (<span class="id">y</span> &lt;= <span class="id">t</span>)%<span class="id">O</span> -&gt; (<span class="id">x</span> &lt;= <span class="id">y</span>)%<span class="id">O</span> -&gt; (<span class="id">z</span> &lt;= <span class="id">t</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; + /(<span class="id">le_trans</span> <span class="id">_</span>)/[<span class="id">apply</span>]; <span class="id">apply</span>: <span class="id">le_trans</span>. Qed.</div>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="eqLHS">eqLHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">X</span> == <span class="id">_</span>))%<span class="id">pattern</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="eqRHS">eqRHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> == <span class="id">X</span>))%<span class="id">pattern</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="leLHS">leLHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">X</span> &lt;= <span class="id">_</span>)%<span class="id">O</span>)%<span class="id">pattern</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="leRHS">leRHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> &lt;= <span class="id">X</span>)%<span class="id">O</span>)%<span class="id">pattern</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="ltLHS">ltLHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">X</span> &lt; <span class="id">_</span>)%<span class="id">O</span>)%<span class="id">pattern</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="ltRHS">ltRHS</a></span> := (<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> &lt; <span class="id">X</span>)%<span class="id">O</span>)%<span class="id">pattern</span>.<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="boxed">boxed</a></span> <span class="id">T</span> := <span class="id"><a name="Box">Box</a></span> <span class="id">of</span> <span class="id">T</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_bigl_supp">eq_bigl_supp</a></span> [<span class="id">R</span> : <span class="id">eqType</span>] [<span class="id">idx</span> : <span class="id">R</span>] [<span class="id">op</span> : <span class="id">Monoid.law</span> <span class="id">idx</span>] [<span class="id">I</span> : <span class="kwd">Type</span>]<br/>
&nbsp;&nbsp;[<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>] [<span class="id">P1</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>] (<span class="id">P2</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> [<span class="id">pred</span> <span class="id">x</span> | <span class="id">F</span> <span class="id">x</span> != <span class="id">idx</span>], <span class="id">P1</span> =1 <span class="id">P2</span>} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P1</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P2</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="id">move</span>=&gt; <span class="id">P12</span>; <span class="id">rewrite</span> <span class="id">big_mkcond</span> [<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">big_mkcond</span>; <span class="id">apply</span>: <span class="id">eq_bigr</span> =&gt; <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">eqVneq</span> (<span class="id">F</span> <span class="id">i</span>) <span class="id">idx</span>) =&gt; [-&gt;|/<span class="id">P12</span>-&gt;]; <span class="id">rewrite</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#if_same">if_same</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="perm_big_supp_cond">perm_big_supp_cond</a></span> [<span class="id">R</span> : <span class="id">eqType</span>] [<span class="id">idx</span> : <span class="id">R</span>] [<span class="id">op</span> : <span class="id">Monoid.com_law</span> <span class="id">idx</span>] [<span class="id">I</span> : <span class="id">eqType</span>]<br/>
&nbsp;&nbsp;[<span class="id">r</span> <span class="id">s</span> : <span class="id">seq</span> <span class="id">I</span>] [<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>] (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">perm_eq</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; (<span class="id">F</span> <span class="id">i</span> != <span class="id">idx</span>)] [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; (<span class="id">F</span> <span class="id">i</span> != <span class="id">idx</span>)] -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>| <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
<span class="id">move</span>=&gt; <span class="id">prs</span>; <span class="id">rewrite</span> !(<span class="id">bigID</span> [<span class="id">pred</span> <span class="id">i</span> | <span class="id">F</span> <span class="id">i</span> == <span class="id">idx</span>] <span class="id">P</span> <span class="id">F</span>)/=.<br/>
<span class="id">rewrite</span> <span class="id">big1</span> ?<span class="id">Monoid.mul1m</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">_</span> /<span class="id">eqP</span>-&gt;].<br/>
<span class="id">rewrite</span> [<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">big1</span> ?<span class="id">Monoid.mul1m</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">_</span> /<span class="id">eqP</span>-&gt;].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id">big_filter</span> -[<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">big_filter</span>; <span class="id">apply</span> <span class="id">perm_big</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="perm_big_supp">perm_big_supp</a></span> [<span class="id">R</span> : <span class="id">eqType</span>] [<span class="id">idx</span> : <span class="id">R</span>] [<span class="id">op</span> : <span class="id">Monoid.com_law</span> <span class="id">idx</span>] [<span class="id">I</span> : <span class="id">eqType</span>]<br/>
&nbsp;&nbsp;[<span class="id">r</span> <span class="id">s</span> : <span class="id">seq</span> <span class="id">I</span>] [<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>] (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">perm_eq</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">r</span> | (<span class="id">F</span> <span class="id">i</span> != <span class="id">idx</span>)] [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | (<span class="id">F</span> <span class="id">i</span> != <span class="id">idx</span>)] -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id">op</span>/<span class="id">idx</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>| <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#perm_big_supp_cond">perm_big_supp_cond</a></span>; <span class="id">rewrite</span> !<span class="id">filter_predI</span> <span class="id">perm_filter</span>.<br/>
Qed.</div>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">order_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="kwd">Import</span> <span class="id">GRing.Theory</span> <span class="id">Order.TTheory</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mulr_ge0_gt0">mulr_ge0_gt0</a></span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) : 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id">x</span> * <span class="id">y</span>) = (0 &lt; <span class="id">x</span>) &amp;&amp; (0 &lt; <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">x0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0r</span> <span class="id">ltxx</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">y0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr0</span> <span class="id">ltxx</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>=&gt; [|<span class="id">_</span>]; <span class="id">rewrite</span> <span class="id">pmulr_rgt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="lt_le_gt_ge">lt_le_gt_ge</a></span>.<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="lt_le_gt_ge.R">R</a></span> : <span class="id">numFieldType</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#lt_le_gt_ge.R">R</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="splitr">splitr</a></span> <span class="id">x</span> : <span class="id">x</span> = <span class="id">x</span> / 2%:<span class="id">R</span> + <span class="id">x</span> / 2%:<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
 <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulr2n</span> -<span class="id">mulr_natr</span> <span class="id">mulfVK</span> //= <span class="id">pnatr_eq0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ler_addgt0Pr">ler_addgt0Pr</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="kwd">forall</span> <span class="id">e</span>, <span class="id">e</span> &gt; 0 -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> + <span class="id">e</span>) (<span class="id">x</span> &lt;= <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
<span class="id">apply</span>/(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>)=&gt; [<span class="id">lexy</span> <span class="id">e</span> <span class="id">e_gt0</span> | <span class="id">lexye</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_paddr</span>// <span class="id">ltW</span>.<br/>
<span class="id">have</span> [||<span class="id">ltyx</span>]// := <span class="id">comparable_leP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (@<span class="id">comparabler_trans</span> <span class="id">_</span> (<span class="id">y</span> + 1))// /<span class="id">Order.comparable</span> ?<span class="id">lexye</span> ?<span class="id">ltr01</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_addl</span> <span class="id">ler01</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbT">orbT</a></span>.<br/>
<span class="id">have</span> /<span class="id">midf_lt</span> [<span class="id">_</span>] := <span class="id">ltyx</span>; <span class="id">rewrite</span> <span class="id">le_gtF</span>//.<br/>
<span class="id">rewrite</span> -(@<span class="id">addrK</span> <span class="id">_</span> <span class="id">y</span> <span class="id">y</span>) <span class="id">addrAC</span> -<span class="id">addrA</span> 2!<span class="id">mulrDl</span> -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#splitr">splitr</a></span> <span class="id">lexye</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span>// ?<span class="id">ltr0n</span>// <span class="id">subr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ler_addgt0Pl">ler_addgt0Pl</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="kwd">forall</span> <span class="id">e</span>, <span class="id">e</span> &gt; 0 -&gt; <span class="id">x</span> &lt;= <span class="id">e</span> + <span class="id">y</span>) (<span class="id">x</span> &lt;= <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
<span class="kwd">by</span> <span class="id">apply</span>/(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#equivP">equivP</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ler_addgt0Pr">ler_addgt0Pr</a></span> <span class="id">x</span> <span class="id">y</span>)); <span class="id">split</span>=&gt; <span class="id">lexy</span> <span class="id">e</span> /<span class="id">lexy</span>; <span class="id">rewrite</span> <span class="id">addrC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_segment_addgt0Pr">in_segment_addgt0Pr</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="kwd">forall</span> <span class="id">e</span>, <span class="id">e</span> &gt; 0 -&gt; <span class="id">y</span> \<span class="kwd">in</span> `[<span class="id">x</span> - <span class="id">e</span>, <span class="id">z</span> + <span class="id">e</span>]) (<span class="id">y</span> \<span class="kwd">in</span> `[<span class="id">x</span>, <span class="id">z</span>]).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
<span class="id">apply</span>/(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>)=&gt; [<span class="id">xyz</span> <span class="id">e</span> /[<span class="id">dup</span>] <span class="id">e_gt0</span> /<span class="id">ltW</span> <span class="id">e_ge0</span> | <span class="id">xyz_e</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span> /= <span class="id">ler_subl_addr</span> !<span class="id">ler_paddr</span>// (<span class="id">itvP</span> <span class="id">xyz</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span> /= ; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ler_addgt0Pr">ler_addgt0Pr</a></span> =&gt; ? /<span class="id">xyz_e</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">in_itv</span> /= <span class="id">ler_subl_addr</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span> [].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_segment_addgt0Pl">in_segment_addgt0Pl</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="kwd">forall</span> <span class="id">e</span>, <span class="id">e</span> &gt; 0 -&gt; <span class="id">y</span> \<span class="kwd">in</span> `[(- <span class="id">e</span> + <span class="id">x</span>), (<span class="id">e</span> + <span class="id">z</span>)]) (<span class="id">y</span> \<span class="kwd">in</span> `[<span class="id">x</span>, <span class="id">z</span>]).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
<span class="id">apply</span>/(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#equivP">equivP</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#in_segment_addgt0Pr">in_segment_addgt0Pr</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>)).<br/>
<span class="kwd">by</span> <span class="id">split</span>=&gt; <span class="id">zxy</span> <span class="id">e</span> /<span class="id">zxy</span>; <span class="id">rewrite</span> [<span class="id">z</span> + <span class="id">_</span>]<span class="id">addrC</span> [<span class="id">_</span> + <span class="id">x</span>]<span class="id">addrC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lt_le">lt_le</a></span> <span class="id">a</span> <span class="id">b</span> : (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> &lt; <span class="id">a</span> -&gt; <span class="id">x</span> &lt; <span class="id">b</span>) -&gt; <span class="id">a</span> &lt;= <span class="id">b</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="id">move</span>=&gt; <span class="id">ab</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ler_addgt0Pr">ler_addgt0Pr</a></span> =&gt; <span class="id">e</span> <span class="id">e_gt0</span>; <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">ltW</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ab</span> // <span class="id">ltr_subl_addr</span> -<span class="id">ltr_subl_addl</span> <span class="id">subrr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="gt_ge">gt_ge</a></span> <span class="id">a</span> <span class="id">b</span> : (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">b</span> &lt; <span class="id">x</span> -&gt; <span class="id">a</span> &lt; <span class="id">x</span>) -&gt; <span class="id">a</span> &lt;= <span class="id">b</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
<span class="id">move</span>=&gt; <span class="id">ab</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ler_addgt0Pr">ler_addgt0Pr</a></span> =&gt; <span class="id">e</span> <span class="id">e_gt0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span>// <span class="id">ab</span>// -<span class="id">ltr_subl_addl</span> <span class="id">subrr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#lt_le_gt_ge">lt_le_gt_ge</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="itvxx">itvxx</a></span> <span class="id">d</span> (<span class="id">T</span> : <span class="id">porderType</span> <span class="id">d</span>) (<span class="id">x</span> : <span class="id">T</span>) : `[<span class="id">x</span>, <span class="id">x</span>] =<span class="id">i</span> <span class="id">pred1</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span>; <span class="id">rewrite</span> <span class="id">in_itv</span>/= -<span class="id">eq_le</span> <span class="id">eq_sym</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="itvxxP">itvxxP</a></span> <span class="id">d</span> (<span class="id">T</span> : <span class="id">porderType</span> <span class="id">d</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">T</span>) : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="id">y</span> = <span class="id">x</span>) (<span class="id">y</span> \<span class="kwd">in</span> `[<span class="id">x</span>, <span class="id">x</span>]).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#itvxx">itvxx</a></span>; <span class="id">apply</span>/<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_itv_oo_cc">subset_itv_oo_cc</a></span> <span class="id">d</span> (<span class="id">T</span> : <span class="id">porderType</span> <span class="id">d</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">T</span>) : {<span class="id">subset</span> `]<span class="id">a</span>, <span class="id">b</span>[ &lt;= `[<span class="id">a</span>, <span class="id">b</span>]}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">subitvP</span>; <span class="id">rewrite</span> <span class="id">subitvE</span> !<span class="id">bound_lexx</span>. Qed.</div>
<br/>
<pre>
(**********************************)
(* End of MathComp 1.15 additions *)
(**********************************)
</pre>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "`1- <span class="id">r</span>" (<span class="id">format</span> "`1- <span class="id">r</span>", <span class="kwd">at</span> <span class="id">level</span> 2).<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> \^-1" (<span class="kwd">at</span> <span class="id">level</span> 3, <span class="id">format</span> "<span class="id">f</span> \^-1", <span class="id">left</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natr1">natr1</a></span> (<span class="id">R</span> : <span class="id">ringType</span>) (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) : (<span class="id">n</span>%:<span class="id">R</span> + 1 = <span class="id">n</span>.+1%:<span class="id">R</span> :&gt; <span class="id">R</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">GRing.mulrSr</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nat1r">nat1r</a></span> (<span class="id">R</span> : <span class="id">ringType</span>) (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) : (1 + <span class="id">n</span>%:<span class="id">R</span> = <span class="id">n</span>.+1%:<span class="id">R</span> :&gt; <span class="id">R</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">GRing.mulrS</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fset_nat_maximum">fset_nat_maximum</a></span> (<span class="id">X</span> : <span class="id">choiceType</span>) (<span class="id">A</span> : {<span class="id">fset</span> <span class="id">X</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">X</span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id">A</span> != <span class="id">fset0</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">i</span>, <span class="id">i</span> \<span class="kwd">in</span> <span class="id">A</span> /\ <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">j</span> \<span class="kwd">in</span> <span class="id">A</span> -&gt; <span class="id">f</span> <span class="id">j</span> &lt;= <span class="id">f</span> <span class="id">i</span>)%<span class="id">nat</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
<span class="id">move</span>=&gt; /<span class="id">fset0Pn</span>[<span class="id">x</span> <span class="id">Ax</span>].<br/>
<span class="id">have</span> [/= <span class="id">y</span> <span class="id">_</span> /(<span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>) <span class="id">mf</span>] := @<span class="id">arg_maxnP</span> <span class="id">_</span> [` <span class="id">Ax</span>]%<span class="id">fset</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#xpredT">xpredT</a></span> (<span class="id">f</span> \<span class="id">o</span> <span class="id">val</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>.<br/>
<span class="kwd">exists</span> (<span class="id">val</span> <span class="id">y</span>); <span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">valP</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">Az</span>; <span class="id">have</span> := <span class="id">mf</span> [` <span class="id">Az</span>]%<span class="id">fset</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="image_nat_maximum">image_nat_maximum</a></span> <span class="id">n</span> (<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">i</span>, <span class="id">i</span> &lt;= <span class="id">n</span> /\ <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">j</span> &lt;= <span class="id">n</span> -&gt; <span class="id">f</span> <span class="id">j</span> &lt;= <span class="id">f</span> <span class="id">i</span>)%<span class="id">N</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
<span class="id">have</span> [<span class="id">i</span> <span class="id">_</span> /(<span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>) <span class="id">mf</span>] := @<span class="id">arg_maxnP</span> <span class="id">_</span> (@<span class="id">ord0</span> <span class="id">n</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#xpredT">xpredT</a></span> <span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>.<br/>
<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">i</span>; <span class="id">split</span>; <span class="id">rewrite</span> ?<span class="id">leq_ord</span>// =&gt; <span class="id">j</span> <span class="id">jn</span>; <span class="id">have</span> := <span class="id">mf</span> (@<span class="id">Ordinal</span> <span class="id">n</span>.+1 <span class="id">j</span> <span class="id">jn</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="card_fset_sum1">card_fset_sum1</a></span> (<span class="id">T</span> : <span class="id">choiceType</span>) (<span class="id">A</span> : {<span class="id">fset</span> <span class="id">T</span>}) :<br/>
&nbsp;&nbsp;#|` <span class="id">A</span>| = (\<span class="id">sum_</span>(<span class="id">i</span> &lt;- <span class="id">A</span>) 1)%<span class="id">N</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_seq_fsetE</span>/= <span class="id">sum1_card</span> <span class="id">cardfE</span>. Qed.</div>
<br/>
<span class="kwd">Arguments</span> <span class="id">big_rmcond</span> {<span class="id">R</span> <span class="id">idx</span> <span class="id">op</span> <span class="id">I</span> <span class="id">r</span>} <span class="id">P</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">big_rmcond_in</span> {<span class="id">R</span> <span class="id">idx</span> <span class="id">op</span> <span class="id">I</span> <span class="id">r</span>} <span class="id">P</span>.<br/>
<br/>
<pre>
(*****************************)
(* MathComp 1.16.0 additions *)
(*****************************)
</pre>
<span class="kwd">Section</span> <span class="id"><a name="bigminr_maxr">bigminr_maxr</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">Num.Def</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigminr_maxr">bigminr_maxr</a></span> (<span class="id">R</span> : <span class="id">realDomainType</span>) <span class="id">I</span> <span class="id">r</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id">minr</span>/<span class="id">x</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = - \<span class="id">big</span>[<span class="id">maxr</span>/- <span class="id">x</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) - <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
<span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_rec2</span>: <span class="id">_</span> =&gt; [|<span class="id">i</span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span> -&gt;]; <span class="id">rewrite</span> ?<span class="id">oppr_max</span> <span class="id">opprK</span>.<br/>
Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigminr_maxr">bigminr_maxr</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SemiGroupProperties">SemiGroupProperties</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="SemiGroupProperties.R">R</a></span> : <span class="kwd">Type</span>) (<span class="id"><a name="SemiGroupProperties.op">op</a></span> : <span class="id">R</span> -&gt; <span class="id">R</span> -&gt; <span class="id">R</span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.opA">opA</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#associative">associative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="AC_subdef">AC_subdef</a></span> <span class="id">of</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#associative">associative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> &amp; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#commutative">commutative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#oapp">oapp</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>^~ <span class="id">y</span>) <span class="id">y</span> <span class="id">x</span>)) <span class="id">x</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="oAC">oAC</a></span> := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#nosimpl">nosimpl</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#AC_subdef">AC_subdef</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.opC">opC</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#commutative">commutative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="SemiGroupProperties.opCA">opCA</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#left_commutative">left_commutative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> *; <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opC">opC</a></span> <span class="id">x</span>). Qed.</div>
<span class="kwd">Let</span> <span class="id"><a name="SemiGroupProperties.opAC">opAC</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#right_commutative">right_commutative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; *; <span class="id">rewrite</span> -!<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> <span class="id">_</span> <span class="id">X</span>]<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opC">opC</a></span>. Qed.</div>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.opyy">opyy</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#idempotent">idempotent</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="oop">oop</a></span> := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oAC">oAC</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opC">opC</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="opACE">opACE</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span>) = <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#some">some</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> <span class="id">x</span> <span class="id">y</span>)<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oopA_subdef">oopA_subdef</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#associative">associative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; [<span class="id">x</span>|] [<span class="id">y</span>|] [<span class="id">z</span>|]//; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oAC">oAC</a></span>/= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oopx1_subdef">oopx1_subdef</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#left_id">left_id</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
 <span class="kwd">by</span> <span class="id">case</span>. Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="oop1x_subdef">oop1x_subdef</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#right_id">right_id</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oopC_subdef">oopC_subdef</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#commutative">commutative</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; [<span class="id">x</span>|] [<span class="id">y</span>|]//; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oAC">oAC</a></span>/= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opC">opC</a></span>. Qed.</div>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="opAC_law">opAC_law</a></span> := <span class="id">Monoid.Law</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oopA_subdef">oopA_subdef</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oopx1_subdef">oopx1_subdef</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop1x_subdef">oop1x_subdef</a></span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="opAC_com_law">opAC_com_law</a></span> := <span class="id">Monoid.ComLaw</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oopC_subdef">oopC_subdef</a></span>.<br/>
<br/>
<span class="kwd">Context</span> [<span class="id">x</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="some_big_AC">some_big_AC</a></span> [<span class="id">I</span> : <span class="kwd">Type</span>] <span class="id">r</span> <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) =<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">F</span> <span class="id">i</span>)) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
 <span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_rec2</span> : <span class="id">_</span> =&gt; //= <span class="id">i</span> [<span class="id">y</span>|] <span class="id">_</span> <span class="id">Pi</span> [] -&gt; //=; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_ACE">big_ACE</a></span> [<span class="id">I</span> : <span class="kwd">Type</span>] <span class="id">r</span> <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#odflt">odflt</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oop">oop</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">F</span> <span class="id">i</span>)) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#Some_inj">Some_inj</a></span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#some_big_AC">some_big_AC</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_undup_AC">big_undup_AC</a></span> [<span class="id">I</span> : <span class="id">eqType</span>] <span class="id">r</span> <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) (<span class="id">opK</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#idempotent">idempotent</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>) :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">undup</span> <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
 <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span> !<span class="id">big_undup</span>//; <span class="id">case</span>=&gt; //= ?; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#oAC">oAC</a></span>/= <span class="id">opK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="perm_big_AC">perm_big_AC</a></span> [<span class="id">I</span> : <span class="id">eqType</span>] [<span class="id">r</span>] <span class="id">s</span> [<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>] [<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>] :<br/>
&nbsp;<span class="id">perm_eq</span> <span class="id">r</span> <span class="id">s</span> -&gt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
 <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span> =&gt; /(@<span class="id">perm_big</span> <span class="id">_</span> <span class="id">_</span>)-&gt;. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="SemiGroupProperties.Id">Id</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.Id.opxx">opxx</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_const_idem">big_const_idem</a></span> <span class="id">I</span> (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) <span class="id">P</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
 <span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_ind</span> : <span class="id">_</span> =&gt; // <span class="id">_</span> <span class="id">_</span> -&gt; -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_id_idem">big_id_idem</a></span> <span class="id">I</span> (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> = \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
 <span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_rec</span> : <span class="id">_</span> =&gt; // ? ? ?; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span> =&gt; -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_mkcond_idem">big_mkcond_idem</a></span> <span class="id">I</span> <span class="id">r</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span>) (<span class="kwd">if</span> <span class="id">P</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">F</span> <span class="id">i</span> <span class="kwd">else</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
<span class="id">elim</span>: <span class="id">r</span> =&gt; [|<span class="id">i</span> <span class="id">r</span>]; <span class="id">rewrite</span> ?(<span class="id">big_nil</span>, <span class="id">big_cons</span>)//.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> =&gt; <span class="id">Pi</span> -&gt;//; <span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_id_idem">big_id_idem</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_split_idem">big_split_idem</a></span> <span class="id">I</span> <span class="id">r</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) <span class="id">F1</span> <span class="id">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (<span class="id">F1</span> <span class="id">i</span>) (<span class="id">F2</span> <span class="id">i</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F1</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F2</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
 <span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_rec3</span> : <span class="id">_</span> =&gt; [//|<span class="id">i</span> ? ? <span class="id">_</span> <span class="id">_</span> -&gt;]; <span class="id">rewrite</span> // <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opCA">opCA</a></span> -!<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opA">opA</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opCA">opCA</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_id_idem_AC">big_id_idem_AC</a></span> <span class="id">I</span> (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (<span class="id">F</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span> = \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_split_idem">big_split_idem</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_const_idem">big_const_idem</a></span> ?<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_id_idem">big_id_idem</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigID_idem">bigID_idem</a></span> <span class="id">I</span> <span class="id">r</span> (<span class="id">a</span> <span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; ~~ <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
<span class="id">rewrite</span> -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_id_idem_AC">big_id_idem_AC</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_mkcond_idem">big_mkcond_idem</a></span> !(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_mkcond_idem">big_mkcond_idem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span>) -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_split_idem">big_split_idem</a></span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_bigr</span> =&gt; <span class="id">i</span>; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> =&gt; //=; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.Id">Id</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_rem_AC">big_rem_AC</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) <span class="id">z</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) <span class="id">F</span> : <span class="id">z</span> \<span class="kwd">in</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">y</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">y</span>) <span class="id">F</span> <span class="id">y</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">P</span> <span class="id">z</span> <span class="kwd">then</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (<span class="id">F</span> <span class="id">z</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">y</span> &lt;- <span class="id">rem</span> <span class="id">z</span> <span class="id">r</span> | <span class="id">P</span> <span class="id">y</span>) <span class="id">F</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">y</span> &lt;- <span class="id">rem</span> <span class="id">z</span> <span class="id">r</span> | <span class="id">P</span> <span class="id">y</span>) <span class="id">F</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
<span class="kwd">by</span> <span class="id">move</span>=&gt; /[!<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span>] /(<span class="id">big_rem</span> <span class="id">_</span>)-&gt;//; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifP">ifP</a></span>; <span class="id">case</span>: (<span class="id">bigop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; /=.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigD1_AC">bigD1_AC</a></span> (<span class="id">I</span> : <span class="id">finType</span>) <span class="id">j</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>) <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> (<span class="id">F</span> <span class="id">j</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; (<span class="id">i</span> != <span class="id">j</span>)) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /[!<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span>] /(<span class="id">bigD1</span> <span class="id">_</span>)-&gt;; <span class="id">case</span>: (<span class="id">bigop</span> <span class="id">_</span> <span class="id">_</span>) =&gt; /=. Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="SemiGroupProperties.le">le</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#rel">rel</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.le_refl">le_refl</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflexive">reflexive</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="SemiGroupProperties.op_incr">op_incr</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> <span class="id">x</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_big">sub_big</a></span> <span class="id">I</span> [<span class="id">s</span>] (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) : (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">move</span>=&gt; <span class="id">PP</span>'; <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span> (<span class="id">bigID</span> <span class="id">P</span> <span class="id">P</span>')/=.<br/>
<span class="id">under</span> [<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> <span class="id">_</span> <span class="id">X</span>]<span class="id">eq_bigl</span> <span class="id">do</span> <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andb_idl">andb_idl</a></span> (<span class="id">PP</span>' <span class="id">_</span>)).<br/>
<span class="id">case</span>: (<span class="id">bigop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) (<span class="id">bigop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; [<span class="id">y</span>|] [<span class="id">z</span>|]//=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opAC">opAC</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op_incr">op_incr</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.opC">opC</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op_incr">op_incr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_big_seq">sub_big_seq</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">count_mem</span> <span class="id">i</span> <span class="id">s</span> &lt;= <span class="id">count_mem</span> <span class="id">i</span> <span class="id">s</span>')%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
<span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span> =&gt; /<span class="id">count_subseqP</span>[<span class="id">_</span> /<span class="id">subseqP</span>[<span class="id">m</span> <span class="id">sm</span> -&gt;]]/(<span class="id">perm_big</span> <span class="id">_</span>)-&gt;.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_mask</span> <span class="id">big_tnth</span>// -!<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_ACE">big_ACE</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span>// =&gt; <span class="id">j</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_big_seq_cond">sub_big_seq_cond</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> <span class="id">P</span>' (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">count_mem</span> <span class="id">i</span> (<span class="id">filter</span> <span class="id">P</span> <span class="id">s</span>) &lt;= <span class="id">count_mem</span> <span class="id">i</span> (<span class="id">filter</span> <span class="id">P</span>' <span class="id">s</span>'))%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
 <span class="kwd">by</span>  <span class="id">move</span>=&gt; /(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_seq">sub_big_seq</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#xpredT">xpredT</a></span> <span class="id">F</span>); <span class="id">rewrite</span> !<span class="id">big_filter</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="uniq_sub_big">uniq_sub_big</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) : <span class="id">uniq</span> <span class="id">s</span> -&gt; <span class="id">uniq</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> <span class="id">s</span> &lt;= <span class="id">s</span>'} -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
<span class="id">move</span>=&gt; <span class="id">us</span> <span class="id">us</span>' <span class="id">ss</span>'; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_seq">sub_big_seq</a></span> =&gt; // <span class="id">i</span>; <span class="id">rewrite</span> !<span class="id">count_uniq_mem</span>//.<br/>
<span class="kwd">by</span> <span class="id">have</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#implyP">implyP</a></span> := <span class="id">ss</span>' <span class="id">i</span>; <span class="id">case</span>: (<span class="id">_</span> \<span class="kwd">in</span> <span class="id">s</span>) (<span class="id">_</span> \<span class="kwd">in</span> <span class="id">s</span>') =&gt; [] [].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="uniq_sub_big_cond">uniq_sub_big_cond</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> <span class="id">P</span>' (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">uniq</span> (<span class="id">filter</span> <span class="id">P</span> <span class="id">s</span>) -&gt; <span class="id">uniq</span> (<span class="id">filter</span> <span class="id">P</span>' <span class="id">s</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>] &lt;= [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>]} -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">u</span> <span class="id">u</span>' /(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#uniq_sub_big">uniq_sub_big</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#xpredT">xpredT</a></span> <span class="id">F</span> <span class="id">u</span> <span class="id">u</span>'); <span class="id">rewrite</span> !<span class="id">big_filter</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_big_idem">sub_big_idem</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> <span class="id">s</span> &lt;= <span class="id">s</span>'} -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
<span class="id">move</span>=&gt; <span class="id">ss</span>'; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_undup_AC">big_undup_AC</a></span>// -[<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> <span class="id">_</span> <span class="id">X</span>]<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_undup_AC">big_undup_AC</a></span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#uniq_sub_big">uniq_sub_big</a></span> ?<span class="id">undup_uniq</span>// =&gt; <span class="id">i</span>; <span class="id">rewrite</span> !<span class="id">mem_undup</span>; <span class="id">apply</span>: <span class="id">ss</span>'.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_big_idem_cond">sub_big_idem_cond</a></span> (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> <span class="id">P</span>' (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>] &lt;= [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>]} -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
 <span class="kwd">by</span>  <span class="id">move</span>=&gt; /(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_idem">sub_big_idem</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#xpredT">xpredT</a></span> <span class="id">F</span>); <span class="id">rewrite</span> !<span class="id">big_filter</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_in_big">sub_in_big</a></span> [<span class="id">I</span> : <span class="id">eqType</span>] (<span class="id">s</span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">s</span>, <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>} -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
<span class="id">move</span>=&gt; <span class="id">PP</span>'; <span class="id">apply</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_seq_cond">sub_big_seq_cond</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id">leq_count_subseq</span>//.<br/>
<span class="id">rewrite</span> <span class="id">subseq_filter</span> <span class="id">filter_subseq</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>; <span class="id">apply</span>/<span class="id">allP</span> =&gt; <span class="id">j</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">mem_filter</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[/<span class="id">PP</span>'/[<span class="id">apply</span>]-&gt;].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_big_ord">le_big_ord</a></span> <span class="id">n</span> <span class="id">m</span> [<span class="id">P</span> : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}] [<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>] : (<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">nm</span>; <span class="id">rewrite</span> (<span class="id">big_ord_widen_cond</span> <span class="id">m</span>)// <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span> =&gt; //= ? /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_big">subset_big</a></span> [<span class="id">I</span> : <span class="id">finType</span>] [<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> : {<span class="id">pred</span> <span class="id">I</span>}] (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> \<span class="id">subset</span> <span class="id">A</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
<span class="id">move</span>=&gt; <span class="id">AA</span>'; <span class="id">apply</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span> =&gt; <span class="id">y</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">yA</span> <span class="id">yP</span>]; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span> =&gt; //.<br/>
<span class="id">exact</span>: <span class="id">subsetP</span> <span class="id">yA</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_big_cond">subset_big_cond</a></span> (<span class="id">I</span> : <span class="id">finType</span>) (<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>]  \<span class="id">subset</span> [<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>] -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">subsetP</span> <span class="id">AP</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span> =&gt; <span class="id">i</span>; <span class="id">have</span> /[!<span class="id">inE</span>] := <span class="id">AP</span> <span class="id">i</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_big_nat_cond">le_big_nat_cond</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span>' &lt;= <span class="id">n</span>)%<span class="id">N</span> -&gt; (<span class="id">m</span> &lt;= <span class="id">m</span>')%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, (<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span>)%<span class="id">N</span> -&gt; <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
<span class="id">move</span>=&gt; <span class="id">len</span>'<span class="id">n</span> <span class="id">lemm</span>' <span class="id">PP</span>'<span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#uniq_sub_big_cond">uniq_sub_big_cond</a></span> ?<span class="id">filter_uniq</span> ?<span class="id">iota_uniq</span>//.<br/>
<span class="id">move</span>=&gt; <span class="id">i</span>; <span class="id">rewrite</span> !<span class="id">mem_filter</span> !<span class="id">mem_index_iota</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#and3P">and3P</a></span>[<span class="id">Pi</span> <span class="id">ni</span> <span class="id">im</span>].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">PP</span>'<span class="id">i</span> ?<span class="id">ni</span>//= (<span class="id">leq_trans</span> <span class="id">_</span> <span class="id">ni</span>)// (<span class="id">leq_trans</span> <span class="id">im</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_big_nat">le_big_nat</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' [<span class="id">P</span>] [<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>] : (<span class="id">n</span>' &lt;= <span class="id">n</span>)%<span class="id">N</span> -&gt; (<span class="id">m</span> &lt;= <span class="id">m</span>')%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">len</span>'<span class="id">n</span> <span class="id">lemm</span>'; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat_cond">le_big_nat_cond</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_big_ord_cond">le_big_ord_cond</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span> : '<span class="id">I_n</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.le">le</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.op">op</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
<span class="id">move</span>=&gt; <span class="id">nm</span> <span class="id">PP</span>'; <span class="id">rewrite</span> -!<span class="id">big_mkord</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat_cond">le_big_nat_cond</a></span>//= =&gt; <span class="id">i</span> <span class="id">ni</span>.<br/>
<span class="kwd">by</span> <span class="id">have</span> := <span class="id">PP</span>' (<span class="id">Ordinal</span> <span class="id">ni</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#SemiGroupProperties">SemiGroupProperties</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmaxmin">bigmaxmin</a></span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="max">max</a></span> := <span class="id">Order.max</span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="min">min</a></span> := <span class="id">Order.min</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">order_scope</span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmaxmin.d">d</a></span> : <span class="id">_</span>) (<span class="id"><a name="bigmaxmin.T">T</a></span> : <span class="id">porderType</span> <span class="id">d</span>).<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmaxmin.I">I</a></span> : <span class="kwd">Type</span>) (<span class="id"><a name="bigmaxmin.r">r</a></span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id"><a name="bigmaxmin.f">f</a></span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.T">T</a></span>) (<span class="id"><a name="bigmaxmin.x0">x0</a></span> <span class="id"><a name="bigmaxmin.x">x</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.T">T</a></span>) (<span class="id"><a name="bigmaxmin.P">P</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id">I</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_le">bigmax_le</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span>) -&gt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.r">r</a></span> | <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">elim</span>/<span class="id">big_ind</span>: <span class="id">_</span> =&gt; // *; <span class="id">rewrite</span> <span class="id">maxEle</span>; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_lt">bigmax_lt</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span>) -&gt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.r">r</a></span> | <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">elim</span>/<span class="id">big_ind</span>: <span class="id">_</span> =&gt; // *; <span class="id">rewrite</span> <span class="id">maxElt</span>; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lt_bigmin">lt_bigmin</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span>) -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.r">r</a></span> | <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">elim</span>/<span class="id">big_ind</span>: <span class="id">_</span> =&gt; // *; <span class="id">rewrite</span> <span class="id">minElt</span>; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmin">le_bigmin</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span>) -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x">x</a></span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.x0">x0</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.r">r</a></span> | <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.P">P</a></span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin.f">f</a></span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">elim</span>/<span class="id">big_ind</span>: <span class="id">_</span> =&gt; // *; <span class="id">rewrite</span> <span class="id">minEle</span>; <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxmin">bigmaxmin</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmax">bigmax</a></span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="max">max</a></span> := <span class="id">Order.max</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">order_scope</span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmax.d">d</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span class="id"><a name="bigmax.T">T</a></span> : <span class="id">orderType</span> <span class="id">d</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmax.bigmax_Type">bigmax_Type</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmax.bigmax_Type.I">I</a></span> : <span class="kwd">Type</span>) (<span class="id"><a name="bigmax.bigmax_Type.r">r</a></span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id"><a name="bigmax.bigmax_Type.x">x</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">P</span> <span class="id">a</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.I">I</a></span>) (<span class="id">F</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.I">I</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_mkcond">bigmax_mkcond</a></span> <span class="id">P</span> <span class="id">F</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span>) (<span class="kwd">if</span> <span class="id">P</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">F</span> <span class="id">i</span> <span class="kwd">else</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_mkcond_idem">big_mkcond_idem</a></span> ?<span class="id">maxxx</span>//; [<span class="id">exact</span>: <span class="id">maxA</span>|<span class="id">exact</span>: <span class="id">maxC</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_split">bigmax_split</a></span> <span class="id">P</span> <span class="id">F1</span> <span class="id">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> (<span class="id">F1</span> <span class="id">i</span>) (<span class="id">F2</span> <span class="id">i</span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F1</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F2</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_split_idem">big_split_idem</a></span> ?<span class="id">maxxx</span>//; [<span class="id">exact</span>: <span class="id">maxA</span>|<span class="id">exact</span>: <span class="id">maxC</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_idl">bigmax_idl</a></span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">maxC</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_id_idem">big_id_idem</a></span> ?<span class="id">maxxx</span>//; <span class="id">exact</span>: <span class="id">maxA</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_idr">bigmax_idr</a></span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
 <span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_idl">bigmax_idl</a></span> <span class="id">maxC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmaxID">bigmaxID</a></span> <span class="id">a</span> <span class="id">P</span> <span class="id">F</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; ~~ <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
 <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigID_idem">bigID_idem</a></span> <span class="id">maxA</span> <span class="id">maxC</span> <span class="id">_</span> <span class="id">_</span> <span class="id">a</span>) ?<span class="id">maxxx</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_Type">bigmax_Type</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="bigmax.le_maxr_id">le_maxr_id</a></span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) : <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> <span class="id">x</span> <span class="id">y</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_maxr</span> <span class="id">lexx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmax">sub_bigmax</a></span> [<span class="id">x0</span>] <span class="id">I</span> <span class="id">s</span> (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmax_seq">sub_bigmax_seq</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) : {<span class="id">subset</span> <span class="id">s</span> &lt;= <span class="id">s</span>'} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_idem">sub_big_idem</a></span> <span class="id">maxA</span> <span class="id">maxC</span> <span class="id">maxxx</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmax_cond">sub_bigmax_cond</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> <span class="id">P</span>' (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>] &lt;= [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>]} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_idem_cond">sub_big_idem_cond</a></span> <span class="id">maxA</span> <span class="id">maxC</span> <span class="id">maxxx</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_in_bigmax">sub_in_bigmax</a></span> [<span class="id">x0</span>] [<span class="id">I</span> : <span class="id">eqType</span>] (<span class="id">s</span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">s</span>, <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_in_big">sub_in_big</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax_nat">le_bigmax_nat</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) : <span class="id">n</span>' &lt;= <span class="id">n</span> -&gt; <span class="id">m</span> &lt;= <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat">le_big_nat</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax_nat_cond">le_bigmax_nat_cond</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span>' &lt;= <span class="id">n</span>)%<span class="id">N</span> -&gt; (<span class="id">m</span> &lt;= <span class="id">m</span>')%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> -&gt; <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat_cond">le_big_nat_cond</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax_ord">le_bigmax_ord</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> (<span class="id">P</span> : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) : (<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_ord">le_big_ord</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax_ord_cond">le_bigmax_ord_cond</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>}) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span> : '<span class="id">I_n</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">P</span>' <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_ord_cond">le_big_ord_cond</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_bigmax">subset_bigmax</a></span> [<span class="id">x0</span>] [<span class="id">I</span> : <span class="id">finType</span>] (<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> \<span class="id">subset</span> <span class="id">A</span>' -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#subset_big">subset_big</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_bigmax_cond">subset_bigmax_cond</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">finType</span>) (<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>]  \<span class="id">subset</span> [<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>] -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#subset_big_cond">subset_big_cond</a></span> <span class="id">maxA</span> <span class="id">maxC</span>). Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmax.bigmax_finType">bigmax_finType</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmax.bigmax_finType.I">I</a></span> : <span class="id">finType</span>) (<span class="id"><a name="bigmax.bigmax_finType.x">x</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.I">I</a></span>) (<span class="id">F</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.I">I</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.T">T</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmaxD1">bigmaxD1</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span> (<span class="id">F</span> <span class="id">j</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; (<span class="id">i</span> != <span class="id">j</span>)) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
 <span class="kwd">by</span> <span class="id">move</span>/(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigD1_AC">bigD1_AC</a></span> <span class="id">maxA</span> <span class="id">maxC</span>) -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax_cond">le_bigmax_cond</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; <span class="id">F</span> <span class="id">j</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pj</span>; <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxD1">bigmaxD1</a></span> <span class="id">_</span> <span class="id">Pj</span>) <span class="id">le_maxr</span> <span class="id">lexx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax">le_bigmax</a></span> <span class="id">F</span> <span class="id">j</span> : <span class="id">F</span> <span class="id">j</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_i</span> <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
 <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmax_cond">le_bigmax_cond</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_sup">bigmax_sup</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">m</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; <span class="id">m</span> &lt;= <span class="id">F</span> <span class="id">j</span> -&gt; <span class="id">m</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pj</span> ?; <span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmax_cond">le_bigmax_cond</a></span> <span class="id">_</span> <span class="id">Pj</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_leP">bigmax_leP</a></span> <span class="id">m</span> <span class="id">P</span> <span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span> &lt;= <span class="id">m</span> /\ <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id">m</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof131')">Proof.</span></div>
<div class="proofscript" id="proof131">
<span class="id">apply</span>: (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>) =&gt; [|[? ?]]; <span class="id">last</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_le">bigmax_le</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_idl">bigmax_idl</a></span> <span class="id">le_maxl</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[-&gt; <span class="id">leFm</span>]; <span class="id">split</span>=&gt; // <span class="id">i</span> <span class="id">Pi</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_trans</span> <span class="id">leFm</span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmax_cond">le_bigmax_cond</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_ltP">bigmax_ltP</a></span> <span class="id">m</span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span> &lt; <span class="id">m</span> /\ <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F</span> <span class="id">i</span> &lt; <span class="id">m</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt; <span class="id">m</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
<span class="id">apply</span>: (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>) =&gt; [|[? ?]]; <span class="id">last</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_lt">bigmax_lt</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_idl">bigmax_idl</a></span> <span class="id">lt_maxl</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[-&gt; <span class="id">ltFm</span>]; <span class="id">split</span>=&gt; // <span class="id">i</span> <span class="id">Pi</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_lt_trans</span> <span class="id">ltFm</span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmax_cond">le_bigmax_cond</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmax_eq_arg">bigmax_eq_arg</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span> &lt;= <span class="id">F</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id">F</span> [<span class="id">arg</span> <span class="id">max_</span>(<span class="id">i</span> &gt; <span class="id">j</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof133')">Proof.</span></div>
<div class="proofscript" id="proof133">
<span class="id">move</span>=&gt; <span class="id">Pi0</span>; <span class="id">case</span>: <span class="id">arg_maxP</span> =&gt; //= <span class="id">i</span> <span class="id">Pi</span> <span class="id">PF</span> <span class="id">PxF</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_le</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmax_cond">le_bigmax_cond</a></span> // <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_leP">bigmax_leP</a></span>; <span class="id">split</span> =&gt; //; <span class="id">exact</span>: <span class="id">PxF</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_bigmax">eq_bigmax</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span> &lt;= <span class="id">F</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">i0</span> | <span class="id">i0</span> \<span class="kwd">in</span> <span class="id">P</span> &amp; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id">F</span> <span class="id">i0</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof134')">Proof.</span></div>
<div class="proofscript" id="proof134">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pi0</span> <span class="id">Hx</span>; <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_eq_arg">bigmax_eq_arg</a></span> <span class="id">Pi0</span>) //; <span class="id">eexists</span> =&gt; //; <span class="id">case</span>:<span class="id">arg_maxP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmax2">le_bigmax2</a></span> <span class="id">P</span> <span class="id">F1</span> <span class="id">F2</span> : (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F1</span> <span class="id">i</span> &lt;= <span class="id">F2</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F1</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max">max</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F2</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
<span class="id">move</span>=&gt; <span class="id">FG</span>; <span class="id">elim</span>/<span class="id">big_ind2</span> : <span class="id">_</span> =&gt; // <span class="id">a</span> <span class="id">b</span> <span class="id">e</span> <span class="id">f</span> <span class="id">ba</span> <span class="id">fe</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_maxr</span> 2!<span class="id">le_maxl</span> <span class="id">ba</span> <span class="id">fe</span> /= <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>; <span class="id">have</span> [//|/= <span class="id">af</span>] := <span class="id">leP</span> <span class="id">f</span> <span class="id">a</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">ba</span>) // (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">fe</span>) // <span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax.bigmax_finType">bigmax_finType</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax">bigmax</a></span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_mkcond">bigmax_mkcond</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">r</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxID">bigmaxID</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">r</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmaxD1">bigmaxD1</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_sup">bigmax_sup</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_eq_arg">bigmax_eq_arg</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span>} <span class="id">x</span> <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#eq_bigmax">eq_bigmax</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmin">bigmin</a></span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="min">min</a></span> := <span class="id">Order.min</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">order_scope</span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="bigmin.d">d</a></span> : <span class="id">_</span>) (<span class="id"><a name="bigmin.T">T</a></span> : <span class="id">orderType</span> <span class="id">d</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmin.bigmin_Type">bigmin_Type</a></span>.<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="bigmin.bigmin_Type.I">I</a></span> : <span class="kwd">Type</span>) (<span class="id"><a name="bigmin.bigmin_Type.r">r</a></span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id"><a name="bigmin.bigmin_Type.x">x</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">P</span> <span class="id">a</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.I">I</a></span>) (<span class="id">F</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.I">I</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_mkcond">bigmin_mkcond</a></span> <span class="id">P</span> <span class="id">F</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span>) (<span class="kwd">if</span> <span class="id">P</span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">F</span> <span class="id">i</span> <span class="kwd">else</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
 <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_mkcond_idem">big_mkcond_idem</a></span> ?<span class="id">minxx</span>//; [<span class="id">exact</span>: <span class="id">minA</span>|<span class="id">exact</span>: <span class="id">minC</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_split">bigmin_split</a></span> <span class="id">P</span> <span class="id">F1</span> <span class="id">F2</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> (<span class="id">F1</span> <span class="id">i</span>) (<span class="id">F2</span> <span class="id">i</span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F1</span> <span class="id">i</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F2</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
 <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_split_idem">big_split_idem</a></span> ?<span class="id">minxx</span>//; [<span class="id">exact</span>: <span class="id">minA</span>|<span class="id">exact</span>: <span class="id">minC</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_idl">bigmin_idl</a></span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
 <span class="id">rewrite</span> <span class="id">minC</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#big_id_idem">big_id_idem</a></span> ?<span class="id">minxx</span>//; <span class="id">exact</span>: <span class="id">minA</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_idr">bigmin_idr</a></span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>) <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
 <span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_idl">bigmin_idl</a></span> <span class="id">minC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigminID">bigminID</a></span> <span class="id">a</span> <span class="id">P</span> <span class="id">F</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type.r">r</a></span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; ~~ <span class="id">a</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</span></div>
<div class="proofscript" id="proof140">
 <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigID_idem">bigID_idem</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">_</span> <span class="id">_</span> <span class="id">a</span>) ?<span class="id">minxx</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_Type">bigmin_Type</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="bigmin.le_minr_id">le_minr_id</a></span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) : <span class="id">x</span> &gt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> <span class="id">x</span> <span class="id">y</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</span></div>
<div class="proofscript" id="proof141">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_minl</span> <span class="id">lexx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmin">sub_bigmin</a></span> [<span class="id">x0</span>] <span class="id">I</span> <span class="id">s</span> (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span>' <span class="id">i</span> -&gt; <span class="id">P</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</span></div>
<div class="proofscript" id="proof142">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big">sub_big</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmin_cond">sub_bigmin_cond</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> <span class="id">P</span>' (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">subset</span> [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>] &lt;= [<span class="id">seq</span> <span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>]} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</span></div>
<div class="proofscript" id="proof143">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_idem_cond">sub_big_idem_cond</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">minxx</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_bigmin_seq">sub_bigmin_seq</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">eqType</span>) <span class="id">s</span> <span class="id">s</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) : {<span class="id">subset</span> <span class="id">s</span>' &lt;= <span class="id">s</span>} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</span></div>
<div class="proofscript" id="proof144">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_big_idem">sub_big_idem</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">minxx</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_in_bigmin">sub_in_bigmin</a></span> [<span class="id">x0</span>] [<span class="id">I</span> : <span class="id">eqType</span>] (<span class="id">s</span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">s</span>, <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span>' <span class="id">i</span> -&gt; <span class="id">P</span> <span class="id">i</span>} -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">s</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</span></div>
<div class="proofscript" id="proof145">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#sub_in_big">sub_in_big</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmin_nat">le_bigmin_nat</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' <span class="id">P</span> (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">n</span> &lt;= <span class="id">n</span>')%<span class="id">N</span> -&gt; (<span class="id">m</span>' &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</span></div>
<div class="proofscript" id="proof146">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat">le_big_nat</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmin_nat_cond">le_bigmin_nat_cond</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> <span class="id">n</span>' <span class="id">m</span>' (<span class="id">P</span> <span class="id">P</span>' : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span> &lt;= <span class="id">n</span>')%<span class="id">N</span> -&gt; (<span class="id">m</span>' &lt;= <span class="id">m</span>)%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' -&gt; <span class="id">P</span>' <span class="id">i</span> -&gt; <span class="id">P</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span> &lt;= <span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">n</span>' &lt;= <span class="id">i</span> &lt; <span class="id">m</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</span></div>
<div class="proofscript" id="proof147">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_nat_cond">le_big_nat_cond</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmin_ord">le_bigmin_ord</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) : (<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</span></div>
<div class="proofscript" id="proof148">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_ord">le_big_ord</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="le_bigmin_ord_cond">le_bigmin_ord_cond</a></span> [<span class="id">x0</span>] <span class="id">n</span> <span class="id">m</span> (<span class="id">P</span> <span class="id">P</span>' : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">N</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span> : '<span class="id">I_m</span>, <span class="id">P</span>' <span class="id">i</span> -&gt; <span class="id">P</span> <span class="id">i</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">n</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> &lt; <span class="id">m</span> | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</span></div>
<div class="proofscript" id="proof149">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_big_ord_cond">le_big_ord_cond</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_bigmin">subset_bigmin</a></span> [<span class="id">x0</span>] [<span class="id">I</span> : <span class="id">finType</span>] [<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> : {<span class="id">pred</span> <span class="id">I</span>}] (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span>' \<span class="id">subset</span> <span class="id">A</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</span></div>
<div class="proofscript" id="proof150">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#subset_big">subset_big</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subset_bigmin_cond">subset_bigmin_cond</a></span> [<span class="id">x0</span>] (<span class="id">I</span> : <span class="id">finType</span>) (<span class="id">A</span> <span class="id">A</span>' <span class="id">P</span> <span class="id">P</span>' : {<span class="id">pred</span> <span class="id">I</span>}) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>]  \<span class="id">subset</span> [<span class="id">set</span> <span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>] -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id">x0</span>]<span class="id">_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">A</span>' | <span class="id">P</span>' <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</span></div>
<div class="proofscript" id="proof151">
 <span class="id">exact</span>: (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#subset_big_cond">subset_big_cond</a></span> <span class="id">minA</span> <span class="id">minC</span> <span class="id">ge_refl</span>). Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bigmin.bigmin_finType">bigmin_finType</a></span>.<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="bigmin.bigmin_finType.I">I</a></span> : <span class="id">finType</span>) (<span class="id"><a name="bigmin.bigmin_finType.x">x</a></span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">P</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.I">I</a></span>) (<span class="id">F</span> : <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.I">I</a></span> -&gt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.T">T</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigminD1">bigminD1</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span> (<span class="id">F</span> <span class="id">j</span>) (\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span> &amp;&amp; (<span class="id">i</span> != <span class="id">j</span>)) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</span></div>
<div class="proofscript" id="proof152">
 <span class="kwd">by</span> <span class="id">move</span>/(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigD1_AC">bigD1_AC</a></span> <span class="id">minA</span> <span class="id">minC</span>) -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_le_cond">bigmin_le_cond</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id">F</span> <span class="id">j</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof153')">Proof.</span></div>
<div class="proofscript" id="proof153">
<span class="id">have</span> := <span class="id">mem_index_enum</span> <span class="id">j</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>; <span class="id">elim</span>: (<span class="id">index_enum</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.I">I</a></span>) =&gt; //= <span class="id">i</span> <span class="id">l</span> <span class="id">ih</span>.<br/>
<span class="id">rewrite</span> <span class="id">inE</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orP">orP</a></span> [/<span class="id">eqP</span>-&gt; -&gt;|/<span class="id">ih</span> <span class="id">leminlfi</span> <span class="id">Pi</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_minl</span> <span class="id">lexx</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> =&gt; <span class="id">Pj</span>; [<span class="id">rewrite</span> <span class="id">le_minl</span> <span class="id">leminlfi</span>// <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbC">orbC</a></span>|<span class="id">exact</span>: <span class="id">leminlfi</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_le">bigmin_le</a></span> <span class="id">j</span> <span class="id">F</span> : \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_i</span> <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id">F</span> <span class="id">j</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof154')">Proof.</span></div>
<div class="proofscript" id="proof154">
 <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_le_cond">bigmin_le_cond</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_inf">bigmin_inf</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">m</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; <span class="id">F</span> <span class="id">j</span> &lt;= <span class="id">m</span> -&gt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id">m</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof155')">Proof.</span></div>
<div class="proofscript" id="proof155">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pj</span> ?; <span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_le_cond">bigmin_le_cond</a></span> <span class="id">_</span> <span class="id">Pj</span>) <span class="id">_</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_geP">bigmin_geP</a></span> <span class="id">m</span> <span class="id">P</span> <span class="id">F</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="id">m</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span> /\ <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">m</span> &lt;= <span class="id">F</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> &lt;= \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof156')">Proof.</span></div>
<div class="proofscript" id="proof156">
<span class="id">apply</span>: (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>) =&gt; [<span class="id">lemFi</span>|[<span class="id">lemx</span> <span class="id">lemPi</span>]]; [<span class="id">split</span>|<span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#le_bigmin">le_bigmin</a></span>].<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">lemFi</span>)// <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_idl">bigmin_idl</a></span> <span class="id">le_minl</span> <span class="id">lexx</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> <span class="id">Pi</span>; <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">lemFi</span>)// (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigminD1">bigminD1</a></span> <span class="id">_</span> <span class="id">Pi</span>)// <span class="id">le_minl</span> <span class="id">lexx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_gtP">bigmin_gtP</a></span> <span class="id">m</span> <span class="id">P</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="id">m</span> &lt; <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span> /\ <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">m</span> &lt; <span class="id">F</span> <span class="id">i</span>) (<span class="id">m</span> &lt; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof157')">Proof.</span></div>
<div class="proofscript" id="proof157">
<span class="id">apply</span>: (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>) =&gt; [<span class="id">lemFi</span>|[<span class="id">lemx</span> <span class="id">lemPi</span>]]; [<span class="id">split</span>|<span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#lt_bigmin">lt_bigmin</a></span>].<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">lemFi</span>)// <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_idl">bigmin_idl</a></span> <span class="id">le_minl</span> <span class="id">lexx</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> <span class="id">Pi</span>; <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">lemFi</span>)// (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigminD1">bigminD1</a></span> <span class="id">_</span> <span class="id">Pi</span>)// <span class="id">le_minl</span> <span class="id">lexx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bigmin_eq_arg">bigmin_eq_arg</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id">F</span> [<span class="id">arg</span> <span class="id">min_</span>(<span class="id">i</span> &lt; <span class="id">j</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof158')">Proof.</span></div>
<div class="proofscript" id="proof158">
<span class="id">move</span>=&gt; <span class="id">Pi0</span>; <span class="id">case</span>: <span class="id">arg_minP</span> =&gt; //= <span class="id">i</span> <span class="id">Pi</span> <span class="id">PF</span> <span class="id">PFx</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_le</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_le_cond">bigmin_le_cond</a></span> //=.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_geP">bigmin_geP</a></span>; <span class="id">split</span> =&gt; //; <span class="id">exact</span>: <span class="id">PFx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_bigmin">eq_bigmin</a></span> <span class="id">j</span> <span class="id">P</span> <span class="id">F</span> : <span class="id">P</span> <span class="id">j</span> -&gt; (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> <span class="id">i</span> -&gt; <span class="id">F</span> <span class="id">i</span> &lt;= <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">i0</span> | <span class="id">i0</span> \<span class="kwd">in</span> <span class="id">P</span> &amp; \<span class="id">big</span>[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#min">min</a></span>/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType.x">x</a></span>]<span class="id">_</span>(<span class="id">i</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span> = <span class="id">F</span> <span class="id">i0</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof159')">Proof.</span></div>
<div class="proofscript" id="proof159">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Pi0</span> <span class="id">Hx</span>; <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_eq_arg">bigmin_eq_arg</a></span> <span class="id">Pi0</span>) //; <span class="id">eexists</span> =&gt; //; <span class="id">case</span>:<span class="id">arg_minP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin.bigmin_finType">bigmin_finType</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin">bigmin</a></span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_mkcond">bigmin_mkcond</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">r</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigminID">bigminID</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">r</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigminD1">bigminD1</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_inf">bigmin_inf</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmin_eq_arg">bigmin_eq_arg</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span>} <span class="id">x</span> <span class="id">j</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#eq_bigmin">eq_bigmin</a></span> {<span class="id">d</span> <span class="id">T</span> <span class="id">I</span> <span class="id">x</span>} <span class="id">j</span>.<br/>
<br/>
<pre>
(************************************)
(* End of MathComp 1.16.0 additions *)
(************************************)
</pre>
<pre>
(*****************************)
(* MathComp &gt; 1.16 additions *)
(*****************************)
</pre>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> \<span class="id">max</span> <span class="id">g</span>" (<span class="kwd">at</span> <span class="id">level</span> 50, <span class="id">left</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_fun">max_fun</a></span> <span class="id">T</span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) <span class="id">x</span> := <span class="id">Num.max</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">x</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">f</span> \<span class="id">max</span> <span class="id">g</span>" := (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max_fun">max_fun</a></span> <span class="id">f</span> <span class="id">g</span>) : <span class="id">ring_scope</span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#max_fun">max_fun</a></span> {<span class="id">T</span> <span class="id">R</span>} <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> /.<br/>
<br/>
<pre>
(************************************)
(* End of mathComp &gt; 1.16 additions *)
(************************************)
</pre>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "`1- <span class="id"><a name="onem.R">x</a></span>" (<span class="id">format</span> "`1- <span class="id">x</span>", <span class="kwd">at</span> <span class="id">level</span> 2).<br/>
<br/>
<span class="kwd">Section</span> <span class="id">onem</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">numDomainType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">r</span> : <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">onem</span> <span class="id">r</span> := 1 - <span class="id">r</span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "`1- <span class="id">r</span>" := (<span class="id">onem</span> <span class="id">r</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem0</span> : `1-0 = 1<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof160')">Proof.</span></div>
<div class="proofscript" id="proof160">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">subr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem1</span> : `1-1 = 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof161')">Proof.</span></div>
<div class="proofscript" id="proof161">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">subrr</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemK</span> <span class="id">r</span> : `1-(`1-<span class="id">r</span>) = <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof162')">Proof.</span></div>
<div class="proofscript" id="proof162">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">opprB</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">add_onemK</span> <span class="id">r</span> : <span class="id">r</span> + `1- <span class="id">r</span> = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof163')">Proof.</span></div>
<div class="proofscript" id="proof163">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">addrC</span> <span class="id">subrK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem_gt0</span> <span class="id">r</span> : <span class="id">r</span> &lt; 1 -&gt; 0 &lt; `1-<span class="id">r</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof164')">Proof.</span></div>
<div class="proofscript" id="proof164">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem_ge0</span> <span class="id">r</span> : <span class="id">r</span> &lt;= 1 -&gt; 0 &lt;= `1-<span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof165')">Proof.</span></div>
<div class="proofscript" id="proof165">
 <span class="kwd">by</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem1">rewrite</a></span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[-&gt;|/<span class="id">onem_gt0</span>/<span class="id">ltW</span>]; <span class="id">rewrite</span> ?<span class="id">onem1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem_le1</span> <span class="id">r</span> : 0 &lt;= <span class="id">r</span> -&gt; `1-<span class="id">r</span> &lt;= 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof166')">Proof.</span></div>
<div class="proofscript" id="proof166">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_subl_addr</span> <span class="id">ler_addl</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onem_lt1</span> <span class="id">r</span> : 0 &lt; <span class="id">r</span> -&gt; `1-<span class="id">r</span> &lt; 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof167')">Proof.</span></div>
<div class="proofscript" id="proof167">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_subl_addr</span> <span class="id">ltr_addl</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemX_ge0</span> <span class="id">r</span> <span class="id">n</span> : 0 &lt;= <span class="id">r</span> -&gt; <span class="id">r</span> &lt;= 1 -&gt; 0 &lt;= `1-(<span class="id">r</span> ^+ <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof168')">Proof.</span></div>
<div class="proofscript" id="proof168">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">rewrite</span> <span class="id">subr_ge0</span> <span class="id">exprn_ile1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemX_lt1</span> <span class="id">r</span> <span class="id">n</span> : 0 &lt; <span class="id">r</span> -&gt; `1-(<span class="id">r</span> ^+ <span class="id">n</span>) &lt; 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof169')">Proof.</span></div>
<div class="proofscript" id="proof169">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> <span class="id">onem_lt1</span>// <span class="id">exprn_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemD</span> <span class="id">r</span> <span class="id">s</span> : `1-(<span class="id">r</span> + <span class="id">s</span>) = `1-<span class="id">r</span> - <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof170')">Proof.</span></div>
<div class="proofscript" id="proof170">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">addrAC</span> <span class="id">opprD</span> <span class="id">addrA</span> <span class="id">addrAC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemMr</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">s</span> * `1-<span class="id">r</span> = <span class="id">s</span> - <span class="id"><a name="onemM">s</a></span> * <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof171')">Proof.</span></div>
<div class="proofscript" id="proof171">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">mulrBr</span> <span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemM</span> <span class="id">r</span> <span class="id">s</span> : `1-(<span class="id">r</span> * <span class="id">s</span>) = `1-<span class="id">r</span> + `1-<span class="id">s</span> - `1-<span class="id">r</span> * `1-<span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof172')">Proof.</span></div>
<div class="proofscript" id="proof172">
<span class="id">rewrite</span> /<span class="id">onem</span> <span class="id">mulrBr</span> <span class="id">mulr1</span> <span class="id">mulrBl</span> <span class="id">mul1r</span> <span class="id">opprB</span> -<span class="id">addrA</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">addrC</span> (1 - <span class="id">r</span>)) !<span class="id">addrA</span> <span class="id">subrK</span> <span class="id">opprB</span> <span class="id">addrA</span> <span class="id">subrK</span> <span class="id">addrK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">onem</span>.<br/>
<span class="kwd">Notation</span> "`1- <span class="id">r</span>" := (<span class="id">onem</span> <span class="id">r</span>) : <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">onemV</span> (<span class="id">F</span> : <span class="id">numFieldType</span>) (<span class="id">x</span> : <span class="id">F</span>) : <span class="id">x</span> != 0 -&gt; `1-(<span class="id">x</span>^-1) = (<span class="id">x</span> - 1) / <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof173')">Proof.</span></div>
<div class="proofscript" id="proof173">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> <span class="id">mulrDl</span> <span class="id">divff</span>// <span class="id">mulN1r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lez_abs2</span> (<span class="id">a</span> <span class="id">b</span> : <span class="id">int</span>) : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> &lt;= <span class="id">b</span> -&gt; (`|<span class="id">a</span>| &lt;= `|<span class="id">b</span>|)%<span class="id">N</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof174')">Proof.</span></div>
<div class="proofscript" id="proof174">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">a</span> =&gt; //= <span class="id">n</span> <span class="id">_</span>; <span class="id">case</span>: <span class="id">b</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_gtP</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="kwd">forall</span> <span class="id">z</span>, <span class="id">z</span> &gt; <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">z</span>) (<span class="id">x</span> &lt;= <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof175')">Proof.</span></div>
<div class="proofscript" id="proof175">
<span class="id">apply</span>: (<span class="id">equivP</span> (<span class="id">ler_addgt0Pr</span> <span class="id">_</span> <span class="id">_</span>)); <span class="id">split</span>=&gt; [<span class="id">xy</span> <span class="id">z</span>|<span class="id">xz</span> <span class="id">e</span> <span class="id">e_gt0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">subr_gt0</span> =&gt; /<span class="id">xy</span>; <span class="id">rewrite</span> <span class="id">addrC</span> <span class="id">addrNK</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">xz</span>; <span class="id">rewrite</span> -[<span class="id">ltLHS</span>]<span class="id">addr0</span> <span class="id">ler_lt_add</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_ltP</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="kwd">forall</span> <span class="id">z</span>, <span class="id">z</span> &lt; <span class="id">x</span> -&gt; <span class="id">z</span> &lt;= <span class="id">y</span>) (<span class="id">x</span> &lt;= <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof176')">Proof.</span></div>
<div class="proofscript" id="proof176">
<span class="id">apply</span>: (<span class="id">equivP</span> (<span class="id">ler_addgt0Pr</span> <span class="id">_</span> <span class="id">_</span>)); <span class="id">split</span>=&gt; [<span class="id">xy</span> <span class="id">z</span>|<span class="id">xz</span> <span class="id">e</span> <span class="id">e_gt0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">subr_gt0</span> =&gt; /<span class="id">xy</span>; <span class="id">rewrite</span> <span class="id">addrCA</span> -[<span class="id">leLHS</span>]<span class="id">addr0</span> <span class="id">ler_add2l</span> <span class="id">subr_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">xz</span>// -[<span class="id"><a name="bound_side">ltRHS</a></span>]<span class="id">subr0</span> <span class="id">ler_lt_sub</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">inv_fun</span> <span class="id">T</span> (<span class="id">R</span> : <span class="id">unitRingType</span>) (<span class="id">f</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) <span class="id">x</span> := (<span class="id">f</span> <span class="id">x</span>)^-1%<span class="id">R</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">f</span> \^-1" := (<span class="id">inv_fun</span> <span class="id">f</span>) : <span class="id">ring_scope</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">inv_fun</span> {<span class="id">T</span> <span class="id">R</span>} <span class="id">_</span> <span class="id">_</span> /.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">bound_side</span> <span class="id">d</span> (<span class="id">T</span> : <span class="id">porderType</span> <span class="id">d</span>) (<span class="id">c</span> : <span class="id">bool</span>) (<span class="id">x</span> : <span class="id">itv_bound</span> <span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">x</span> <span class="id">is</span> <span class="id">BSide</span> <span class="id">c</span>' <span class="id">_</span> <span class="kwd">then</span> <span class="id">c</span> == <span class="id">c</span>' <span class="kwd">else</span> <span class="id">false</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">real_ltr_distlC</span> [<span class="id">R</span> : <span class="id">numDomainType</span>] [<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>] (<span class="id">e</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">x</span> - <span class="id">y</span> \<span class="id">is</span> <span class="id">Num.real</span> -&gt; (`|<span class="id">x</span> - <span class="id">y</span>| &lt; <span class="id">e</span>) = (<span class="id">x</span> - <span class="id">e</span> &lt; <span class="id">y</span> &lt; <span class="id"><a name="DFunWith.T">x</a></span> + <span class="id">e</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof177')">Proof.</span></div>
<div class="proofscript" id="proof177">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> <span class="id">distrC</span> <span class="id">real_ltr_distl</span>// -<span class="id">rpredN</span> <span class="id">opprB</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">proj</span> {<span class="id">I</span>} {<span class="id">T</span> : <span class="id">I</span> -&gt; <span class="kwd">Type</span>} <span class="id">i</span> (<span class="id">f</span> : <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">T</span> <span class="id">i</span>) := <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#DFunWith.f">f</a></span> <span class="id">i</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DFunWith</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">I</span> : <span class="id">eqType</span>) (<span class="id">T</span> : <span class="id">I</span> -&gt; <span class="kwd">Type</span>) (<span class="id">f</span> : <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">T</span> <span class="id">i</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">dfwith</span> <span class="id">i</span> (<span class="id">x</span> : <span class="id">T</span> <span class="id">i</span>) (<span class="id">j</span> : <span class="id">I</span>) : <span class="id">T</span> <span class="id">j</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#DFunWith.T">i</a></span> =<span class="id">P</span> <span class="id">j</span>) <span class="id">is</span> <span class="id">ReflectT</span> <span class="id">ij</span> <span class="kwd">then</span> <span class="id">ecast</span> <span class="id">j</span> (<span class="id">T</span> <span class="id">j</span>) <span class="id">ij</span> <span class="id">x</span> <span class="kwd">else</span> <span class="id">f</span> <span class="id">j</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">dfwithin</span> <span class="id">i</span> <span class="id">x</span> : <span class="id">dfwith</span> <span class="id">x</span> <span class="id">i</span> = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof178')">Proof.</span></div>
<div class="proofscript" id="proof178">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">dfwith</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; // <span class="id">ii</span>; <span class="id">rewrite</span> <span class="id">eq_axiomK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">dfwithout</span> <span class="id">i</span> (<span class="id">x</span> : <span class="id">T</span> <span class="id">i</span>) <span class="id">j</span> : <span class="id">i</span> != <span class="id">j</span> -&gt; <span class="id">dfwith</span> <span class="id">x</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#DFunWith.f">j</a></span> = <span class="id">f</span> <span class="id">j</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof179')">Proof.</span></div>
<div class="proofscript" id="proof179">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#DFunWith.T">dfwith</a></span>; <span class="id">case</span>: <span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Variant</span> <span class="id">dfwith_spec</span> <span class="id">i</span> (<span class="id">x</span> : <span class="id">T</span> <span class="id">i</span>) : <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">T</span> <span class="id">j</span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id">DFunWithin</span> : <span class="id">dfwith_spec</span> <span class="id">x</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| <span class="id">DFunWithout</span> <span class="id">j</span> : <span class="id">i</span> != <span class="id">j</span> -&gt; <span class="id">dfwith_spec</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">j</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">dfwithP</span> <span class="id">i</span> (<span class="id">x</span> : <span class="id">T</span> <span class="id">i</span>) (<span class="id">j</span> : <span class="id">I</span>) : <span class="id">dfwith_spec</span> <span class="id">x</span> (<span class="id">dfwith</span> <span class="id">x</span> <span class="id">j</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof180')">Proof.</span></div>
<div class="proofscript" id="proof180">
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">eqVneq</span> <span class="id">i</span> <span class="id">j</span>) =&gt; [&lt;-|<span class="id">nij</span>];<br/>
&nbsp;&nbsp;&nbsp;[<span class="id">rewrite</span> <span class="id">dfwithin</span>|<span class="id">rewrite</span> <span class="id">dfwithout</span>//]; <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">projK</span> <span class="id">i</span> (<span class="id">x</span> : <span class="id">T</span> <span class="id">i</span>) : <span class="id">cancel</span> (@<span class="id">dfwith</span> <span class="id">i</span>) (<span class="id">proj</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof181')">Proof.</span></div>
<div class="proofscript" id="proof181">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span>; <span class="id">rewrite</span> /<span class="id">proj</span> <span class="id">dfwithin</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DFunWith</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">dfwith</span> {<span class="id">I</span> <span class="id">T</span>} <span class="id">f</span> <span class="id">i</span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">swap</span> (<span class="id">T1</span> <span class="id">T2</span> : <span class="kwd">Type</span>) (<span class="id">x</span> : <span class="id">T1</span> * <span class="id">T2</span>) := (<span class="id">x</span>.2, <span class="id">x</span>.1).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_sqrt</span> {<span class="id">R</span> : <span class="id">rcfType</span>} (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id">b</span> -&gt; (<span class="id">Num.sqrt</span> <span class="id">a</span> &lt;= <span class="id">Num.sqrt</span> <span class="id">b</span>) = (<span class="id">a</span> &lt;= <span class="id">b</span>))%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof182')">Proof.</span></div>
<div class="proofscript" id="proof182">
<span class="id">have</span> [<span class="id">b_gt0</span> <span class="id">_</span>|//|&lt;- <span class="id">_</span>] := <span class="id">ltgtP</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrtr0</span> -<span class="id">sqrtr_eq0</span> <span class="id">le_eqVlt</span> <span class="id">ltNge</span> <span class="id">sqrtr_ge0</span> <span class="id">orbF</span>.<br/>
<span class="id">have</span> [<span class="id">a_le0</span>|<span class="id">a_gt0</span>] := <span class="id">ler0P</span> <span class="id">a</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_psqrt</span>.<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#order_min.T">rewrite</a></span> <span class="id">ler0_sqrtr</span> // <span class="id">sqrtr_ge0</span> (<span class="id">le_trans</span> <span class="id">a_le0</span>) ?<span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">order_min</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">d</span> : <span class="id">unit</span>) (<span class="id">T</span> : <span class="id">orderType</span> <span class="id">d</span>).<br/>
<span class="kwd">Import</span> <span class="id">Order</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">order_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">lt_min_lt</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id">T</span>) : (<span class="id">min</span> <span class="id">x</span> <span class="id">z</span> &lt; <span class="id">min</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#order_min">y</a></span> <span class="id">z</span>)%<span class="id">O</span> -&gt; (<span class="id">x</span> &lt; <span class="id">y</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof183')">Proof.</span></div>
<div class="proofscript" id="proof183">
<span class="id">rewrite</span> /<span class="id">Order.min</span>/=; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; <span class="id">xz</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; <span class="id">yz</span>; <span class="id">rewrite</span> ?<span class="id">ltxx</span>//.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">lt_le_trans</span>; <span class="id">apply</span>; <span class="id">rewrite</span> <span class="id">leNgt</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltNge</span> (<span class="id">ltW</span> <span class="id">yz</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">order_min</span>.<br/>
<br/>
<pre>
(**************************)
(* MathComp 2.1 additions *)
(**************************)
</pre>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">poly</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">coefE</span> :=<br/>
&nbsp;&nbsp;(<span class="id">coef0</span>, <span class="id">coef1</span>, <span class="id">coefC</span>, <span class="id">coefX</span>, <span class="id">coefXn</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">coefZ</span>, <span class="id">coefMC</span>, <span class="id">coefCM</span>, <span class="id">coefXnM</span>, <span class="id">coefMXn</span>, <span class="id"><a name="Pdeg2">coefXM</a></span>, <span class="id">coefMX</span>, <span class="id">coefMNn</span>, <span class="id">coefMn</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">coefN</span>, <span class="id">coefB</span>, <span class="id">coefD</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">coef_cons</span>, <span class="id">coef_Poly</span>, <span class="id">coef_poly</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">coef_deriv</span>, <span class="id">coef_nderivn</span>, <span class="id">coef_derivn</span>, <span class="id">coef_map</span>, <span class="id">coef_sum</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">coef_comp_poly</span>).<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Export</span> <span class="id">Pdeg2</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="kwd">Export</span> <span class="id">Field</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Pdeg2Field</span>.<br/>
<span class="kwd">Variable</span> <span class="id">F</span> : <span class="id">fieldType</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id">nz2</span> : 2%:<span class="id">R</span> != 0 :&gt; <span class="id">F</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">p</span> : {<span class="id">poly</span> <span class="id">F</span>}.<br/>
<span class="kwd">Hypothesis</span> <span class="id">degp</span> : <span class="id">size</span> <span class="id">p</span> = 3%<span class="id">N</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">a</span> := <span class="id">p</span>`<span class="id">_2</span>.<br/>
<span class="kwd">Let</span> <span class="id">b</span> := <span class="id">p</span>`<span class="id">_1</span>.<br/>
<span class="kwd">Let</span> <span class="id">c</span> := <span class="id">p</span>`<span class="id">_0</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">pneq0</span> : <span class="id">p</span> != 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof184')">Proof.</span></div>
<div class="proofscript" id="proof184">
 <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">size_poly_gt0</span> <span class="id">degp</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">aneq0</span> : <span class="id">a</span> != 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof185')">Proof.</span></div>
<div class="proofscript" id="proof185">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">pneq0</span>; <span class="id">rewrite</span> -<span class="id">lead_coef_eq0</span> <span class="id">lead_coefE</span> <span class="id">degp</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">a2neq0</span> : 2%:<span class="id">R</span> * <span class="id">a</span> != 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof186')">Proof.</span></div>
<div class="proofscript" id="proof186">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulf_neq0</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">sqa2neq0</span> : (2%:<span class="id">R</span> * <span class="id">a</span>) ^+ 2 != 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof187')">Proof.</span></div>
<div class="proofscript" id="proof187">
 <span class="id">exact</span>: <span class="id">expf_neq0</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">aa4</span> : 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">a</span> = (2%:<span class="id">R</span> * <span class="id">a</span>)^+2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof188')">Proof.</span></div>
<div class="proofscript" id="proof188">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expr2</span> <span class="id">mulrACA</span> <span class="id">mulrA</span> -<span class="id">natrM</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">splitr</span> (<span class="id">x</span> : <span class="id">F</span>) : <span class="id">x</span> = <span class="id">x</span> / 2%:<span class="id">R</span> + <span class="id">x</span> / 2%:<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof189')">Proof.</span></div>
<div class="proofscript" id="proof189">
<span class="id">apply</span>: (<span class="id">mulIf</span> <span class="id">nz2</span>); <span class="id">rewrite</span> -<span class="id">mulrDl</span> <span class="id">mulfVK</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[2%:<span class="id">R</span>]/(1 + 1)%:<span class="id">R</span> <span class="id">natrD</span> <span class="id">mulrDr</span> <span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">pE</span> : <span class="id"><a name="Pdeg2.Field.deg2_poly_canonical">p</a></span> = <span class="id">a</span> *: '<span class="id">X</span>^2 + <span class="id">b</span> *: '<span class="id">X</span> + <span class="id">c</span>%:<span class="id">P</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof190')">Proof.</span></div>
<div class="proofscript" id="proof190">
<span class="id">apply</span>/<span class="id">polyP</span> =&gt; + /[!<span class="id">coefE</span>] =&gt; -[|[|[|<span class="id">i</span>]]] /=; <span class="id">rewrite</span> !<span class="id">Monoid.simpm</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">nth_default</span>// <span class="id">degp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">delta</span> := <span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_canonical</span> :<br/>
&nbsp;&nbsp;<span class="id">p</span> = <span class="id">a</span> *: (('<span class="id">X</span> + (<span class="id">b</span> / (2%:<span class="id">R</span> * <span class="id">a</span>))%:<span class="id">P</span>)^+2 - (<span class="id">delta</span> / (4%:<span class="id">R</span> * <span class="id">a</span> ^+ 2))%:<span class="id">P</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof191')">Proof.</span></div>
<div class="proofscript" id="proof191">
<span class="id">rewrite</span> <span class="id">pE</span> <span class="id">sqrrD</span> -!<span class="id">addrA</span> <span class="id">scalerDr</span>; <span class="id">congr</span> +%<span class="id">R</span>; <span class="id">rewrite</span> <span class="id">addrA</span> <span class="id">scalerDr</span>; <span class="id">congr</span> +%<span class="id">R</span>.<br/>
- <span class="id">rewrite</span> -<span class="id">mulrDr</span> -<span class="id">polyCD</span> -!<span class="id">mul_polyC</span> <span class="id">mulrA</span> <span class="id">mulrAC</span> -<span class="id">polyCM</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">a</span> * <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">mulrDl</span> <span class="id">invfM</span> -!<span class="id">mulrA</span> <span class="id"><a name="Pdeg2.Field.Pdeg2Field.r">mulVf</a></span>// <span class="id">mulr1</span> -<span class="id">splitr</span>.<br/>
- <span class="id">rewrite</span> [<span class="id">a</span> ^+ 2]<span class="id">expr2</span> <span class="id">mulrA</span> <span class="id">aa4</span> -<span class="id">polyC_exp</span> -<span class="id">polyCB</span> <span class="id">expr_div_n</span> -<span class="id"><a name="Pdeg2.Field.Pdeg2Field.r2">mulrBl</a></span> <span class="id">subKr</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mul_polyC</span> -<span class="id">polyCM</span> <span class="id">mulrCA</span> <span class="id">mulrACA</span> <span class="id">aa4</span> <span class="id">mulrCA</span> <span class="id">mulfV</span>// <span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id">r</span> : <span class="id">F</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id">r_sqrt_delta</span> : <span class="id">r</span> ^+ 2 = <span class="id">delta</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Pdeg2.Field.Pdeg2Field.r1">r1</a></span> := (- <span class="id">b</span> - <span class="id">r</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<span class="kwd">Let</span> <span class="id">r2</span> := (- <span class="id">b</span> + <span class="id">r</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_factor</span> : <span class="id">p</span> = <span class="id">a</span> *: ('<span class="id">X</span> - <span class="id">r1</span>%:<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">P</a></span>) * ('<span class="id">X</span> - <span class="id">r2</span>%:<span class="id">P</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof192')">Proof.</span></div>
<div class="proofscript" id="proof192">
<span class="id">rewrite</span> [<span class="id">p</span>]<span class="id">deg2_poly_canonical</span>//= -/<span class="id">a</span> -/<span class="id">b</span> -/<span class="id">c</span> -/<span class="id">delta</span> /<span class="id">r1</span> /<span class="id">r2</span>.<br/>
<span class="id">rewrite</span> ![(- <span class="id">b</span> + <span class="id">_</span>) * <span class="id">_</span>]<span class="id">mulrDl</span> 2!<span class="id">polyCD</span> 2!<span class="id">opprD</span> 2!<span class="id">addrA</span> !<span class="id">mulNr</span> !<span class="id">polyCN</span> !<span class="id">opprK</span>.<br/>
<span class="id">rewrite</span> -<span class="id">scalerAl</span> [<span class="kwd">in</span> <span class="id">RHS</span>]<span class="id">mulrC</span> -<span class="id">subr_sqr</span> -<span class="id">polyC_exp</span> -[4%:<span class="id">R</span>]/(2 * 2)%:<span class="id">R</span> <span class="id">natrM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">expr2</span> -<span class="id">exprMn</span> [<span class="kwd">in</span> <span class="id">RHS</span>]<span class="id">exprMn</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Pdeg2.Real.Pdeg2Real.Pdeg2RealConvex.p">exprVn</a></span> <span class="id">r_sqrt_delta</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Pdeg2Field</span>.<br/>
<span class="kwd">End</span> <span class="id">Field</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">Real</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Pdeg2Real</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">F</span> : <span class="id">realFieldType</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Pdeg2RealConvex</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">p</span> : {<span class="id">poly</span> <span class="id">F</span>}.<br/>
<span class="kwd">Hypothesis</span> <span class="id">degp</span> : <span class="id">size</span> <span class="id">p</span> = 3%<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Pdeg2.Real.Pdeg2Real.Pdeg2RealConvex.a">N</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">a</span> := <span class="id">p</span>`<span class="id">_2</span>.<br/>
<span class="kwd">Let</span> <span class="id">b</span> := <span class="id">p</span>`<span class="id">_1</span>.<br/>
<span class="kwd">Let</span> <span class="id">c</span> := <span class="id">p</span>`<span class="id">_0</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id">age0</span> : 0 &lt;= <span class="id">a</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">delta</span> := <span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">pneq0</span> : <span class="id">p</span> != 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof193')">Proof.</span></div>
<div class="proofscript" id="proof193">
 <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">size_poly_gt0</span> <span class="id">degp</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">aneq0</span> : <span class="id">a</span> != 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof194')">Proof.</span></div>
<div class="proofscript" id="proof194">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">pneq0</span>; <span class="id">rewrite</span> -<span class="id">lead_coef_eq0</span> <span class="id">lead_coefE</span> <span class="id">degp</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">agt0</span> : 0 &lt; <span class="id">a</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof195')">Proof.</span></div>
<div class="proofscript" id="proof195">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt_def</span> <span class="id">aneq0</span>. Qed.</div>
<span class="kwd">Let</span> <span class="id">a4gt0</span> : 0 &lt; 4%:<span class="id">R</span> * <span class="id">a</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof196')">Proof.</span></div>
<div class="proofscript" id="proof196">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr_gt0</span> ?<span class="id">ltr0n</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_min</span> <span class="id">x</span> : <span class="id">p</span>.[- <span class="id">b</span> / (2%:<span class="id">R</span> * <span class="id">a</span>)] &lt;= <span class="id">p</span>.[<span class="id">x</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof197')">Proof.</span></div>
<div class="proofscript" id="proof197">
<span class="id">rewrite</span> [<span class="id">p</span>]<span class="id">deg2_poly_canonical</span> ?<span class="id">pnatr_eq0</span>// -/<span class="id">a</span> -/<span class="id">b</span> -/<span class="id">c</span> /<span class="id">delta</span> !<span class="id">hornerE</span>/=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_pmul2l</span>// <span class="id">ler_add2r</span> <span class="id">addrC</span> <span class="id">mulNr</span> <span class="id">subrr</span> ?<span class="id">mulr0</span> ?<span class="id">expr0n</span> <span class="id">sqr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_minE</span> : <span class="id">p</span>.[- <span class="id">b</span> / (2%:<span class="id">R</span> * <span class="id">a</span>)] = - <span class="id">delta</span> / (4%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof198')">Proof.</span></div>
<div class="proofscript" id="proof198">
<span class="id">rewrite</span> [<span class="id">p</span>]<span class="id">deg2_poly_canonical</span> ?<span class="id">pnatr_eq0</span>// -/<span class="id">a</span> -/<span class="id">b</span> -/<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Pdeg2.Real.Pdeg2Real.Pdeg2RealConvex.p">c</a></span> -/<span class="id">delta</span> !<span class="id">hornerE</span>/=.<br/>
<span class="id">rewrite</span> -?<span class="id">expr2</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span>^+2]<span class="id">addrC</span> [<span class="kwd">in</span> <span class="id">LHS</span>]<span class="id">mulNr</span> <span class="id">subrr</span> <span class="id">expr0n</span> <span class="id">add0r</span> <span class="id">mulNr</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span> <span class="id">mulNr</span> <span class="id">invfM</span> <span class="id">mulrA</span> <span class="id">mulfVK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_ge0</span> : <span class="id">reflect</span> (<span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id">p</span>.[<span class="id">x</span>]) (<span class="id">delta</span> &lt;= 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof199')">Proof.</span></div>
<div class="proofscript" id="proof199">
<span class="id">apply</span>/(<span class="id">iffP</span> <span class="id">idP</span>) =&gt; [<span class="id">dlt0</span> <span class="id">x</span> | /(<span class="id">_</span> (- <span class="id">b</span> / (2%:<span class="id">R</span> * <span class="id">a</span>)))]; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deg2_poly_minE</span> <span class="id">ler_pdivl_mulr</span>// <span class="id">mul0r</span> <span class="id">oppr_ge0</span>.<br/>
<span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id">deg2_poly_min</span> <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id"><a name="Pdeg2.Real.Pdeg2RealClosed.Pdeg2RealClosedConvex.p">rewrite</a></span> <span class="id">deg2_poly_minE</span> <span class="id">ler_pdivl_mulr</span>// <span class="id">mul0r</span> <span class="id">oppr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a name="Pdeg2.Real.Pdeg2RealClosed.Pdeg2RealClosedConvex.b">Pdeg2RealConvex</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">Pdeg2Real</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Pdeg2RealClosed</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">F</span> : <span class="id">rcfType</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Pdeg2RealClosedConvex</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">p</span> : {<span class="id"><a name="Pdeg2.Real.Pdeg2RealClosed.Pdeg2RealClosedConvex.r1">poly</a></span> <span class="id">F</span>}.<br/>
<span class="kwd">Hypothesis</span> <span class="id">degp</span> : <span class="id">size</span> <span class="id">p</span> = 3%<span class="id">N</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">a</span> := <span class="id">p</span>`<span class="id">_2</span>.<br/>
<span class="kwd">Let</span> <span class="id">b</span> := <span class="id">p</span>`<span class="id">_1</span>.<br/>
<span class="kwd">Let</span> <span class="id">c</span> := <span class="id">p</span>`<span class="id">_0</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">nz2</span> : 2%:<span class="id">R</span> != 0 :&gt; <span class="id">F</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof200')">Proof.</span></div>
<div class="proofscript" id="proof200">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">pnatr_eq0</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">delta</span> := <span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">r1</span> := (- <span class="id">b</span> - <span class="id">Num.sqrt</span> <span class="id">delta</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<span class="kwd">Let</span> <span class="id">r2</span> := (- <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Pdeg2.Real.Pdeg2RealClosed.Pdeg2RealClosedConvex">b</a></span> + <span class="id">Num.sqrt</span> <span class="id">delta</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg2_poly_factor</span> : 0 &lt;= <span class="id">delta</span> -&gt; <span class="id">p</span> = <span class="id">a</span> *: ('<span class="id">X</span> - <span class="id">r1</span>%:<span class="id">P</span>) * ('<span class="id">X</span> - <span class="id">r2</span>%:<span class="id">P</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof201')">Proof.</span></div>
<div class="proofscript" id="proof201">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id"><a name="Degle2PolyRealConvex.p">dge0</a></span>; <span class="id">apply</span>: <span class="id">deg2_poly_factor</span>; <span class="id">rewrite</span> ?<span class="id">sqr_sqrtr</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Pdeg2RealClosedConvex</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">Pdeg2RealClosed</span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Degle2PolyRealConvex.b">Real</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">Pdeg2</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Degle2PolyRealConvex</span>.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#Degle2PolyRealConvex.a">F</a></span> : <span class="id">realFieldType</span>) (<span class="id">p</span> : {<span class="id">poly</span> <span class="id">F</span>}).<br/>
<span class="kwd">Hypothesis</span> <span class="id">degp</span> : (<span class="id">size</span> <span class="id">p</span> &lt;= 3)%<span class="id">N</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">a</span> := <span class="id">p</span>`<span class="id">_2</span>.<br/>
<span class="kwd">Let</span> <span class="id">b</span> := <span class="id">p</span>`<span class="id">_1</span>.<br/>
<span class="kwd">Let</span> <span class="id">c</span> := <span class="id">p</span>`<span class="id">_0</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">delta</span> := <span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg_le2_poly_delta_ge0</span> : 0 &lt;= <span class="id">a</span> -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id">p</span>.[<span class="id">x</span>]) -&gt; <span class="id">delta</span> &lt;= 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof202')">Proof.</span></div>
<div class="proofscript" id="proof202">
<span class="id">move</span>=&gt; <span class="id">age0</span> <span class="id">pge0</span>; <span class="id">move</span>: <span class="id">degp</span>; <span class="id">rewrite</span> <span class="id">leq_eqVlt</span> =&gt; /<span class="id">orP</span>[/<span class="id">eqP</span>|] <span class="id">degp</span>'.<br/>
&nbsp;&nbsp;<span class="id">exact</span>/(<span class="id">Real.deg2_poly_ge0</span> <span class="id">degp</span>' <span class="id">age0</span>).<br/>
<span class="id">have</span> <span class="id">a0</span> : <span class="id">a</span> = 0 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">a</span> <span class="id">nth_default</span>.<br/>
<span class="id">rewrite</span> /<span class="id">delta</span> <span class="id">a0</span> <span class="id">mulr0</span> <span class="id">mul0r</span> <span class="id">subr0</span> <span class="id">exprn_even_le0</span>//=.<br/>
<span class="id">have</span> [//|/<span class="id">eqP</span> <span class="id">nzb</span>] := <span class="id">eqP</span>; <span class="id">move</span>: (<span class="id">pge0</span> ((- 1 - <span class="id">c</span>) / <span class="id">b</span>)).<br/>
<span class="id">have</span> -&gt; : <span class="id">p</span> = <span class="id">b</span> *: '<span class="id">X</span> + <span class="id">c</span>%:<span class="id">P</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">polyP</span> =&gt; + /[!<span class="id">coefE</span>] =&gt; -[|[|<span class="id">i</span>]] /=; <span class="id">rewrite</span> !<span class="id">Monoid.simpm</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a name="Degle2PolyRealClosedConvex.p">nth_default</a></span>// -<span class="id">ltnS</span> (<span class="id">leq_trans</span> <span class="id">degp</span>').<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">hornerE</span>/= <span class="id">mulrAC</span> <span class="id">mulfV</span>// <span class="id">mul1r</span> <span class="id">subrK</span> <span class="id">ler0N1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Degle2PolyRealConvex</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Degle2PolyRealClosedConvex</span>.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id">F</span> : <span class="id">rcfType</span>) (<span class="id">p</span> : {<span class="id">poly</span> <span class="id">F</span>}).<br/>
<span class="kwd">Hypothesis</span> <span class="id">degp</span> : (<span class="id">size</span> <span class="id">p</span> &lt;= 3)%<span class="id">N</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">a</span> := <span class="id">p</span>`<span class="id">_2</span>.<br/>
<span class="kwd">Let</span> <span class="id">b</span> := <span class="id">p</span>`<span class="id">_1</span>.<br/>
<span class="kwd">Let</span> <span class="id">c</span> := <span class="id">p</span>`<span class="id">_0</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">delta</span> := <span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg_le2_poly_ge0</span> : (<span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id">p</span>.[<span class="id">x</span>]) -&gt; <span class="id">delta</span> &lt;= 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof203')">Proof.</span></div>
<div class="proofscript" id="proof203">
<span class="id">have</span> [<span class="id">age0</span>|<span class="id">alt0</span>] := <span class="id">leP</span> 0 <span class="id">a</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">deg_le2_poly_delta_ge0</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">pge0</span>; <span class="id">move</span>: <span class="id">degp</span>; <span class="id">rewrite</span> <span class="id">leq_eqVlt</span> =&gt; /<span class="id">orP</span>[/<span class="id">eqP</span>|] <span class="id">degp</span>'; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>: <span class="id">alt0</span>; <span class="id">rewrite</span> /<span class="id">a</span> <span class="id">nth_default</span> ?<span class="id">ltxx</span>.<br/>
<span class="id">have</span> [//|<span class="id">dge0</span>] := <span class="id">leP</span> <span class="id">delta</span> 0.<br/>
<span class="id">pose</span> <span class="id">r1</span> := (- <span class="id">b</span> - <span class="id">Num.sqrt</span> <span class="id">delta</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<span class="id">pose</span> <span class="id">r2</span> := (- <span class="id">b</span> + <span class="id">Num.sqrt</span> <span class="id">delta</span>) / (2%:<span class="id">R</span> * <span class="id">a</span>).<br/>
<span class="id">pose</span> <span class="id">x0</span> := <span class="id">Num.max</span> (<span class="id">r1</span> + 1) (<span class="id">r2</span> + 1).<br/>
<span class="id">move</span>: (<span class="id">pge0</span> <span class="id">x0</span>); <span class="id">rewrite</span> (<span class="id">Real.deg2_poly_factor</span> <span class="id">degp</span>' (<span class="id">ltW</span> <span class="id">dge0</span>)).<br/>
<span class="id">rewrite</span> !<span class="id">hornerE</span>/= -<span class="id">mulrA</span> <span class="id">nmulr_rge0</span>// <span class="id">leNgt</span> =&gt; /<span class="id">negbTE</span>&lt;-.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">mulr_gt0</span>; <span class="id">rewrite</span> <span class="id">subr_gt0</span> <span class="id">lt_maxr</span> <span class="id">ltr_addl</span> <span class="id">ltr01</span> ?<span class="id">orbT</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Degle2PolyRealClosedConvex</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deg_le2_ge0</span> (<span class="id">F</span> : <span class="id">rcfType</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id">F</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id">a</span> * <span class="id">x</span> ^+ 2 + <span class="id">b</span> * <span class="id">x</span> + <span class="id">c</span>)%<span class="id">R</span> -&gt; (<span class="id">b</span> ^+ 2 - 4%:<span class="id">R</span> * <span class="id">a</span> * <span class="id">c</span> &lt;= 0)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof204')">Proof.</span></div>
<div class="proofscript" id="proof204">
<span class="id">move</span>=&gt; <span class="id">pge0</span>; <span class="id">pose</span> <span class="id">p</span> := \<span class="id">poly_</span>(<span class="id">i</span> &lt; 3) [:: <span class="id">c</span>; <span class="id">b</span>; <span class="id">a</span>]`<span class="id">_i</span>.<br/>
<span class="id">have</span> := @<span class="id">deg_le2_poly_ge0</span> <span class="id">_</span> <span class="id">p</span> (<span class="id">size_poly</span> <span class="id">_</span> <span class="id">_</span>); <span class="id">rewrite</span> !<span class="id">coef_poly</span>/=; <span class="id">apply</span>=&gt; <span class="id">r</span>.<br/>
<span class="id">rewrite</span> <span class="id">horner_poly</span> !<span class="id">big_ord_recr</span> !<span class="id">big_ord0</span>/= !<span class="id">Monoid.simpm</span>/= <span class="id">expr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrA</span> -<span class="id">expr2</span> <span class="id">addrC</span> <span class="id">addrA</span> <span class="id">addrAC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> \<span class="id">min</span> <span class="id">g</span>" (<span class="kwd">at</span> <span class="id">level</span> 50, <span class="id">left</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">min_fun</span> <span class="id">T</span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) <span class="id">x</span> := <span class="id">Num.min</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">x</span>).<br/>
<span class="kwd">Notation</span> "<span class="id"><a name="dependent_choice_Type">f</a></span> \<span class="id">min</span> <span class="id">g</span>" := (<span class="id">min_fun</span> <span class="id">f</span> <span class="id">g</span>) : <span class="id">ring_scope</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">min_fun</span> {<span class="id">T</span> <span class="id"><a name="dependent_choice_Type">R</a></span>} <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> /.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">dependent_choice_Type</span>.<br/>
<span class="kwd">Context</span> <span class="id">X</span> (<span class="id">R</span> : <span class="id">X</span> -&gt; <span class="id">X</span> -&gt; <span class="kwd">Prop</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">dependent_choice_Type</span> : (<span class="kwd">forall</span> <span class="id">x</span>, {<span class="id">y</span> | <span class="id">R</span> <span class="id">x</span> <span class="id">y</span>}) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x0</span>, {<span class="id">f</span> | <span class="id">f</span> 0%<span class="id">N</span> = <span class="id">x0</span> /\ <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">R</span> (<span class="id">f</span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span>.+1)}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof205')">Proof.</span></div>
<div class="proofscript" id="proof205">
<span class="id">move</span>=&gt; <span class="id">h</span> <span class="id">x0</span>.<br/>
<span class="id">set</span> (<span class="id">f</span> := <span class="kwd">fix</span> <span class="id">f</span> <span class="id">n</span> := <span class="kwd">if</span> <span class="id">n</span> <span class="id">is</span> <span class="id">n</span>'.+1 <span class="kwd">then</span> <span class="id">proj1_sig</span> (<span class="id">h</span> (<span class="id">f</span> <span class="id">n</span>')) <span class="kwd">else</span> <span class="id">x0</span>).<br/>
<span class="kwd">exists</span> <span class="id">f</span>; <span class="id">split</span> =&gt; //.<br/>
<span class="id">intro</span> <span class="id">n</span>; <span class="id">induction</span> <span class="id">n</span>; <span class="id"><a name="maxr_absE">simpl</a></span>; <span class="id">apply</span>: <span class="id">proj2_sig</span>.<br/>
Qed.</div>
<span class="kwd">End</span> <span class="id">dependent_choice_Type</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">max_min</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realFieldType</span>.<br/>
<span class="kwd">Import</span> <span class="id">Num.Theory</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">nz2</span> : 2%:<span class="id">R</span> != 0 :&gt; <span class="id">R</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof206')">Proof.</span></div>
<div class="proofscript" id="proof206">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">pnatr_eq0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">maxr_absE</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) : <span class="id">Num.max</span> <span class="id">x</span> <span class="id">y</span> = (<span class="id">x</span> + <span class="id">y</span> + `|<span class="id">x</span> - <span class="id">y</span>|) / 2%:<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof207')">Proof.</span></div>
<div class="proofscript" id="proof207">
<span class="id">apply</span>: <span class="id">canRL</span> (<span class="id">mulfK</span> <span class="id">_</span>) <span class="id">_</span> =&gt; //; <span class="id">rewrite</span> ?<span class="id">pnatr_eq0</span>//.<br/>
<span class="id">case</span>: <span class="id">lerP</span> =&gt; <span class="id">_</span>; <span class="comment">(*&nbsp;TODO:&nbsp;ring&nbsp;*)</span> <span class="id">rewrite</span> [2%:<span class="id">R</span>]<span class="id">mulr2n</span> <span class="id">mulrDr</span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addrACA</span> <span class="id">subrr</span> <span class="id">addr0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addrCA</span> <span class="id">addrAC</span> <span class="id">subrr</span> <span class="id">add0r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">minr_absE</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) : <span class="id">Num.min</span> <span class="id">x</span> <span class="id">y</span> = (<span class="id">x</span> + <span class="id">y</span> - `|<span class="id">x</span> - <span class="id">y</span>|) / 2%:<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof208')">Proof.</span></div>
<div class="proofscript" id="proof208">
<span class="id">apply</span>: (<span class="id"><a name="bigmax_seq">addrI</a></span> (<span class="id">Num.max</span> <span class="id">x</span> <span class="id">y</span>)); <span class="id">rewrite</span> <span class="id">addr_max_min</span> <span class="id">maxr_absE</span>. <span class="comment">(*&nbsp;TODO:&nbsp;ring&nbsp;*)</span><br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrDl</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_seq.I">addrACA</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">subrr</a></span> <span class="id">addr0</span> <span class="id">mulrDl</span> -<span class="id">splitr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">max_min</span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id">trivial</span> := (<span class="id">ltac</span>:(<span class="id">done</span>)).<br/>
<br/>
<span class="kwd">Section</span> <span class="id">bigmax_seq</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> {<span class="id">T</span> : <span class="id">orderType</span> <span class="id">d</span>} {<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_seq.i0">x</a></span> : <span class="id">T</span>} {<span class="id">I</span> : <span class="id">eqType</span>}.<br/>
<span class="kwd">Variables</span> (<span class="id">r</span> : <span class="id">seq</span> <span class="id">I</span>) (<span class="id">i0</span> : <span class="id">I</span>) (<span class="id">P</span> : <span class="id">pred</span> <span class="id">I</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">le_bigmax_seq</span> <span class="id">F</span> :<br/>
&nbsp;&nbsp;<span class="id">i0</span> \<span class="kwd">in</span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id">i0</span> -&gt; (<span class="id">F</span> <span class="id">i0</span> &lt;= \<span class="id">big</span>[<span class="id">Order.max</span>/<span class="id">x</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id">F</span> <span class="id">i</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof209')">Proof.</span></div>
<div class="proofscript" id="proof209">
<span class="id">move</span>=&gt; + <span class="id">Pi0</span>; <span class="id">elim</span>: <span class="id">r</span> =&gt; // <span class="id">h</span> <span class="id">t</span> <span class="id">ih</span>; <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">big_cons</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id"><a name="bigmax_sup_seq">i0t</a></span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">Pi0</span> <span class="id">le_maxr</span>// <span class="id">lexx</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#bigmax_seq.P">ifPn</a></span> =&gt; <span class="id">Ph</span>; [<span class="id">rewrite</span> <span class="id">le_maxr</span> <span class="id">ih</span>// <span class="id">orbT</span>|<span class="id">rewrite</span> <span class="id">ih</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">bigmax_sup_seq</span> (<span class="id">m</span> : <span class="id">T</span>) (<span class="id">F</span> : <span class="id">I</span> -&gt; <span class="id">T</span>) :<br/>
&nbsp;&nbsp;<span class="id">i0</span> \<span class="kwd">in</span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id">i0</span> -&gt; (<span class="id">m</span> &lt;= <span class="id">F</span> <span class="id">i0</span>)%<span class="id">O</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">m</span> &lt;= \<span class="id">big</span>[<span class="id">Order.max</span>/<span class="id">x</span>]<span class="id">_</span>(<span class="id">i</span> &lt;- <span class="id">r</span> | <span class="id">P</span> <span class="id">i</span>) <span class="id"><a name="gerBl">F</a></span> <span class="id">i</span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof210')">Proof.</span></div>
<div class="proofscript" id="proof210">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i0r</span> <span class="id">Pi0</span> ?; <span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id">le_bigmax_seq</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>). Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">bigmax_seq</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">le_bigmax_seq</span> {<span class="id">d</span> <span class="id">T</span>} <span class="id">x</span> {<span class="id">I</span> <span class="id">r</span>} <span class="id">i0</span> <span class="id">P</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">gerBl</span> {<span class="id">R</span> : <span class="id">numDomainType</span>} (<span class="id">x</span> <span class="id">y</span> : <span class="id">R</span>) : 0 &lt;= <span class="id">y</span> -&gt; <span class="id">x</span> - <span class="id">y</span> &lt;= <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof211')">Proof.</span></div>
<div class="proofscript" id="proof211">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y0</span>; <span class="id">rewrite</span> <span class="id">ler_subl_addl</span> <span class="id">ler_addr</span>. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">normr</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realDomainType</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">Rnpos</span> : <span class="id">qualifier</span> 0 <span class="id">R</span> := [<span class="id">qualify</span> <span class="id">x</span> : <span class="id">R</span> | <span class="id">x</span> &lt;= 0].<br/>
<span class="kwd">Lemma</span> <span class="id">nposrE</span> <span class="id">x</span> : (<span class="id">x</span> \<span class="id">is</span> <span class="id">Rnpos</span>) = (<span class="id">x</span> &lt;= 0)<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof212')">Proof.</span></div>
<div class="proofscript" id="proof212">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ger0_le_norm</span> :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Num.nneg</span> &amp;, {<span class="id">mono</span> (@<span class="id">Num.Def.normr</span> <span class="id">_</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof213')">Proof.</span></div>
<div class="proofscript" id="proof213">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> !<span class="id">nnegrE</span> =&gt; <span class="id">x0</span> <span class="id">y0</span>; <span class="id">rewrite</span> !<span class="id">ger0_norm</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gtr0_le_norm</span> :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, {<span class="id">mono</span> (@<span class="id">Num.Def.normr</span> <span class="id">_</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof214')">Proof.</span></div>
<div class="proofscript" id="proof214">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> !<span class="id">posrE</span> =&gt; /<span class="id">ltW</span> <span class="id">x0</span> /<span class="id">ltW</span> <span class="id">y0</span>; <span class="id">exact</span>: <span class="id">ger0_le_norm</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler0_ge_norm</span> :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Rnpos</span> &amp;, {<span class="id">mono</span> (@<span class="id">Num.Def.normr</span> <span class="id">_</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> &gt;-&gt; <span class="id">x</span> &gt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof215')">Proof.</span></div>
<div class="proofscript" id="proof215">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> !<span class="id">nposrE</span> =&gt; <span class="id">x0</span> <span class="id">y0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ler0_norm</span>// -<span class="id">subr_ge0</span> <span class="id">opprK</span> <span class="id">addrC</span> <span class="id">subr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ltr0_ge_norm</span> :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Num.neg</span> &amp;, {<span class="id">mono</span> (@<span class="id">Num.Def.normr</span> <span class="id">_</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> &gt;-&gt; <span class="id">x</span> &gt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof216')">Proof.</span></div>
<div class="proofscript" id="proof216">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> !<span class="id">negrE</span> =&gt; /<span class="id">ltW</span> <span class="id">x0</span> /<span class="id">ltW</span> <span class="id">y0</span>; <span class="id">exact</span>: <span class="id">ler0_ge_norm</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">normr</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">leq_ltn_expn</span> <span class="id">m</span> : <span class="kwd">exists</span> <span class="id">n</span>, (2 ^ <span class="id">n</span> &lt;= <span class="id">m</span>.+1 &lt; 2 ^ <span class="id">n</span>.+1)%<span class="id">N</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof217')">Proof.</span></div>
<div class="proofscript" id="proof217">
<span class="id">elim</span>: <span class="id">m</span> =&gt; [|<span class="id">m</span> [<span class="id">n</span> /<span class="id">andP</span>[<span class="id">h1</span> <span class="id">h2</span>]]]; <span class="id">first</span> <span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">O</span>.<br/>
<span class="id">have</span> [<span class="id">m2n</span>|<span class="id">nm2</span>] := <span class="id">ltnP</span> <span class="id">m</span>.+2 (2 ^ <span class="id">n</span>.+1)%<span class="id">N</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">m2n</span> <span class="id">andbT</span> (<span class="id">leq_trans</span> <span class="id">h1</span>).<br/>
<span class="kwd">exists</span> <span class="id">n</span>.+1; <span class="id">rewrite</span> <span class="id">nm2</span>/= -<span class="id">addn1</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> &lt;= <span class="id">X</span>)%<span class="id">N</span>]<span class="id">prednK</span> ?<span class="id">expn_gt0</span>// -[<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> &lt;= <span class="id">X</span>)%<span class="id">N</span>]<span class="id">addn1</span> <span class="id">leq_add2r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">leq_trans</span> <span class="id">h2</span>)// -<span class="id">subn1</span> <span class="id">leq_subRL</span> ?<span class="id">expn_gt0</span>// <span class="id">add1n</span> <span class="id">ltn_exp2l</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
