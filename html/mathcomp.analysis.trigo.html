
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.trigo</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.trigo" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module mathcomp.analysis.trigo</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">ssralg</span> <span class="id">ssrint</span> <span class="id">ssrnum</span> <span class="id">matrix</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">interval</span> <span class="id">rat</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span> <span class="id"><a href="mathcomp.analysis.nsatz_realtype.html">nsatz_realtype</a></span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.landau.html">landau</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.derive.html">derive</a></span> <span class="id"><a href="mathcomp.analysis.realfun.html">realfun</a></span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                    Theory of trigonometric functions                      
                                                                           
This file provides the definitions of basic trigonometric functions and    
develops their theories.                                                   
                                                                           
   periodic f T == f is a periodic function of period T                    
alternating f T == f is an alternating function of period T                
    sin_coeff x == the sequence of coefficients of sin x                   
          sin x == the sine function, i.e., lim (series (sin_coeff x))     
   sin_coeff' x == the sequence of odd coefficients of sin x               
    cos_coeff x == the sequence of coefficients of cos x                   
          cos x == the cosine function, i.e., lim (series (cos_coeff x))   
   cos_coeff' x == the sequence of even coefficients of cos x              
             pi == pi                                                      
          tan x == the tangent function                                    
         acos x == the arccos function                                     
         asin x == the arcsin function                                     
         atan x == the arctangent function                                 
                                                                           
Acknowledgments: the proof of cos 2 &lt; 0 is inspired from HOL-light, some   
proofs of trigonometric relations are taken from                           
https://github.com/affeldt-aist/coq-robot.                                 
                                                                           
</pre>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Def</span> <span class="id">Num.Theory</span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#numFieldNormedType.Exports">numFieldNormedType.Exports</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sqrtrV">sqrtrV</a></span> (<span class="id">R</span> : <span class="id">rcfType</span>) (<span class="id">x</span> : <span class="id">R</span>) : 0 &lt;= <span class="id">x</span> -&gt; <span class="id">Num.sqrt</span> (<span class="id">x</span>^-1) = (<span class="id">Num.sqrt</span> <span class="id">x</span>)^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">move</span>=&gt; <span class="id">x_ge0</span>.<br/>
<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> 0) =&gt; [-&gt;|/<span class="id">eqP</span> <span class="id">xD0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr0</span> <span class="id">sqrtr0</span> <span class="id">invr0</span>.<br/>
<span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id">mul1r</span> -(<span class="id">mulVf</span> (<span class="id">_</span> : <span class="id">Num.sqrt</span> <span class="id">x</span> != 0)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrtr_eq0</span> -<span class="id">ltNge</span>; <span class="id">case</span>: <span class="id">ltrgt0P</span> <span class="id">x_ge0</span> <span class="id">xD0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrA</span> -<span class="id">sqrtrM</span> // <span class="id">divff</span> // <span class="id">sqrtr1</span> <span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eqr_div">eqr_div</a></span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">t</span> : <span class="id">R</span>):<br/>
&nbsp;&nbsp;<span class="id">y</span> != 0 -&gt; <span class="id">t</span> != 0 -&gt; (<span class="id">x</span> / <span class="id">y</span> == <span class="id">z</span> / <span class="id">t</span>) = (<span class="id">x</span> * <span class="id">t</span> == <span class="id">z</span> * <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">move</span>=&gt; <span class="id">yD0</span> <span class="id">tD0</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">x</span> <span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>](<span class="id">divfK</span> <span class="id">yD0</span>) -[<span class="id">z</span> <span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>](<span class="id">divfK</span> <span class="id">tD0</span>) <span class="id">mulrAC</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span>/<span class="id">eqP</span>=&gt; [-&gt;//|<span class="id">xyty</span>]; <span class="id">exact</span>/(<span class="id">mulIf</span> <span class="id">tD0</span>)/(<span class="id">mulIf</span> <span class="id">yD0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="big_nat_mul">big_nat_mul</a></span> (<span class="id">R</span> : <span class="id">zmodType</span>) (<span class="id">f</span> : <span class="id">R</span> ^<span class="id">nat</span>) (<span class="id">n</span> <span class="id">k</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span> * <span class="id">k</span>) <span class="id">f</span> <span class="id">i</span> =<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>) \<span class="id">sum_</span>(<span class="id">i</span> * <span class="id">k</span> &lt;= <span class="id">j</span> &lt; <span class="id">i</span>.+1 * <span class="id">k</span>) <span class="id">f</span> <span class="id">j</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">elim</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> <span class="id">ih</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0n</span> 2!<span class="id">big_nil</span>.<br/>
<span class="id">rewrite</span> [<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>]<span class="id">big_nat_recr</span>//= -<span class="id">ih</span> <span class="id">mulSn</span> <span class="id">addnC</span> [<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]/<span class="id">index_iota</span> <span class="id">subn0</span> <span class="id">iotaD</span>.<br/>
<span class="id">rewrite</span> <span class="id">big_cat</span> /= [<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = <span class="id">X</span>  <span class="id">_</span>]/<span class="id">index_iota</span> <span class="id">subn0</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">add0n</span> /<span class="id">index_iota</span> (<span class="id">addnC</span> <span class="id">_</span> <span class="id">k</span>) <span class="id">addnK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cvg_series_cvg_series_group">cvg_series_cvg_series_group</a></span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">f</span> : <span class="id">R</span> ^<span class="id">nat</span>) <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.topology.html#cvg">cvg</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">f</span>) -&gt; (0 &lt; <span class="id">k</span>)%<span class="id">N</span> -&gt;<br/>
&nbsp;&nbsp;[<span class="id">series</span> \<span class="id">sum_</span>(<span class="id">n</span> * <span class="id">k</span> &lt;= <span class="id">i</span> &lt; <span class="id">n</span>.+1 * <span class="id">k</span>) <span class="id">f</span> <span class="id">i</span>]<span class="id">_n</span> --&gt; <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.topology.html#cvg_ballP">cvg_ballP</a></span> <span class="id">cf</span> <span class="id">k0</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#cvg_ballP">cvg_ballP</a></span> =&gt; <span class="id">_</span>/<span class="id"><a href="mathcomp.analysis.signed.html#posnumP">posnumP</a></span>[<span class="id">e</span>].<br/>
<span class="id">have</span> := !! <span class="id">cf</span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.signed.html#gt0">gt0</a></span> <span class="id">e</span>) =&gt; -[<span class="id">n</span> <span class="id">_</span> <span class="id">nl</span>]; <span class="id">near</span>=&gt; <span class="id">m</span>.<br/>
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.topology.html#ball">ball</a></span> /= [<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> `|<span class="id">_</span> - <span class="id">X</span>|]/<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> [<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> `|<span class="id">_</span> - <span class="id">X</span>|]/= -<span class="id"><a href="mathcomp.analysis.trigo.html#big_nat_mul">big_nat_mul</a></span>.<br/>
<span class="id">have</span> /<span class="id">nl</span> : (<span class="id">n</span> &lt;= <span class="id">m</span> * <span class="id">k</span>)%<span class="id">N</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>: <span class="id">m</span>; <span class="kwd">exists</span> <span class="id">n</span>.+1 =&gt; //= <span class="id">p</span> /<span class="id">ltnW</span> /<span class="id">leq_trans</span> /(<span class="id">_</span> (<span class="id">leq_pmulr</span> <span class="id">_</span> <span class="id">k0</span>)).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.topology.html#ball">ball</a></span> /= <span class="id">distrC</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lt_sum_lim_series">lt_sum_lim_series</a></span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">f</span> : <span class="id">R</span> ^<span class="id">nat</span>) <span class="id">n</span> : <span class="id"><a href="mathcomp.analysis.topology.html#cvg">cvg</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">f</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">d</span>, 0 &lt; <span class="id">f</span> (<span class="id">n</span> + <span class="id">d</span>.*2)%<span class="id">N</span> + <span class="id">f</span> (<span class="id">n</span> + <span class="id">d</span>.*2.+1)%<span class="id">N</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">f</span> <span class="id">i</span> &lt; <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.topology.html#cvg_ballP">cvg_ballP</a></span> <span class="id">cf</span> <span class="id">fn</span>.<br/>
<span class="id">have</span> <span class="id">fn0</span> : 0 &lt; <span class="id">f</span> <span class="id">n</span> + <span class="id">f</span> <span class="id">n</span>.+1 <span class="kwd">by</span> <span class="id">have</span> := <span class="id">fn</span> 0%<span class="id">N</span>; <span class="id">rewrite</span> <span class="id">double0</span> <span class="id">addn0</span> <span class="id">addn1</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltNge</span>; <span class="id">apply</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contraPN">contraPN</a></span> <span class="id">cf</span> =&gt; <span class="id">ffn</span> /(<span class="id">_</span> <span class="id">_</span> <span class="id">fn0</span>).<br/>
<span class="id">have</span> <span class="id">nf_ub</span> <span class="id">N</span> : \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>.+2) <span class="id">f</span> <span class="id">i</span> &lt;= \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">N</span>.+1.*2 + <span class="id">n</span>) <span class="id">f</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">elim</span>: <span class="id">N</span> =&gt; // <span class="id">N</span> /<span class="id">le_trans</span> -&gt;//; <span class="id">rewrite</span> -(<span class="id">addn1</span> (<span class="id">N</span>.+1)) <span class="id">doubleD</span> <span class="id">addnAC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]/<span class="id">index_iota</span> <span class="id">subn0</span> <span class="id">iotaD</span> <span class="id">big_cat</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> &lt;= <span class="id">X</span> + <span class="id">_</span>](<span class="id">subn0</span> (<span class="id">N</span>.+1.*2 + <span class="id">n</span>)%<span class="id">N</span>) <span class="id">ler_addl</span> /= <span class="id">add0n</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> 2!<span class="id">big_cons</span> <span class="id">big_nil</span> <span class="id">addr0</span> -(<span class="id">addnC</span> <span class="id">n</span>) <span class="id">ltW</span>// -<span class="id">addnS</span> <span class="id">fn</span>.<br/>
<span class="id">case</span>=&gt; <span class="id">N</span> <span class="id">_</span> <span class="id">Nfn</span>; <span class="id">have</span> /<span class="id">Nfn</span>/<span class="id">ltr_distlC_addr</span> : (<span class="id">N</span>.+1.*2 + <span class="id">n</span> &gt;= <span class="id">N</span>)%<span class="id">N</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">doubleS</span> -<span class="id">addn2</span> -<span class="id">addnn</span> -2!<span class="id">addnA</span> <span class="id">leq_addr</span>.<br/>
<span class="id">rewrite</span> <span class="id">addrA</span> =&gt; <span class="id">ffnfn</span>.<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">f</span>) + <span class="id">f</span> <span class="id">n</span> + <span class="id">f</span> <span class="id">n</span>.+1 &lt;= \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">N</span>.+1.*2 + <span class="id">n</span>) <span class="id">f</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">nf_ub</span> <span class="id">N</span>)).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">do</span> 2 <span class="id">rewrite</span> <span class="id">big_nat_recr</span> //=; <span class="kwd">by</span> <span class="id">rewrite</span> -2!<span class="id">addrA</span> <span class="id">ler_add2r</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>/(<span class="id">lt_le_trans</span> <span class="id">ffnfn</span>); <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="periodic">periodic</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="periodic.U">U</a></span> <span class="id"><a name="periodic.V">V</a></span> : <span class="id">zmodType</span>.<br/>
<span class="kwd">Implicit</span> <span class="kwd">Type</span> <span class="id">f</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic.U">U</a></span> -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#periodic.V">V</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="periodic">periodic</a></span> <span class="id">f</span> (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic.U">U</a></span>) := <span class="kwd">forall</span> <span class="id">u</span>, <span class="id">f</span> (<span class="id">u</span> + <span class="id">T</span>) = <span class="id">f</span> <span class="id">u</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="periodicn">periodicn</a></span> <span class="id">f</span> (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic.U">U</a></span>) : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic">periodic</a></span> <span class="id">f</span> <span class="id">T</span> -&gt; <span class="kwd">forall</span> <span class="id">n</span> <span class="id">a</span>, <span class="id">f</span> (<span class="id">a</span> + <span class="id">T</span> *+ <span class="id">n</span>) = <span class="id">f</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fT</span>; <span class="id">elim</span>=&gt; [|<span class="id">n</span> <span class="id">ih</span>] <span class="id">a</span>;[<span class="id">rewrite</span> <span class="id">mulr0n</span> <span class="id">addr0</span>|<span class="id">rewrite</span> <span class="id">mulrS</span> <span class="id">addrA</span> <span class="id">ih</span> <span class="id">fT</span>].<br/>
Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#periodic">periodic</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="alternating">alternating</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="alternating.U">U</a></span> : <span class="id">zmodType</span>) (<span class="id"><a name="alternating.V">V</a></span> : <span class="id">ringType</span>).<br/>
<span class="kwd">Implicit</span> <span class="kwd">Type</span> <span class="id">f</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating.U">U</a></span> -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#alternating.V">V</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="alternating">alternating</a></span> <span class="id">f</span> (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating.U">U</a></span>) := <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> (<span class="id">x</span> + <span class="id">T</span>) = - <span class="id">f</span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alternatingn">alternatingn</a></span> <span class="id">f</span> (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating.U">U</a></span>) : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating">alternating</a></span> <span class="id">f</span> <span class="id">T</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">a</span>, <span class="id">f</span> (<span class="id">a</span> + <span class="id">T</span> *+ <span class="id">n</span>) = (- 1) ^+ <span class="id">n</span> * <span class="id">f</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">move</span>=&gt; <span class="id">fT</span>; <span class="id">elim</span> =&gt; [<span class="id">a</span>|<span class="id">n</span> <span class="id">ih</span> <span class="id">a</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr0n</span> <span class="id">expr0</span> <span class="id">addr0</span> <span class="id">mul1r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrS</span> <span class="id">addrA</span> <span class="id">ih</span> <span class="id">fT</span> <span class="id">exprS</span> <span class="id">mulrN</span> <span class="id">mulN1r</span> <span class="id">mulNr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#alternating">alternating</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CosSin">CosSin</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CosSin.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sin_coeff">sin_coeff</a></span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;[<span class="id">sequence</span> (<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>.-1./2 * <span class="id">x</span> ^+ <span class="id">n</span> / <span class="id">n</span>`!%:<span class="id">R</span>]<span class="id">_n</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_coeffE">sin_coeffE</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span> =<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>.-1./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /= -!<span class="id">mulrA</span> [<span class="id">_</span> / <span class="id">_</span>]<span class="id">mulrC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_coeff_even">sin_coeff_even</a></span> <span class="id">n</span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /= <span class="id">odd_double</span> /= !<span class="id">mul0r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.topology.html#cvg">cvg</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.sequences.html#normed_cvg">normed_cvg</a></span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.sequences.html#series_le_cvg">series_le_cvg</a></span>; <span class="id">last</span> <span class="id">exact</span>: (@<span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_series_exp_coeff">is_cvg_series_exp_coeff</a></span> <span class="id">_</span> `|<span class="id">x</span>|).<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">normr_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">divr_ge0</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">n</span> /=; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.sequences.html#exp_coeff">exp_coeff</a></span> /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">normrM</span> <span class="id">normfV</span> !<span class="id">normr_nat</span> !<span class="id">normrX</span> <span class="id">normrN</span> <span class="id">normr1</span> <span class="id">expr1n</span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: <span class="id">odd</span>; [<span class="id">rewrite</span> <span class="id">mul1r</span>| <span class="id">rewrite</span> !<span class="id">mul0r</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sin">sin</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span> := <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinE">sinE</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> = <span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>.-1./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> -<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeffE">sin_coeffE</a></span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">sin_coeff</span>' <span class="id">x</span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) := (-1)^<span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.*2.+1 / <span class="id">n</span>.*2.+1`!%:<span class="id">R</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">sin_coeff</span>'<span class="id">E</span> <span class="id">x</span> <span class="id">n</span> : <span class="id">sin_coeff</span>' <span class="id">x</span> <span class="id">n</span> = <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2.+1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">sin_coeff</span>' /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /= <span class="id">odd_double</span> <span class="id">mul1r</span> -2!<span class="id">mulrA</span> <span class="id">doubleK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">cvg_sin_coeff</span>' <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id">sin_coeff</span>' <span class="id">x</span>) --&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">have</span> /(@<span class="id"><a href="mathcomp.analysis.trigo.html#cvg_series_cvg_series_group">cvg_series_cvg_series_group</a></span> <span class="id">_</span> <span class="id">_</span> 2) := @<span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span> <span class="id">x</span>.<br/>
<span class="id">move</span>=&gt; /(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>); <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#cvg_trans">cvg_trans</a></span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> --&gt; <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2.+1)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">X</span> --&gt; <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2.+1)) //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span> =&gt; <span class="id">n</span>; <span class="id">exact</span>: <span class="id">sin_coeff</span>'<span class="id">E</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> /= 2!<span class="id">muln2</span> <span class="id">big_nat_recl</span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff_even">sin_coeff_even</a></span> <span class="id">add0r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_nat_recl</span> // <span class="id">big_geq</span> // <span class="id">addr0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diffs_sin">diffs_sin</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>.-1./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) =<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; (~~(<span class="id">odd</span> <span class="id">n</span>))%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1 : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> /= <span class="id">factS</span> <span class="id">natrM</span> <span class="id">invfM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">_</span>.+1%:<span class="id">R</span> * <span class="id">_</span>]<span class="id">mulrC</span> -!<span class="id">mulrA</span> [<span class="id">_</span>.+1%:<span class="id">R</span>^-1 * <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">mulfK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="series_sin_coeff0">series_sin_coeff0</a></span> <span class="id">n</span> : <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> 0) <span class="id">n</span>.+1 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> /= <span class="id">big_nat_recl</span> //= /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /= <span class="id">expr0n</span> <span class="id">divr1</span> !<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big1</span> ?<span class="id">addr0</span> // =&gt; <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">expr0n</span> !(<span class="id">mul0r</span>, <span class="id">mulr0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin0">sin0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> 0 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#lim_near_cst">lim_near_cst</a></span> =&gt; //; <span class="id">near</span>=&gt; <span class="id">m</span>; <span class="id">rewrite</span> -[<span class="id">m</span>]<span class="id">prednK</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">near</span>: <span class="id">m</span>.<br/>
<span class="id">rewrite</span> -<span class="id">addn1</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series_addn">series_addn</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#series_sin_coeff0">series_sin_coeff0</a></span> <span class="id">big_add1</span> <span class="id">big1</span> ?<span class="id">addr0</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> /= <span class="id">expr0n</span> !(<span class="id">mulr0</span>, <span class="id">mul0r</span>).<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cos_coeff">cos_coeff</a></span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;[<span class="id">sequence</span> (~~ <span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1)^<span class="id">n</span>./2 * <span class="id">x</span> ^+ <span class="id">n</span> / <span class="id">n</span>`!%:<span class="id">R</span>]<span class="id">_n</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_coeff_odd">cos_coeff_odd</a></span> <span class="id">n</span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2.+1 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">odd_double</span> /= !<span class="id">mul0r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_coeff_2_0">cos_coeff_2_0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> 2 0%<span class="id">N</span> = 1 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">mul1r</span> <span class="id">expr0</span> <span class="id">mulr1</span> <span class="id">expr0z</span> <span class="id">divff</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_coeff_2_2">cos_coeff_2_2</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> 2 2%<span class="id">N</span> = - 2%:<span class="id">R</span> :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">mul1r</span> <span class="id">expr1z</span> <span class="id">mulN1r</span> <span class="id">expr2</span> <span class="id">mulNr</span> -<span class="id">mulrA</span> <span class="id">divff</span>// <span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_coeff_2_4">cos_coeff_2_4</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> 2 4%<span class="id">N</span> = 2%:<span class="id">R</span> / 3%:<span class="id">R</span> :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">mul1r</span> -<span class="id">exprnP</span> <span class="id">sqrrN</span> <span class="id">expr1n</span> <span class="id">mul1r</span> 2!<span class="id">factS</span> <span class="id">mulnCA</span> <span class="id">mulnC</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> 3!<span class="id">exprS</span> <span class="id">expr1</span> 2!<span class="id">mulrA</span> <span class="id">natrM</span> -<span class="id">mulf_div</span> -2!<span class="id">natrM</span> <span class="id">divff</span>// <span class="id">mul1r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_coeffE">cos_coeffE</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (~~(<span class="id">odd</span> <span class="id">n</span>))%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>./2 *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= -!<span class="id">mulrA</span> [<span class="id">_</span> / <span class="id">_</span>]<span class="id">mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_cvg_series_cos_coeff">is_cvg_series_cos_coeff</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.topology.html#cvg">cvg</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.sequences.html#normed_cvg">normed_cvg</a></span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.sequences.html#series_le_cvg">series_le_cvg</a></span>; <span class="id">last</span> <span class="id">exact</span>: (@<span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_series_exp_coeff">is_cvg_series_exp_coeff</a></span> <span class="id">_</span> `|<span class="id">x</span>|).<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">normr_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">divr_ge0</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">n</span> /=; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.sequences.html#exp_coeff">exp_coeff</a></span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">normrM</span> <span class="id">normfV</span> !<span class="id">normr_nat</span> !<span class="id">normrX</span> <span class="id">normrN</span> <span class="id">normr1</span> <span class="id">expr1n</span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: <span class="id">odd</span>; [<span class="id">rewrite</span> !<span class="id">mul0r</span> | <span class="id">rewrite</span> <span class="id">mul1r</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cos">cos</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span> := <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosE">cosE</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> = <span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; (~~(<span class="id">odd</span> <span class="id">n</span>))%:<span class="id">R</span> * (-1)^+ <span class="id">n</span>./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">x</span> ^+ <span class="id">n</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeffE">cos_coeffE</a></span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">cos_coeff</span>' <span class="id">x</span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) := (-1)^<span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.*2 / <span class="id">n</span>.*2`!%:<span class="id">R</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">cos_coeff</span>'<span class="id">E</span> <span class="id">x</span> <span class="id">n</span> : <span class="id">cos_coeff</span>' <span class="id">x</span> <span class="id">n</span> = <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">rewrite</span> /<span class="id">cos_coeff</span>' /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">odd_double</span> /= <span class="id">mul1r</span> -2!<span class="id">mulrA</span>; <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">half_bit_double</span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">cvg_cos_coeff</span>' <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id">cos_coeff</span>' <span class="id">x</span>) --&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">have</span> /(@<span class="id"><a href="mathcomp.analysis.trigo.html#cvg_series_cvg_series_group">cvg_series_cvg_series_group</a></span> <span class="id">_</span> <span class="id">_</span> 2) := @<span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_cos_coeff">is_cvg_series_cos_coeff</a></span> <span class="id">x</span>.<br/>
<span class="id">move</span>=&gt; /(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>); <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#cvg_trans">cvg_trans</a></span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> --&gt; <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span>=&gt; <span class="id">n</span>; <span class="id">rewrite</span> /= 2!<span class="id">muln2</span> <span class="id">big_nat_recr</span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff_odd">cos_coeff_odd</a></span> <span class="id">addr0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_nat_recl</span>//= /<span class="id">index_iota</span> <span class="id">subnn</span> <span class="id">big_nil</span> <span class="id">addr0</span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">X</span> --&gt; <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> <span class="id">x</span> <span class="id">n</span>.*2)) //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span> =&gt; <span class="id">n</span>; <span class="id">exact</span>: <span class="id">cos_coeff</span>'<span class="id">E</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diffs_cos">diffs_cos</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (~~(<span class="id">odd</span> <span class="id">n</span>))%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) =<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; - ((<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>.-1./2 * (<span class="id">n</span>`!%:<span class="id">R</span>)^-1): <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; [] [|<span class="id">i</span>] /=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> /= !<span class="id">mul0r</span> <span class="id">mulr0</span> <span class="id">oppr0</span>.<br/>
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> /= <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span> <span class="id">exprS</span> <span class="id">mulN1r</span> !(<span class="id">mulNr</span>, <span class="id">mulrN</span>).<br/>
<span class="id">rewrite</span> <span class="id">factS</span> <span class="id">natrM</span> <span class="id">invfM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">_</span>.+1%:<span class="id">R</span> * <span class="id">_</span>]<span class="id">mulrC</span> -!<span class="id">mulrA</span> [<span class="id">_</span>.+1%:<span class="id">R</span>^-1 * <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">mulfK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="series_cos_coeff0">series_cos_coeff0</a></span> <span class="id">n</span> : <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> 0) <span class="id">n</span>.+1 = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> /= <span class="id">big_nat_recl</span> //= /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">expr0n</span> <span class="id">divr1</span> !<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big1</span> ?<span class="id">addr0</span> // =&gt; <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">expr0n</span> !(<span class="id">mul0r</span>, <span class="id">mulr0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos0">cos0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 0 = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#lim_near_cst">lim_near_cst</a></span> =&gt; //; <span class="id">near</span>=&gt; <span class="id">m</span>; <span class="id">rewrite</span> -[<span class="id">m</span>]<span class="id">prednK</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">near</span>: <span class="id">m</span>.<br/>
<span class="id">rewrite</span> -<span class="id">addn1</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series_addn">series_addn</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#series_cos_coeff0">series_cos_coeff0</a></span> <span class="id">big_add1</span> <span class="id">big1</span> ?<span class="id">addr0</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> /= <span class="id">expr0n</span> !(<span class="id">mulr0</span>, <span class="id">mul0r</span>).<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="is_derive_sin">is_derive_sin</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinE">sinE</a></span> /=.<br/>
<span class="id">pose</span> <span class="id">s</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>^<span class="id">nat</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ (<span class="id">n</span>.-1)./2 / <span class="id">n</span>`!%:<span class="id">R</span>.<br/>
<span class="id">pose</span> <span class="id">s1</span> <span class="id">n</span> := <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> <span class="id">s</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosE">cosE</a></span> /= /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">s1</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">s1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_sin">diffs_sin</a></span>.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="mathcomp.analysis.exp.html#pseries_snd_diffs">pseries_snd_diffs</a></span> <span class="id">_</span> <span class="id">_</span> (`|<span class="id">x</span>| + 1)); <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeffE">sin_coeffE</a></span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span>.<br/>
- <span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> (`|<span class="id">x</span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_cos_coeff">is_cvg_series_cos_coeff</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_sin">diffs_sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeffE">cos_coeffE</a></span>.<br/>
- <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> (`|<span class="id">x</span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_seriesN">is_cvg_seriesN</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_sin">diffs_sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_cos">diffs_cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeffE">sin_coeffE</a></span> !<span class="id"><a href="mathcomp.classical.functions.html#fctE">fctE</a></span> !<span class="id">mulNr</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltRHS">ltRHS</a></span>]<span class="id">ger0_norm</span>// <span class="id">addrC</span> -<span class="id">subr_gt0</span> <span class="id">addrK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="derivable_sin">derivable_sin</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.derive.html#derivable">derivable</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#ex_derive">ex_derive</a></span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_sin">is_derive_sin</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_sin">continuous_sin</a></span> : <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.derive.html#differentiable_continuous">differentiable_continuous</a></span>/<span class="id"><a href="mathcomp.analysis.derive.html#derivable1_diffP">derivable1_diffP</a></span>/<span class="id"><a href="mathcomp.analysis.trigo.html#derivable_sin">derivable_sin</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="is_derive_cos">is_derive_cos</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (- (<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosE">cosE</a></span> /=.<br/>
<span class="id">pose</span> <span class="id">s</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin.R">R</a></span>^<span class="id">nat</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; (~~ <span class="id">odd</span> <span class="id">n</span>)%:<span class="id">R</span> * (-1) ^+ <span class="id">n</span>./2 / <span class="id">n</span>`!%:<span class="id">R</span>.<br/>
<span class="id">pose</span> <span class="id">s1</span> <span class="id">n</span> := <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs</a></span> <span class="id">s</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinE">sinE</a></span> /= /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = - <span class="id">s1</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">s1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_cos">diffs_cos</a></span> !<span class="id"><a href="mathcomp.classical.functions.html#fctE">fctE</a></span> <span class="id">mulNr</span> <span class="id">opprK</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#lim_seriesN">lim_seriesN</a></span> ?<span class="id">opprK</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">s1</span> = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_seriesN">is_cvg_seriesN</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">s1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_cos">diffs_cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeffE">sin_coeffE</a></span> !<span class="id"><a href="mathcomp.classical.functions.html#fctE">fctE</a></span> <span class="id">mulNr</span>.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="mathcomp.analysis.exp.html#pseries_snd_diffs">pseries_snd_diffs</a></span> <span class="id">_</span> <span class="id">_</span> (`|<span class="id">x</span>| + 1)).<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeffE">cos_coeffE</a></span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_cos_coeff">is_cvg_series_cos_coeff</a></span>.<br/>
- <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeff">sin_coeff</a></span> (`|<span class="id">x</span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_seriesN">is_cvg_seriesN</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_sin_coeff">is_cvg_series_sin_coeff</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_cos">diffs_cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_coeffE">sin_coeffE</a></span> !<span class="id"><a href="mathcomp.classical.functions.html#fctE">fctE</a></span> <span class="id">mulNr</span>.<br/>
- <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.exp.html#pseries">pseries</a></span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span>=&gt; <span class="id">_</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff">cos_coeff</a></span> (`|<span class="id">x</span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#is_cvg_seriesN">is_cvg_seriesN</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_cvg_series_cos_coeff">is_cvg_series_cos_coeff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_cos">diffs_cos</a></span> <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffsN">pseries_diffsN</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#diffs_sin">diffs_sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeffE">cos_coeffE</a></span> <span class="id">mulNr</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltRHS">ltRHS</a></span>]<span class="id">ger0_norm</span>// <span class="id">addrC</span> -<span class="id">subr_gt0</span> <span class="id">addrK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="derivable_cos">derivable_cos</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.derive.html#derivable">derivable</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#ex_derive">ex_derive</a></span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_cos">is_derive_cos</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_cos">continuous_cos</a></span> : <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">exact</span>/<span class="id"><a href="mathcomp.analysis.derive.html#differentiable_continuous">differentiable_continuous</a></span>/<span class="id"><a href="mathcomp.analysis.derive.html#derivable1_diffP">derivable1_diffP</a></span>/<span class="id"><a href="mathcomp.analysis.trigo.html#derivable_cos">derivable_cos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos2Dsin2">cos2Dsin2</a></span> <span class="id">x</span> : (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>) ^+ 2 + (<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>) ^+ 2 = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">set</span> <span class="id">v</span> := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>; <span class="id">pattern</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">v</span>; <span class="id">move</span>: @<span class="id">v</span>; <span class="id">set</span> <span class="id">f</span> := (<span class="id">X</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">_</span> := <span class="id">X</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">_</span>) =&gt; /=.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#eq_trans">eq_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> 0)); <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id">expr1n</span> <span class="id">expr0n</span> <span class="id">addr0</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_0_is_cst">is_derive_0_is_cst</a></span> =&gt; {}<span class="id">x</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#trigger_derive">trigger_derive</a></span>; <span class="id">rewrite</span> /<span class="id">GRing.scale</span> /=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrN</span> ![<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id">_</span>]<span class="id">mulrC</span> -<span class="id">opprD</span> <span class="id">addrC</span> <span class="id">subrr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_max">cos_max</a></span> <span class="id">x</span> : `| <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> | &lt;= 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">rewrite</span> -(<span class="id">expr_le1</span> (<span class="id">_</span> : 0 &lt; 2)%<span class="id">nat</span>) // -<span class="id">normrX</span> <span class="id">ger0_norm</span> ?<span class="id">exprn_even_ge0</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.trigo.html#cos2Dsin2">cos2Dsin2</a></span> <span class="id">x</span>) <span class="id">ler_addl</span> ?<span class="id">sqr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_geN1">cos_geN1</a></span> <span class="id">x</span> : -1 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_oppl</span>; <span class="id">have</span> /<span class="id">ler_normlP</span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#cos_max">cos_max</a></span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_le1">cos_le1</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> &lt;= 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="kwd">by</span> <span class="id">have</span> /<span class="id">ler_normlP</span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#cos_max">cos_max</a></span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_max">sin_max</a></span> <span class="id">x</span> : `| <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> | &lt;= 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">rewrite</span> -(<span class="id">expr_le1</span> (<span class="id">_</span> : 0 &lt; 2)%<span class="id">nat</span>) // -<span class="id">normrX</span> <span class="id">ger0_norm</span> ?<span class="id">exprn_even_ge0</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.trigo.html#cos2Dsin2">cos2Dsin2</a></span> <span class="id">x</span>) <span class="id">ler_addr</span> ?<span class="id">sqr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_geN1">sin_geN1</a></span> <span class="id">x</span> : -1 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_oppl</span>; <span class="id">have</span> /<span class="id">ler_normlP</span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#sin_max">sin_max</a></span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_le1">sin_le1</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> &lt;= 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="kwd">by</span> <span class="id">have</span> /<span class="id">ler_normlP</span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#sin_max">sin_max</a></span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id"><a name="sinD_cosD">sinD_cosD</a></span> <span class="id">x</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">x</span> + <span class="id">y</span>) - (<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>)) ^+ 2 +<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">x</span> + <span class="id">y</span>) - (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>)) ^+ 2 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">set</span> <span class="id">v</span> := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>; <span class="id">pattern</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">v</span>; <span class="id">move</span>: @<span class="id">v</span>; <span class="id">set</span> <span class="id">f</span> := (<span class="id">X</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">_</span> := <span class="id">X</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">_</span>) =&gt; /=.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#eq_trans">eq_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> 0)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span> !(<span class="id">mul1r</span>, <span class="id">mul0r</span>, <span class="id">add0r</span>, <span class="id">subr0</span>, <span class="id">subrr</span>, <span class="id">expr0n</span>).<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_0_is_cst">is_derive_0_is_cst</a></span> =&gt; {}<span class="id">x</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#trigger_derive">trigger_derive</a></span>; <span class="id">rewrite</span> /<span class="id">GRing.scale</span> /=; <span class="id">nsatz</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinD">sinD</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">have</span> /<span class="id">eqP</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sinD_cosD">sinD_cosD</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id">paddr_eq0</span> =&gt; [/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]||]; <span class="id">try</span> <span class="id">exact</span>: <span class="id">sqr_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrf_eq0</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosD">cosD</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="id">have</span> /<span class="id">eqP</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sinD_cosD">sinD_cosD</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id">paddr_eq0</span> =&gt; [/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">_</span>]||]; <span class="id">try</span> <span class="id">exact</span>: <span class="id">sqr_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrf_eq0</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin2cos2">sin2cos2</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> ^+ 2 = 1 - <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> ^+ 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">eqP</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#cos2Dsin2">cos2Dsin2</a></span> <span class="id">x</span>); <span class="id">rewrite</span> <span class="id">eq_sym</span> <span class="id">addrC</span> -<span class="id">subr_eq</span> =&gt; /<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos2sin2">cos2sin2</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> ^+ 2 = 1 - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> ^+ 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">eqP</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#cos2Dsin2">cos2Dsin2</a></span> <span class="id">x</span>); <span class="id">rewrite</span> <span class="id">eq_sym</span> -<span class="id">subr_eq</span> =&gt; /<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_mulr2n">sin_mulr2n</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">x</span> *+ 2) = (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>) *+ 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr2n</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id">mulrC</span> -<span class="id">mulr2n</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_mulr2n">cos_mulr2n</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">x</span> *+ 2) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> ^+2 *+ 2 - 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr2n</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> -!<span class="id">expr2</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span> <span class="id">opprB</span> <span class="id">addrA</span> <span class="id">mulr2n</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id"><a name="sinN_cosN">sinN_cosN</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (- <span class="id">x</span>) + <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>) ^+ 2 + (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (- <span class="id">x</span>) - <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>) ^+ 2 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">set</span> <span class="id">v</span> := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>; <span class="id">pattern</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">v</span>; <span class="id">move</span>: @<span class="id">v</span>; <span class="id">set</span> <span class="id">f</span> := (<span class="id">X</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">_</span> := <span class="id">X</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">_</span>) =&gt; /=.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#eq_trans">eq_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> 0)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">f</span> <span class="id">oppr0</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span> !(<span class="id">addr0</span>, <span class="id">subrr</span>, <span class="id">expr0n</span>).<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_0_is_cst">is_derive_0_is_cst</a></span> =&gt; {}<span class="id">x</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#trigger_derive">trigger_derive</a></span>; <span class="id">rewrite</span> /<span class="id">GRing.scale</span> /=; <span class="id">nsatz</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinN">sinN</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (- <span class="id">x</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">have</span> /<span class="id">eqP</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sinN_cosN">sinN_cosN</a></span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id">paddr_eq0</span> =&gt; [/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]||]; <span class="id">try</span> <span class="id">exact</span>: <span class="id">sqr_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrf_eq0</span> <span class="id">addr_eq0</span> =&gt; /<span class="id">eqP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosN">cosN</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (- <span class="id">x</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="id">have</span> /<span class="id">eqP</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sinN_cosN">sinN_cosN</a></span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id">paddr_eq0</span> =&gt; [/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">_</span>]||]; <span class="id">try</span> <span class="id">exact</span>: <span class="id">sqr_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrf_eq0</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_sg">sin_sg</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">Num.sg</span> <span class="id">x</span> * <span class="id">y</span>) = <span class="id">Num.sg</span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">sgrP</span>; <span class="id">rewrite</span> ?<span class="id">mul1r</span> ?<span class="id">mulN1r</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> // !<span class="id">mul0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_sg">cos_sg</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id">x</span> != 0 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">Num.sg</span> <span class="id">x</span> * <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">sgrP</span>; <span class="id">rewrite</span> ?<span class="id">mul1r</span> ?<span class="id">mulN1r</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosB">cosB</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> <span class="id">mulrN</span> <span class="id">opprK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinB">sinB</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> - <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> <span class="id">mulrN</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_cos_eq1">norm_cos_eq1</a></span> <span class="id">x</span> : (`|<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>| == 1) = (<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> == 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">rewrite</span> -<span class="id">sqrf_eq0</span> -<span class="id">sqrp_eq1</span> // -<span class="id">normrX</span> <span class="id">ger0_norm</span> ?<span class="id">exprn_even_ge0</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = (<span class="id">X</span> == <span class="id">_</span>)]<span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span> <span class="id">subr_eq0</span> <span class="id">eq_sym</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_sin_eq1">norm_sin_eq1</a></span> <span class="id">x</span> : (`|<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>| == 1) = (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> == 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="id">rewrite</span> -<span class="id">sqrf_eq0</span> -<span class="id">sqrp_eq1</span> // -<span class="id">normrX</span> <span class="id">ger0_norm</span> ?<span class="id">exprn_even_ge0</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = (<span class="id">X</span> == <span class="id">_</span>)]<span class="id"><a href="mathcomp.analysis.trigo.html#cos2sin2">cos2sin2</a></span> <span class="id">subr_eq0</span> <span class="id">eq_sym</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos1sin0">cos1sin0</a></span> <span class="id">x</span> : `|<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>| = 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#norm_cos_eq1">norm_cos_eq1</a></span> =&gt; /<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin1cos0">sin1cos0</a></span> <span class="id">x</span> : `|<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>| = 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#norm_sin_eq1">norm_sin_eq1</a></span> =&gt; /<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin0cos1">sin0cos1</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> = 0 -&gt; `|<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>| = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#norm_cos_eq1">norm_cos_eq1</a></span> =&gt; /<span class="id">eqP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_norm">cos_norm</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> `|<span class="id">x</span>| = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
 <span class="kwd">by</span> <span class="id">case</span>: (<span class="id">ler0P</span> <span class="id">x</span>); <span class="id">rewrite</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#CosSin">CosSin</a></span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> {<span class="id">R</span>}.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> {<span class="id">R</span>}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Pi">Pi</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Pi.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>) (<span class="id">n</span> <span class="id">k</span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pi">pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span> := <span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> [<span class="id">set</span> <span class="id">x</span> | 0 &lt;= <span class="id">x</span> &lt;= 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> = 0] *+ 2.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pihalfE">pihalfE</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 = <span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> [<span class="id">set</span> <span class="id">x</span> | 0 &lt;= <span class="id">x</span> &lt;= 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> = 0].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> -(<span class="id">mulr_natr</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> <span class="id">_</span>)) -<span class="id">mulrA</span> <span class="id">divff</span> ?<span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos2_lt0">cos2_lt0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 2 &lt; 0 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="id">rewrite</span> -(<span class="id">opprK</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">_</span>)) <span class="id">oppr_lt0</span>; <span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#cvgN">cvgN</a></span> <span class="id">h</span> := @<span class="id">cvg_cos_coeff</span>' <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span> 2.<br/>
<span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">cvg_lim</a></span> (@<span class="id"><a href="mathcomp.analysis.topology.html#Rhausdorff">Rhausdorff</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>) <span class="id">h</span>).<br/>
<span class="id">apply</span>: (@<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">_</span> (\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; 3) - <span class="id">cos_coeff</span>' 2 <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">do</span> 3 <span class="id">rewrite</span> <span class="id">big_nat_recl</span>//; <span class="id">rewrite</span> <span class="id">big_nil</span> <span class="id">addr0</span> 3!<span class="id">cos_coeff</span>'<span class="id">E</span> <span class="id">double0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff_2_0">cos_coeff_2_0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff_2_2">cos_coeff_2_2</a></span> -<span class="id">muln2</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_coeff_2_4">cos_coeff_2_4</a></span> <span class="id">addrA</span> -(<span class="id">opprD</span> 1).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">opprB</span> -(@<span class="id">natrB</span> <span class="id">_</span> 2 1)// <span class="id">subn1</span>/= -[<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> - <span class="id">_</span>](@<span class="id">divff</span> <span class="id">_</span> 3%:<span class="id">R</span>)//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrBl</span> <span class="id">divr_gt0</span>// -<span class="id">natrB</span>// -[(<span class="id">_</span> - <span class="id">_</span>)%<span class="id">N</span>]/<span class="id">_</span>.+1.<br/>
<span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.sequences.html#seriesN">seriesN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#lt_sum_lim_series">lt_sum_lim_series</a></span> //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>/<span class="id"><a href="mathcomp.analysis.topology.html#cvgP">cvgP</a></span> <span class="kwd">in</span> <span class="id">h</span>; <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#seriesN">seriesN</a></span>.<br/>
<span class="id">move</span>=&gt; <span class="id">d</span>.<br/>
<span class="id">rewrite</span> /<span class="id">cos_coeff</span>' 2!<span class="id">exprzD_nat</span> (<span class="id">exprSz</span> <span class="id">_</span> <span class="id">d</span>.*2) -[<span class="kwd">in</span> (-1) ^ <span class="id">d</span>.*2](<span class="id">muln2</span> <span class="id">d</span>).<br/>
<span class="id">rewrite</span> -(<span class="id">exprnP</span> <span class="id">_</span> (<span class="id">d</span> * 2)) (<span class="id">exprM</span> (-1)) <span class="id">sqrr_sign</span> 2!<span class="id">mulr1</span> -<span class="id">exprSzr</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : 4 = 2 * 2)%<span class="id">N</span> // -(<span class="id">exprnP</span> <span class="id">_</span> (2 * 2)) (<span class="id">exprM</span> (-1)) <span class="id">sqrr_sign</span>.<br/>
<span class="id">rewrite</span> <span class="id">mul1r</span> [(-1) ^ 3](<span class="id">_</span> : <span class="id">_</span> = -1) ?<span class="id">mulN1r</span> ?<span class="id">mulNr</span> ?<span class="id">opprK</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">exprnP</span> 2!<span class="id">exprS</span> <span class="id">expr1</span> <span class="id">mulrN1</span> <span class="id">opprK</span> <span class="id">mulr1</span>.<br/>
<span class="id">rewrite</span> <span class="id">subr_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">addnS</span> <span class="id">doubleS</span> -[<span class="id">X</span> <span class="kwd">in</span> 2 ^+ <span class="id">X</span>]<span class="id">addn2</span> <span class="id">exprD</span> -<span class="id">mulrA</span> <span class="id">ltr_pmul2l</span>//.<br/>
<span class="id">rewrite</span> <span class="id">factS</span> <span class="id">factS</span> 2!<span class="id">natrM</span> <span class="id">mulrA</span> <span class="id">invfM</span> !<span class="id">mulrA</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pdivr_mulr</span> ?<span class="id">ltr0n</span> ?<span class="id">fact_gt0</span>// <span class="id">mulVf</span> ?<span class="id">pnatr_eq0</span> ?<span class="id">gtn_eqF</span> ?<span class="id">fact_gt0</span>//.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pdivr_mulr</span> ?<span class="id">mul1r</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expr2</span> -!<span class="id">natrM</span> <span class="id">ltr_nat</span> !<span class="id">mulSn</span> !<span class="id">add2n</span> <span class="id">mul0n</span> !<span class="id">addnS</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin2_gt0">sin2_gt0</a></span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> &lt; 2 -&gt; 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gt0</span> <span class="id">x_lt2</span>].<br/>
<span class="id">have</span> <span class="id">sinx</span> := @<span class="id">cvg_sin_coeff</span>' <span class="id">_</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">cvg_lim</a></span> (@<span class="id"><a href="mathcomp.analysis.topology.html#Rhausdorff">Rhausdorff</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>) <span class="id">sinx</span>).<br/>
<span class="id">rewrite</span> [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltLHS">ltLHS</a></span>](<span class="id">_</span> : 0 = \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; 0) <span class="id">sin_coeff</span>' <span class="id">x</span> <span class="id">i</span> :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_nil</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#lt_sum_lim_series">lt_sum_lim_series</a></span> //; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>/<span class="id"><a href="mathcomp.analysis.topology.html#cvgP">cvgP</a></span> <span class="kwd">in</span> <span class="id">sinx</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">d</span>.<br/>
<span class="id">rewrite</span> /<span class="id">sin_coeff</span>' 2!<span class="id">exprzD_nat</span> (<span class="id">exprSz</span> <span class="id">_</span> <span class="id">d</span>.*2) -[<span class="kwd">in</span> (-1) ^ <span class="id">d</span>.*2](<span class="id">muln2</span> <span class="id">d</span>).<br/>
<span class="id">rewrite</span> -(<span class="id">exprnP</span> <span class="id">_</span> (<span class="id">d</span> * 2)) (<span class="id">exprM</span> (-1)) <span class="id">sqrr_sign</span> 2!<span class="id">mulr1</span> -<span class="id">exprSzr</span>.<br/>
<span class="id">rewrite</span> !<span class="id">add0n</span>!<span class="id">mul1r</span> <span class="id">mulN1r</span> -[<span class="id">d</span>.*2.+1]<span class="id">addn1</span> <span class="id">doubleD</span> -<span class="id">addSn</span> <span class="id">exprD</span>.<br/>
<span class="id">rewrite</span> -(<span class="id">ffact_fact</span> (<span class="id">leq_addl</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">addnK</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulNr</span> -!<span class="id">mulrA</span> -<span class="id">mulrBr</span> <span class="id">mulr_gt0</span> ?<span class="id">exprn_gt0</span> //.<br/>
<span class="id">set</span> <span class="id">u</span> := <span class="id">_</span>.+1.<br/>
<span class="id">rewrite</span> <span class="id">natrM</span> <span class="id">invfM</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> &lt; <span class="id">X</span> - <span class="id">_</span>]<span class="id">mul1r</span> !<span class="id">mulrA</span> -<span class="id">mulrBl</span> <span class="id">divr_gt0</span> //; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">ltr_nat</span> <span class="id">_</span> 0) <span class="id">fact_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">subr_gt0</span>.<br/>
<span class="id">set</span> <span class="id">v</span> := <span class="id">_</span> ^<span class="id">_</span> <span class="id">_</span>; <span class="id">rewrite</span> -[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltRHS">ltRHS</a></span>](<span class="id">divff</span> (<span class="id">_</span> : <span class="id">v</span>%:<span class="id">R</span> != 0)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt0r_neq0</span> // (<span class="id">ltr_nat</span> <span class="id">_</span> 0) <span class="id">ffact_gt0</span> <span class="id">leq_addl</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pmul2r</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_gt0</span> (<span class="id">ltr_nat</span> <span class="id">_</span> 0) <span class="id">ffact_gt0</span> <span class="id">leq_addl</span>.<br/>
<span class="id">rewrite</span> {}/<span class="id">v</span> !<span class="id">addnS</span> <span class="id">addn0</span> !<span class="id">ffactnS</span> <span class="id">ffactn0</span> <span class="id">muln1</span> /= <span class="id">natrM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">ltr_pmul</span> (<span class="id">ltW</span> <span class="id">_</span> ) (<span class="id">ltW</span> <span class="id">_</span>)) // (<span class="id">lt_le_trans</span> <span class="id">x_lt2</span>) // <span class="id">ler_nat</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos1_gt0">cos1_gt0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 1 &gt; 0 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
<span class="id">have</span> <span class="id">h</span> := @<span class="id">cvg_cos_coeff</span>' <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span> 1; <span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">cvg_lim</a></span> (@<span class="id"><a href="mathcomp.analysis.topology.html#Rhausdorff">Rhausdorff</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>) <span class="id">h</span>).<br/>
<span class="id">apply</span>: (@<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">_</span> (\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; 2) <span class="id">cos_coeff</span>' 1 <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_nat_recr</span>//= <span class="id">big_nat_recr</span>//= <span class="id">big_nil</span> <span class="id">add0r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">cos_coeff</span>' <span class="id">expr0z</span> <span class="id">expr1n</span> <span class="id">fact0</span> !<span class="id">mul1r</span> <span class="id">expr1n</span> <span class="id">expr1z</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">mulNr</span> <span class="id">subr_gt0</span> <span class="id">mul1r</span> <span class="id">div1r</span> <span class="id">ltf_pinv</span> ?<span class="id">posrE</span> ?<span class="id">ltr0n</span>// <span class="id">ltr_nat</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#lt_sum_lim_series">lt_sum_lim_series</a></span> //; [<span class="kwd">by</span> <span class="id">move</span>/<span class="id"><a href="mathcomp.analysis.topology.html#cvgP">cvgP</a></span> <span class="kwd">in</span> <span class="id">h</span>|<span class="id">move</span>=&gt; <span class="id">d</span>].<br/>
<span class="id">rewrite</span> /<span class="id">cos_coeff</span>' !(<span class="id">expr1n</span>,<span class="id">mulr1</span>).<br/>
<span class="id">rewrite</span> -<span class="id">muln2</span> -<span class="id">mulSn</span> <span class="id">muln2</span> -<span class="id">exprnP</span> -<span class="id">signr_odd</span> <span class="id">odd_double</span> <span class="id">expr0</span>.<br/>
<span class="id">rewrite</span> -<span class="id">exprnP</span> -<span class="id">signr_odd</span> <span class="id">oddD</span>/= <span class="id">muln2</span> <span class="id">odd_double</span>/= <span class="id">expr1</span> <span class="id">add2n</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulNr</span> <span class="id">subr_gt0</span> 2!<span class="id">div1r</span> <span class="id">ltf_pinv</span> ?<span class="id">posrE</span> ?<span class="id">ltr0n</span> ?<span class="id">fact_gt0</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_nat</span> <span class="id">ltn_pfact</span>//<span class="id">ltn_double</span> <span class="id">doubleS</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_exists">cos_exists</a></span> : <span class="kwd">exists2</span> <span class="id">pih</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>, 1 &lt;= <span class="id">pih</span> &lt;= 2 &amp; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">pih</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#IVT">IVT</a></span>[] : <span class="id">minr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 1) (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 2) &lt;= (0 : <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>) &lt;= <span class="id">maxr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 1) (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 2).<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_maxr</span> (<span class="id">ltW</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos1_gt0">cos1_gt0</a></span>) <span class="id">le_minl</span> (<span class="id">ltW</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos2_lt0">cos2_lt0</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbC">orbC</a></span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler1n</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">pih</span> /<span class="id">itvP</span> <span class="id">pihI</span> <span class="id">chpi_eq0</span>; <span class="kwd">exists</span> <span class="id">pih</span>; <span class="id">rewrite</span> ?<span class="id">pihI</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_02_uniq">cos_02_uniq</a></span> <span class="id">x</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">x</span> &lt;= 2 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> = 0 -&gt; 0 &lt;= <span class="id">y</span> &lt;= 2 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> = 0 -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
<span class="id">wlog</span> <span class="id">xLy</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> =&gt; [<span class="id">H</span> <span class="id">xB</span> <span class="id">cx0</span> <span class="id">yB</span> <span class="id">cy0</span>|].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">lerP</span> <span class="id">x</span> <span class="id">y</span>) =&gt; [/<span class="id">H</span> //| /<span class="id">ltW</span> /<span class="id">H</span> <span class="id">H1</span>]; [<span class="id">exact</span>|<span class="id">exact</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#esym">esym</a></span>/<span class="id">H1</span>].<br/>
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_ge0</span> <span class="id">x_le2</span>] <span class="id">cx0</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">y_ge0</span> <span class="id">y_le2</span>] <span class="id">cy0</span>.<br/>
<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> <span class="id">y</span>) =&gt; // /<span class="id">eqP</span> <span class="id">xDy</span>.<br/>
<span class="id">have</span> <span class="id">xLLs</span> : <span class="id">x</span> &lt; <span class="id">y</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_eqVlt</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negPf">negPf</a></span> <span class="id">xDy</span>) <span class="kwd">in</span> <span class="id">xLy</span>.<br/>
<span class="id">have</span> /(<span class="id"><a href="mathcomp.analysis.derive.html#Rolle">Rolle</a></span> <span class="id">xLLs</span>)[<span class="id">x1</span> <span class="id">_</span>|<span class="id">x1</span>|<span class="id">x1</span> <span class="id">x1I</span> [<span class="id">_</span> <span class="id">x1D</span>]] : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">cy0</span>.<br/>
- <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#derivable_cos">derivable_cos</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
- <span class="id">have</span> [<span class="id">_</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#esym">esym</a></span>/<span class="id">eqP</span>] := <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_cos">is_derive_cos</a></span> <span class="id">x1</span>; <span class="id">rewrite</span> <span class="id">x1D</span> <span class="id">oppr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x1</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">Hs</span> <span class="id">ltxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#sin2_gt0">sin2_gt0</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_lt_trans</span> <span class="id">x_ge0</span>)// (<span class="id">itvP</span> <span class="id">x1I</span>).<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">y_le2</span>)// (<span class="id">itvP</span> <span class="id">x1I</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pihalf_02_cos_pihalf">pihalf_02_cos_pihalf</a></span> : 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 &lt;= 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
<span class="id">have</span> [<span class="id">x</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x1</span> <span class="id">x2</span>] <span class="id">cs0</span>] := <span class="id"><a href="mathcomp.analysis.trigo.html#cos_exists">cos_exists</a></span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalfE">pihalfE</a></span>.<br/>
<span class="id">case</span>: <span class="id"><a href="mathcomp.classical.classical_sets.html#xgetP">xgetP</a></span> =&gt; [<span class="id">_</span>-&gt;[]//|/(<span class="id">_</span> <span class="id">x</span>)/=].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">cs0</span> (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">x1</span>)// <span class="id">x2</span> =&gt; /<span class="id"><a href="mathcomp.classical.boolp.html#not_andP">not_andP</a></span>[].<br/>
Qed.</div>
<br/>
#[<span class="id">deprecated</span>(<span class="id">note</span>="<span class="id">Use</span> <span class="id">pihalf_ge1</span> <span class="id">and</span> <span class="id">pihalf_lt2</span> <span class="id">instead</span>")]<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pihalf_02">pihalf_02</a></span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 &lt; 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
<span class="id">have</span> [<span class="id">pih02</span> <span class="id">cpih</span>] := <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_02_cos_pihalf">pihalf_02_cos_pihalf</a></span>.<br/>
<span class="id">rewrite</span> 2!<span class="id">lt_neqAle</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbCA">andbCA</a></span> -<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbA">andbA</a></span> <span class="id">pih02</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span> =&gt; <span class="id">pih2</span>; <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#cos2_lt0">cos2_lt0</a></span>; <span class="id">rewrite</span> -<span class="id">pih2</span> <span class="id">cpih</span> <span class="id">ltxx</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span> =&gt; <span class="id">pih0</span>; <span class="id">have</span> := @<span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">pih0</span> <span class="id">cpih</span>; <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_sym</span> <span class="id">oner_eq0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Pi.pihalf_12">pihalf_12</a></span> : 1 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 &lt; 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
<span class="id">have</span> [/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">pih0</span> <span class="id">pih2</span>] <span class="id">cpih</span>] := <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_02_cos_pihalf">pihalf_02_cos_pihalf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">lt_neqAle</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbA">andbA</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbAC">andbAC</a></span> <span class="id">pih2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span> =&gt; <span class="id">hpi2</span>; <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#cos2_lt0">cos2_lt0</a></span>; <span class="id">rewrite</span> -<span class="id">hpi2</span> <span class="id">cpih</span> <span class="id">ltxx</span>.<br/>
<span class="id">rewrite</span> <span class="id">leNgt</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negP">negP</a></span> =&gt; <span class="id">hpi1</span>; <span class="id">have</span> [<span class="id">x</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x1</span> <span class="id">x2</span>] <span class="id">cs0</span>] := <span class="id"><a href="mathcomp.analysis.trigo.html#cos_exists">cos_exists</a></span>.<br/>
<span class="id">have</span> := @<span class="id"><a href="mathcomp.analysis.trigo.html#cos_02_uniq">cos_02_uniq</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id">pih0</span> <span class="id">pih2</span> <span class="id">cpih</span> (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">x1</span>)// <span class="id">x2</span> <span class="id">cs0</span> =&gt; /(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>).<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">pih</span>; <span class="id">move</span>: <span class="id">hpi1</span>; <span class="id">rewrite</span> <span class="id">pih</span> =&gt; /<span class="id">lt_le_trans</span>/(<span class="id">_</span> <span class="id">x1</span>); <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pihalf_ge1">pihalf_ge1</a></span> : 1 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
 <span class="kwd">by</span> <span class="id">have</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.pihalf_12">pihalf_12</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pihalf_lt2">pihalf_lt2</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 &lt; 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
 <span class="kwd">by</span> <span class="id">have</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[] := <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.pihalf_12">pihalf_12</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi_ge2">pi_ge2</a></span> : 2 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
 <span class="kwd">by</span>  <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_ge1">pihalf_ge1</a></span>; <span class="id">rewrite</span> <span class="id">ler_pdivl_mulr</span>// <span class="id">mul1r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi_gt0">pi_gt0</a></span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
 <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge2">pi_ge2</a></span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pi_ge0">pi_ge0</a></span> : 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
 <span class="id">exact</span>: (<span class="id">ltW</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_gt0_pihalf">sin_gt0_pihalf</a></span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 -&gt; 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gt0</span> <span class="id">xLpi</span>]; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sin2_gt0">sin2_gt0</a></span>; <span class="id">rewrite</span> <span class="id">x_gt0</span> /=.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">lt_trans</span> <span class="id">xLpi</span> <span class="id">_</span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_lt2">pihalf_lt2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_gt0_pihalf">cos_gt0_pihalf</a></span> <span class="id">x</span> : -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 -&gt; 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
<span class="id">wlog</span> : <span class="id">x</span> / 0 &lt;= <span class="id">x</span> =&gt; [<span class="id">Hw</span>|<span class="id">x_ge0</span>].<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id">leP</span> 0 <span class="id">x</span>) =&gt; [/<span class="id">Hw</span>//| <span class="id">x_lt_0</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -{-1}[<span class="id">x</span>]<span class="id">opprK</span> <span class="id">ltr_oppl</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> [-- <span class="id">_</span> &lt; <span class="id">_</span>]<span class="id">ltr_oppl</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">Hw</span> =&gt; //; <span class="id">rewrite</span> <span class="id">oppr_cp0</span> <span class="id">ltW</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gt0</span> <span class="id">xLpi2</span>]; <span class="id">case</span>: (<span class="id">ler0P</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>)) =&gt; // <span class="id">cx_le0</span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#IVT">IVT</a></span>[]// : <span class="id">minr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 0) (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>) &lt;= 0 &lt;= <span class="id">maxr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> 0) (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> /<span class="id">minr</span> /<span class="id">maxr</span> !<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifN">ifN</a></span> ?<span class="id">cx_le0</span> //= -<span class="id">leNgt</span> (<span class="id">le_trans</span> <span class="id">cx_le0</span>).<br/>
- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
<span class="id">move</span>=&gt; <span class="id">x1</span> /<span class="id">itvP</span> <span class="id">xx1</span> <span class="id">cx1_eq0</span>.<br/>
<span class="id">suff</span> <span class="id">x1E</span> : <span class="id">x1</span> = <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2.<br/>
&nbsp;&nbsp;<span class="id">have</span> : <span class="id">x1</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_lt_trans</span> <span class="id">xLpi2</span>; <span class="id">rewrite</span> <span class="id">xx1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">x1E</span> <span class="id">ltxx</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_02_uniq">cos_02_uniq</a></span>=&gt; //; <span class="id">last</span> <span class="kwd">by</span> <span class="id">case</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_02_cos_pihalf">pihalf_02_cos_pihalf</a></span> =&gt; <span class="id">_</span> -&gt;.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">xx1</span> <span class="id">ltW</span> // (<span class="id">lt_trans</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_lt2">pihalf_lt2</a></span>) // (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">xLpi2</span>) // <span class="id">xx1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_ge0</span> ?(<span class="id">ltW</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_lt2">pihalf_lt2</a></span>)// <span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_pihalf">cos_pihalf</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = 0<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
 <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_02_cos_pihalf">pihalf_02_cos_pihalf</a></span>.2. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_pihalf">sin_pihalf</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
<span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#cos2Dsin2">cos2Dsin2</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2); <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">expr0n</span> <span class="id">add0r</span>.<br/>
<span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = <span class="id">X</span> -&gt; <span class="id">_</span>](<span class="id">expr1n</span> <span class="id">_</span> 2%<span class="id">N</span>) =&gt; /<span class="id">eqP</span>; <span class="id">rewrite</span> -<span class="id">subr_eq0</span> <span class="id">subr_sqr</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulf_eq0</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orP">orP</a></span>[|]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_eq0</span>=&gt; /<span class="id">eqP</span>.<br/>
<span class="id">rewrite</span> <span class="id">addr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">spi21</span>; <span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#sin2_gt0">sin2_gt0</a></span>: 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 &lt; 2.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_lt2">pihalf_lt2</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pihalf_ge1">pihalf_ge1</a></span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">spi21</span> <span class="id">ltr0N1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_ge0_pihalf">cos_ge0_pihalf</a></span> <span class="id">x</span> : -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 -&gt; 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: (<span class="id">_</span> =<span class="id">P</span> <span class="id">x</span>) =&gt; /= [&lt;-|<span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> <span class="id">_</span>) =&gt; /= [-&gt;|<span class="id">_</span> <span class="id">H</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> //; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cospi">cospi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> = - 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="id">mulr2n</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> -<span class="id"><a href="mathcomp.analysis.trigo.html#pihalfE">pihalfE</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> <span class="id">mulr1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">add0r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinpi">sinpi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
<span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2); <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">mul0r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrDl</span> -<span class="id">mulr2n</span> -<span class="id">mulr_natr</span> -<span class="id">mulrA</span> <span class="id">divff</span>// <span class="id">mulr1</span> <span class="id">addr0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos2pi">cos2pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> *+ 2) = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr2n</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinpi">sinpi</a></span> !<span class="id">mulrN1</span> <span class="id">mulr0</span> <span class="id">subr0</span> <span class="id">opprK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin2pi">sin2pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> *+ 2) = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr2n</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinpi">sinpi</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> !<span class="id">mulrN1</span> <span class="id">mulr0</span> <span class="id">oppr0</span> <span class="id">addr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinDpi">sinDpi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating">alternating</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id">mulrN1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinpi">sinpi</a></span> <span class="id">mulr0</span> <span class="id">addr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosDpi">cosDpi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#alternating">alternating</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id">mulrN1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinpi">sinpi</a></span> <span class="id">mulr0</span> <span class="id">subr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinD2pi">sinD2pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic">periodic</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> *+ 2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos2pi">cos2pi</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin2pi">sin2pi</a></span> <span class="id">mulr0</span> <span class="id">mulr1</span> <span class="id">addr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosD2pi">cosD2pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#periodic">periodic</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> *+ 2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos2pi">cos2pi</a></span> <span class="id">mulr1</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin2pi">sin2pi</a></span> <span class="id">mulr0</span> <span class="id">subr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosDpihalf">cosDpihalf</a></span> <span class="id">a</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">a</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">add0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> <span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosBpihalf">cosBpihalf</a></span> <span class="id">a</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id">a</span> - <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosB">cosB</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">add0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> <span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinDpihalf">sinDpihalf</a></span> <span class="id">a</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">a</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">add0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> <span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinBpihalf">sinBpihalf</a></span> <span class="id">a</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id">a</span> - <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = - <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinB">sinB</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">mulr0</span> <span class="id">add0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> <span class="id">mulr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_ge0_pi">sin_ge0_pi</a></span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> -&gt; 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">move</span>=&gt; <span class="id">xI</span>; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cosBpihalf">cosBpihalf</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_ge0_pihalf">cos_ge0_pihalf</a></span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_subr_addl</span> <span class="id">subrr</span> <span class="id">ler_sub_addr</span> -<span class="id">mulr2n</span> -[<span class="id">_</span> *+ 2]<span class="id">mulr_natr</span> <span class="id">divfK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_gt0_pi">sin_gt0_pi</a></span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> -&gt; 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
<span class="id">move</span>=&gt; <span class="id">xI</span>; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cosBpihalf">cosBpihalf</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_subr_addl</span> <span class="id">subrr</span> <span class="id">ltr_sub_addr</span> -<span class="id">mulr2n</span> -[<span class="id">_</span> *+ 2]<span class="id">mulr_natr</span> <span class="id">divfK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltr_cos">ltr_cos</a></span> : {<span class="kwd">in</span> `[0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>] &amp;, {<span class="id">mono</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> : <span class="id">x</span> <span class="id">y</span> /~ <span class="id">y</span> &lt; <span class="id">x</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> !<span class="id">in_itv</span>/= <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; [&lt;- <span class="id">_</span>|<span class="id">_</span>] /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; /= [&lt;- <span class="id">_</span>|<span class="id">_</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">y_gt0</span> <span class="id">gLpi</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> !<span class="id">ltxx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">y_gt0</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> != 1 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgtP</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos_le1">cos_le1</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id">eq_sym</span>; <span class="id">apply</span>/<span class="id">eqP</span> =&gt; /<span class="id"><a href="mathcomp.analysis.derive.html#Rolle">Rolle</a></span> [||<span class="id">x1</span>|<span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span> [<span class="id">_</span> <span class="id">x1D</span>]] //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_cos">is_derive_cos</a></span> <span class="id">x1</span>) =&gt; <span class="id">_</span> /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">x1D</span> <span class="id">eq_sym</span> <span class="id">oppr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">s_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x1</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">s_eq0</span> <span class="id">ltxx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sin_gt0_pi">sin_gt0_pi</a></span>; <span class="id">rewrite</span> <span class="id">x1I</span> /= (<span class="id">lt_le_trans</span> (<span class="id">_</span> : <span class="id">_</span> &lt; <span class="id">y</span>)) ?<span class="id">x1I</span> // <span class="id">yI</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; [-&gt; <span class="id">_</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">y_ge0</span>]|/= <span class="id">_</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gt0</span> <span class="id">x_ltpi</span>]] /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; /= [-&gt; <span class="id">_</span>|/<span class="id">eqP</span> <span class="id">yDpi</span> <span class="id">y_ltpi</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id">ltxx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltNge</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_geN1">cos_geN1</a></span> <span class="id">ltNge</span> <span class="id">ltW</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; [&lt;- <span class="id">_</span>|<span class="id">_</span>] /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> [<span class="id">_</span> &lt; 0]<span class="id">ltNge</span> <span class="id">ltW</span> //=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negP">negP</a></span>; <span class="id">rewrite</span> -<span class="id">leNgt</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_le1">cos_le1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span>; <span class="id">case</span>: <span class="id">eqP</span> =&gt; /= [-&gt; <span class="id">_</span> | <span class="id">_</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">y_gt0</span> <span class="id">y_ltpi</span>]].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> <span class="id">x_ltpi</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != -1 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgtP</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos_geN1">cos_geN1</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span>; <span class="id">apply</span>/<span class="id">eqP</span> =&gt; /<span class="id"><a href="mathcomp.analysis.derive.html#Rolle">Rolle</a></span> [||<span class="id">x1</span>|<span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span> [<span class="id">_</span> <span class="id">x1D</span>]] //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_cos">is_derive_cos</a></span> <span class="id">x1</span>) =&gt; <span class="id">_</span> /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">x1D</span> <span class="id">eq_sym</span> <span class="id">oppr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">s_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x1</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">s_eq0</span> <span class="id">ltxx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sin_gt0_pi">sin_gt0_pi</a></span>; <span class="id">rewrite</span> <span class="id">x1I</span> /= (<span class="id">lt_le_trans</span> (<span class="id">_</span> : <span class="id">_</span> &lt; <span class="id">x</span>)) ?<span class="id">x1I</span>.<br/>
<span class="id">wlog</span> <span class="id">xLy</span> : <span class="id">x</span> <span class="id">y</span> <span class="id">x_gt0</span> <span class="id">x_ltpi</span> <span class="id">y_gt0</span> <span class="id">y_ltpi</span> / <span class="id">x</span> &lt;= <span class="id">y</span> =&gt; [<span class="id">H</span> | ].<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id">lerP</span> <span class="id">x</span> <span class="id">y</span>) =&gt; [/<span class="id">H</span> //-&gt;//|<span class="id">yLx</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ltNge</span> <span class="id">ltW</span> ?(<span class="id">ltW</span> <span class="id">yLx</span>) // <span class="id">H</span> // <span class="id">ltW</span>.<br/>
<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> <span class="id">y</span>) =&gt; [-&gt;| /<span class="id">eqP</span> <span class="id">xDy</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
<span class="id">have</span> <span class="id">xLLs</span> : <span class="id">x</span> &lt; <span class="id">y</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_eqVlt</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negPf">negPf</a></span> <span class="id">xDy</span>) <span class="kwd">in</span> <span class="id">xLy</span>.<br/>
<span class="id">rewrite</span> <span class="id">xLLs</span> -<span class="id">subr_gt0</span> -<span class="id">opprB</span>; <span class="id">rewrite</span> -<span class="id">subr_gt0</span> <span class="kwd">in</span> <span class="id">xLLs</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>.<br/>
<span class="id">have</span> [<span class="id">x1</span>|<span class="id">z</span> /<span class="id">itvP</span> <span class="id">zI</span> -&gt;] := @<span class="id"><a href="mathcomp.analysis.derive.html#MVT_segment">MVT_segment</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (- <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span>) <span class="id">_</span> <span class="id">_</span> <span class="id">xLy</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_subspaceT">continuous_subspaceT</a></span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
<span class="id">rewrite</span> -<span class="id">mulNr</span> <span class="id">opprK</span> <span class="id">mulr_gt0</span> //; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sin_gt0_pi">sin_gt0_pi</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">x_gt0</span>) ?<span class="id">zI</span> //= (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">y_ltpi</span>) ?<span class="id">zI</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltr_sin">ltr_sin</a></span> : {<span class="kwd">in</span> `[ (- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2] &amp;, {<span class="id">mono</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> /<span class="id">itvP</span> <span class="id">xpi</span> /<span class="id">itvP</span> <span class="id">ypi</span>; <span class="id">rewrite</span> -[<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>]<span class="id">opprK</span> <span class="id">ltr_oppl</span>.<br/>
<span class="id">rewrite</span> -!<span class="id"><a href="mathcomp.analysis.trigo.html#cosDpihalf">cosDpihalf</a></span> -[<span class="id">x</span> &lt; <span class="id">y</span>](<span class="id">ltr_add2r</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> /2)) <span class="id"><a href="mathcomp.analysis.trigo.html#ltr_cos">ltr_cos</a></span>// !<span class="id">in_itv</span>/=.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">sub0r</span> <span class="id">xpi</span>/= [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]<span class="id">splitr</span> <span class="id">ler_add2r</span> <span class="id">xpi</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">sub0r</span> <span class="id">ypi</span>/= [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]<span class="id">splitr</span> <span class="id">ler_add2r</span> <span class="id">ypi</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_inj">cos_inj</a></span> : {<span class="kwd">in</span> `[0,<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>] &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> (@<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi.R">R</a></span>)}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">x0pi</span> <span class="id">y0pi</span> <span class="id">xy</span>; <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_le</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>; <span class="id">split</span>.<br/>
- <span class="kwd">by</span> <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#ltr_cos">ltr_cos</a></span> <span class="id">y0pi</span> <span class="id">x0pi</span>; <span class="id">rewrite</span> <span class="id">xy</span> <span class="id">ltxx</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#esym">esym</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbT">negbT</a></span>; <span class="id">rewrite</span> -<span class="id">leNgt</span>.<br/>
- <span class="kwd">by</span> <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#ltr_cos">ltr_cos</a></span> <span class="id">x0pi</span> <span class="id">y0pi</span>; <span class="id">rewrite</span> <span class="id">xy</span> <span class="id">ltxx</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#esym">esym</a></span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbT">negbT</a></span>; <span class="id">rewrite</span> -<span class="id">leNgt</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_inj">sin_inj</a></span> : {<span class="kwd">in</span> `[(- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)] &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> /<span class="id">itvP</span> <span class="id">xpi</span> /<span class="id">itvP</span> <span class="id">ypi</span> <span class="id">sinE</span>; <span class="id">have</span> : - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> = - <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinE">sinE</a></span>.<br/>
<span class="id">rewrite</span> -!<span class="id"><a href="mathcomp.analysis.trigo.html#cosDpihalf">cosDpihalf</a></span> =&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#cos_inj">cos_inj</a></span> <span class="id">h</span>; <span class="id">apply</span>/(<span class="id">addIr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2))/<span class="id">h</span>; <span class="id">rewrite</span> !<span class="id">in_itv</span>/=.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">sub0r</span> <span class="id">xpi</span>/= [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]<span class="id">splitr</span> <span class="id">ler_add2r</span> <span class="id">xpi</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_subl_addr</span> <span class="id">sub0r</span> <span class="id">ypi</span>/= [<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]<span class="id">splitr</span> <span class="id">ler_add2r</span> <span class="id">ypi</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#Pi">Pi</a></span>.<br/>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> {<span class="id">R</span>}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Tan">Tan</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Tan.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tan">tan</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Tan.R">R</a></span>) := <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span> / <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tan0">tan0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> 0 = 0 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Tan.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id">mul0r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tanpi">tanpi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinpi">sinpi</a></span> <span class="id">mul0r</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tanN">tanN</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (- <span class="id">x</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id">mulNr</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tanD">tanD</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> != 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id">x</span> + <span class="id">y</span>) = (<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">y</span>) / (1 - <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
<span class="id">move</span>=&gt; <span class="id">cxNZ</span> <span class="id">cyNZ</span>.<br/>
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinD">sinD</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosD">cosD</a></span> !<span class="id">addf_div</span> // [<span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>]<span class="id">mulrC</span> -!<span class="id">mulrA</span> -<span class="id">invfM</span>.<br/>
<span class="id">congr</span> (<span class="id">_</span> / <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">mulrBr</span> <span class="id">mulr1</span> !<span class="id">mulrA</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">_</span> * <span class="id">_</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">x</span>]<span class="id">mulrA</span> [<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * (<span class="id">_</span> * <span class="id">_</span>)]<span class="id">mulrC</span> <span class="id">mulfK</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">_</span> * <span class="id">_</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span>]<span class="id">mulrA</span> [<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> * (<span class="id">_</span> * <span class="id">_</span>)]<span class="id">mulrC</span> <span class="id">mulfK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tan_mulr2n">tan_mulr2n</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id">x</span> *+ 2) = <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span> *+ 2 / (1 -  <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span> ^+ 2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
<span class="id">move</span>=&gt; <span class="id">cxNZ</span>.<br/>
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_mulr2n">cos_mulr2n</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_mulr2n">sin_mulr2n</a></span>.<br/>
<span class="id">rewrite</span> !<span class="id">mulr2n</span> <span class="id">exprMn</span> <span class="id">exprVn</span> -[<span class="kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS</a></span>](<span class="id">divff</span> (<span class="id">_</span> : 1 != 0)) //.<br/>
<span class="id">rewrite</span> -<span class="id">mulNr</span> !<span class="id">addf_div</span> ?<span class="id">sqrf_eq0</span> //.<br/>
<span class="id">rewrite</span> <span class="id">mul1r</span> <span class="id">mulr1</span> -!<span class="id">mulrA</span> -<span class="id">invfM</span> -<span class="id">expr2</span>; <span class="id">congr</span> (<span class="id">_</span> / <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> * <span class="id">_</span>]<span class="id">mulrC</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrCA</span> <span class="id">mulrA</span> <span class="id">mulfK</span>  ?<span class="id">sqrf_eq0</span> // [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = <span class="id">_</span> - <span class="id">X</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">opprB</span> <span class="id">addrA</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos2_tan2">cos2_tan2</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>) ^- 2 = 1 + (<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span>) ^+ 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
<span class="id">move</span>=&gt; <span class="id">cosx</span>.<br/>
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">exprMn</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> = 1 + <span class="id">X</span> * <span class="id">_</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span> <span class="id">mulrBl</span> -<span class="id">exprMn</span> <span class="id">divff</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expr1n</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span> <span class="id">mul1r</span> <span class="id">exprVn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tan_pihalf">tan_pihalf</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id">invr0</span> <span class="id">mulr0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tan_piquarter">tan_piquarter</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 4%:<span class="id">R</span>) = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cosBpihalf">cosBpihalf</a></span> (<span class="id">splitr</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)) <span class="id">opprD</span> <span class="id">addrA</span> -<span class="id">mulrA</span> -<span class="id">invfM</span> -<span class="id">natrM</span>.<br/>
<span class="id">rewrite</span> <span class="id">subrr</span> <span class="id">sub0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id">divff</span>// <span class="id">gt_eqF</span>// <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>//.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pmul2l</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>// <span class="id">ltf_pinv</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">qualifE</a></span>// <span class="id">ltr_nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (@<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">_</span> 0)// ?<span class="id">oppr_lt0</span> ?<span class="id">divr_gt0</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tanDpi">tanDpi</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id">x</span> + <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosDpi">cosDpi</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinDpi">sinDpi</a></span> <span class="id">mulNr</span> <span class="id">invrN</span> <span class="id">mulrN</span> <span class="id">opprK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_tan">continuous_tan</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; {<span class="kwd">for</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
<span class="id">move</span>=&gt; <span class="id">cxNZ</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.normedtype.html#continuousM">continuousM</a></span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_sin">continuous_sin</a></span>.<br/>
<span class="id">exact</span>/(<span class="id"><a href="mathcomp.analysis.normedtype.html#continuousV">continuousV</a></span> <span class="id">cxNZ</span>)/<span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_derive_tan">is_derive_tan</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> ((<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>)^-2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
<span class="id">move</span>=&gt; <span class="id">cxNZ</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#trigger_derive">trigger_derive</a></span>.<br/>
<span class="id">rewrite</span> /= ![<span class="id">_</span> *: - <span class="id">_</span>]<span class="id">mulrN</span> <span class="id">mulNr</span> <span class="id">mulrN</span> <span class="id">opprK</span> [<span class="id">_</span>^-1 *: <span class="id">_</span>]<span class="id">mulVf</span> //.<br/>
<span class="id">rewrite</span> <span class="id">mulrCA</span> -<span class="id">expr2</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span> + <span class="id">_</span> = <span class="id">_</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrBr</span> <span class="id">mulr1</span> <span class="id">mulVf</span> ?<span class="id">sqrf_eq0</span> // <span class="id">subrK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="derivable_tan">derivable_tan</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span> != 0 -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#derivable">derivable</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">x</span> 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_tan">is_derive_tan</a></span>[]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltr_tan">ltr_tan</a></span> : {<span class="kwd">in</span> `](- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[ &amp;, {<span class="id">mono</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>; <span class="id">wlog</span> <span class="id">xLy</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> =&gt; [<span class="id">H</span> <span class="id">xB</span> <span class="id">yB</span>|/<span class="id">itvP</span> <span class="id">xB</span> /<span class="id">itvP</span> <span class="id">yB</span>].<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id">lerP</span> <span class="id">x</span> <span class="id">y</span>) =&gt; [/<span class="id">H</span> //-&gt;//|<span class="id">yLx</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ltNge</span> <span class="id">ltW</span> ?(<span class="id">ltW</span> <span class="id">yLx</span>) // <span class="id">H</span> // <span class="id">ltW</span>.<br/>
<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> <span class="id">y</span>) =&gt; [-&gt;| /<span class="id">eqP</span> <span class="id">xDy</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
<span class="id">have</span> <span class="id">xLLs</span> : <span class="id">x</span> &lt; <span class="id">y</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">le_eqVlt</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negPf">negPf</a></span> <span class="id">xDy</span>) <span class="kwd">in</span> <span class="id">xLy</span>.<br/>
<span class="id">rewrite</span> -<span class="id">subr_gt0</span> <span class="id">xLLs</span>; <span class="id">rewrite</span> -<span class="id">subr_gt0</span> <span class="kwd">in</span> <span class="id">xLLs</span>; <span class="id">apply</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>.<br/>
<span class="id">have</span> [<span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span>|<span class="id">z</span> |] := @<span class="id"><a href="mathcomp.analysis.derive.html#MVT_segment">MVT_segment</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">x</span>) ^-2) <span class="id">_</span> <span class="id">_</span> <span class="id">xLy</span>.<br/>
- <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_tan">is_derive_tan</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">gt_eqF</span> // <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span> // (@<span class="id">lt_le_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">x</span>) ?<span class="id">x1I</span> ?<span class="id">xB</span>//=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (@<span class="id">le_lt_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">y</span>) ?<span class="id">x1I</span> ?<span class="id">yB</span>.<br/>
- <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_in_subspaceT">continuous_in_subspaceT</a></span> =&gt; ? -/[!(@<span class="id"><a href="mathcomp.classical.classical_sets.html#mem_setE">mem_setE</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Tan.R">R</a></span>)] /<span class="id">itvP</span> <span class="id">inI</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_tan">continuous_tan</a></span>; <span class="id">rewrite</span> <span class="id">gt_eqF</span>// <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (@<span class="id">lt_le_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">x</span>) ?<span class="id">xB</span> ?<span class="id">inI</span>// (@<span class="id">le_lt_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">y</span>) ?<span class="id">yB</span> ?<span class="id">inI</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span> -&gt;.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulr_gt0</span> // <span class="id">invr_gt0</span> // <span class="id">exprn_gte0</span> // <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span> //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (@<span class="id">lt_le_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">x</span>) ?<span class="id">x1I</span> ?<span class="id">xB</span>//= (@<span class="id">le_lt_trans</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">y</span>) ?<span class="id">x1I</span> ?<span class="id">yB</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tan_inj">tan_inj</a></span> : {<span class="kwd">in</span> `](- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[ &amp;, <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">injective</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">xB</span> <span class="id">yB</span> <span class="id">tanE</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">ltrgtP</span> <span class="id">x</span> <span class="id">y</span>); <span class="id">rewrite</span> // -<span class="id"><a href="mathcomp.analysis.trigo.html#ltr_tan">ltr_tan</a></span> ?<span class="id">tanE</span> ?<span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#Tan">Tan</a></span>.<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> {<span class="id">R</span>}.<br/>
<br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;(<span class="id">eapply</span> <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_tan">is_derive_tan</a></span>; <span class="id">first</span> <span class="kwd">by</span> []) : <span class="id">typeclass_instances</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Acos">Acos</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Acos.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="acos">acos</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span>) : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span> := <span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> [<span class="id">set</span> <span class="id">y</span> | 0 &lt;= <span class="id">y</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> /\ <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> = <span class="id">x</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos_def">acos_def</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;-1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> /\ <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>) = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
<span class="id">move</span>=&gt; <span class="id">xB</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span>; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.classical_sets.html#xgetP">xgetP</a></span> =&gt; //= <span class="id">He</span>.<br/>
<span class="id">pose</span> <span class="id">f</span> <span class="id">y</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">y</span> - <span class="id">x</span>.<br/>
<span class="id">have</span> /(<span class="id"><a href="mathcomp.analysis.normedtype.html#IVT">IVT</a></span> (@<span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span> <span class="id">_</span>))[] // : <span class="id">minr</span> (<span class="id">f</span> 0) (<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>) &lt;= 0 &lt;= <span class="id">maxr</span> (<span class="id">f</span> 0) (<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> /<span class="id">minr</span> /<span class="id">maxr</span> <span class="id">ltr_add2r</span> -<span class="id">subr_lt0</span> <span class="id">opprK</span> (<span class="id">_</span> : 1 + 1 = 2)//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltrn0</span> <span class="id">subr_le0</span> <span class="id">subr_ge0</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">y0pi</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.normedtype.html#continuousB">continuousB</a></span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_in_subspaceT">continuous_in_subspaceT</a></span> =&gt; ? ?;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>|<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.topology.html#cst_continuous">cst_continuous</a></span>].<br/>
- <span class="id">rewrite</span> /<span class="id">f</span> =&gt; <span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span> /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">cosx1E</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">He</span> <span class="id">x1</span>); <span class="id">rewrite</span> !<span class="id">x1I</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos_ge0">acos_ge0</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#acos_def">acos_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos_lepi">acos_lepi</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#acos_def">acos_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acosK">acosK</a></span> : {<span class="kwd">in</span> `[(-1),1], <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">in_itv</span>/==&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#acos_def">acos_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos_gt0">acos_gt0</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt; 1 -&gt; 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_geN1</span> <span class="id">x_lt1</span>]; <span class="id">move</span>: (<span class="id">x_lt1</span>).<br/>
<span class="id">have</span> : 0 &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span> // <span class="id">x_geN1</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>) = <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>// <span class="id">in_itv</span>/= <span class="id">x_geN1</span>/= <span class="id">ltW</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span> =&gt; // -&gt;; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> =&gt; -&gt;; <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos_ltpi">acos_ltpi</a></span> <span class="id">x</span> : -1 &lt; <span class="id">x</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_le1</span>]; <span class="id">move</span>: (<span class="id">x_gtN1</span>).<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span> // <span class="id">x_le1</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>) = <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>// <span class="id">in_itv</span>/= <span class="id">x_le1</span> <span class="id">ltW</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">ltrgtP</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>) <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>) =&gt; // -&gt;; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cospi">cospi</a></span> =&gt; -&gt;; <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosK">cosK</a></span> : {<span class="kwd">in</span> `[0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>], <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">xB</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_inj">cos_inj</a></span> =&gt; //; <span class="id">rewrite</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>: <span class="id">xB</span>; <span class="id">rewrite</span> !<span class="id">in_itv</span>/= =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[? ?];<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_geN1">cos_geN1</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_le1">cos_le1</a></span>.<br/>
<span class="id">move</span>: <span class="id">xB</span>; <span class="id">rewrite</span> !<span class="id">in_itv</span>/= =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[? ?].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#cos_geN1">cos_geN1</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#cos_le1">cos_le1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos1">acos1</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (1 : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span>) = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
<span class="kwd">by</span> <span class="id">have</span> := @<span class="id"><a href="mathcomp.analysis.trigo.html#cosK">cosK</a></span> 0; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos0">cos0</a></span> =&gt; -&gt; //; <span class="id">rewrite</span> <span class="id">in_itv</span> //= <span class="id">lexx</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acos0">acos0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (0 : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2%:<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
<span class="id">have</span> := @<span class="id"><a href="mathcomp.analysis.trigo.html#cosK">cosK</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2%:<span class="id">R</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> =&gt; -&gt; //; <span class="id">rewrite</span> <span class="id">in_itv</span>//= <span class="id">divr_ge0</span> ?<span class="id">ler0n</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>//=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_pdivr_mulr</span> ?<span class="id">ltr0n</span>// <span class="id">ler_pemulr</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>// <span class="id">ler1n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acosN">acosN</a></span> <span class="id">a</span> : -1 &lt;= <span class="id">a</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (- <span class="id">a</span>) = <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> - <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
<span class="id">move</span>=&gt; <span class="id">a1</span>; <span class="id">have</span> ? : -1 &lt;= - <span class="id">a</span> &lt;= 1 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_oppl</span> <span class="id">opprK</span> <span class="id">ler_oppl</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_inj">cos_inj</a></span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span>//= <span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id">subr_ge0</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span>//= <span class="id">ler_subl_addl</span> <span class="id">ler_addr</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addrC</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosDpi">cosDpi</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> !<span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="acosN1">acosN1</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (- 1) = (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acosN">acosN</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos1">acos1</a></span> ?<span class="id">subr0</span> ?<span class="id">lexx</span>// -<span class="id">subr_ge0</span> <span class="id">opprK</span> <span class="id">addr_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cosKN">cosKN</a></span> <span class="id">a</span> : - <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> &lt;= <span class="id">a</span> &lt;= 0 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> <span class="id">a</span>) = - <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">pia0</span>; <span class="id">rewrite</span> -(<span class="id"><a href="mathcomp.analysis.trigo.html#cosN">cosN</a></span> <span class="id">a</span>) <span class="id"><a href="mathcomp.analysis.trigo.html#cosK">cosK</a></span>// <span class="id">in_itv</span>/= <span class="id">ler_oppr</span> <span class="id">oppr0</span> <span class="id">ler_oppl</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sin_acos">sin_acos</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span>) = <span class="id">Num.sqrt</span> (1 - <span class="id">x</span>^+2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
<span class="id">move</span>=&gt; <span class="id">xB</span>.<br/>
<span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id">ger0_norm</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_ge0_pi">sin_ge0_pi</a></span> // <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">sqrtr_sqr</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin2cos2">sin2cos2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_acos">continuous_acos</a></span> <span class="id">x</span> : -1 &lt; <span class="id">x</span> &lt; 1 -&gt; {<span class="kwd">for</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_lt1</span>]; <span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>; <span class="id">first</span> <span class="id">last</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ltW</span> //; <span class="id">case</span>/<span class="id">andP</span>: <span class="id">xB</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_singleton">nbhs_singleton</a></span> (<span class="id"><a href="mathcomp.analysis.realfun.html#near_can_continuous">near_can_continuous</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> \<span class="kwd">in</span> `]0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_gt0">acos_gt0</a></span> ?<span class="id">ltW</span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ltpi">acos_ltpi</a></span> // <span class="id">ltW</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>.<br/>
<span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cosK">cosK</a></span>.<br/>
<span class="id">suff</span> /<span class="id">itvP</span> <span class="id">zI</span> : <span class="id">z</span> \<span class="kwd">in</span> `]0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>[ <span class="kwd">by</span> <span class="id">have</span> : 0 &lt;= <span class="id">z</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> ?<span class="id">zI</span>.<br/>
<span class="kwd">by</span> <span class="id">near</span>: <span class="id">z</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_derive1_acos">is_derive1_acos</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span>) :<br/>
&nbsp;&nbsp;-1 &lt; <span class="id">x</span> &lt; 1 -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> (- (<span class="id">Num.sqrt</span> (1 - <span class="id">x</span> ^+ 2))^-1).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_lt1</span>]; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#sin_acos">sin_acos</a></span> ?<span class="id">ltW</span> // -<span class="id">invrN</span>.<br/>
<span class="id">rewrite</span> -{1}[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">have</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> // <span class="id">ltW</span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> \<span class="kwd">in</span> `]0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#acos_gt0">acos_gt0</a></span> ?<span class="id">ltW</span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#acos_ltpi">acos_ltpi</a></span> // <span class="id">ltW</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span>.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_inverse">is_derive_inverse</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Acos.R">R</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span>).<br/>
- <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cosK">cosK</a></span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> /<span class="id">itvP</span> <span class="id">zI</span> : <span class="id">z</span> \<span class="kwd">in</span> `]0, <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>[ <span class="kwd">by</span> <span class="id">have</span> : 0 &lt;= <span class="id">z</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> ?<span class="id">zI</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>: <span class="id">z</span>.<br/>
- <span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_cos">continuous_cos</a></span>.<br/>
- <span class="id">rewrite</span> <span class="id">oppr_eq0</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_acos">sin_acos</a></span> ?<span class="id">ltW</span> // <span class="id">sqrtr_eq0</span> // -<span class="id">ltNge</span> <span class="id">subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">real_normK</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">qualifE</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">exprn_cp1</span> // <span class="id">ltr_norml</span> <span class="id">x_gtN1</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#Acos">Acos</a></span>.<br/>
<br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">_</span> 1 (@<span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">_</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;(<span class="id">eapply</span> <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive1_acos">is_derive1_acos</a></span>; <span class="id">first</span> <span class="kwd">by</span> []) : <span class="id">typeclass_instances</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Asin">Asin</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Asin.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="asin">asin</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Asin.R">R</a></span>) : <span class="id"><a href="mathcomp.analysis.trigo.html#Asin.R">R</a></span> := <span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> [<span class="id">set</span> <span class="id">y</span> | -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id">y</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span> = <span class="id">x</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asin_def">asin_def</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;-1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>) = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
<span class="id">move</span>=&gt; <span class="id">xB</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span>; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.classical_sets.html#xgetP">xgetP</a></span> =&gt; //= <span class="id">He</span>.<br/>
<span class="id">pose</span> <span class="id">f</span> <span class="id">y</span> := <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id">y</span> - <span class="id">x</span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#IVT">IVT</a></span>[] // :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">minr</span> (<span class="id">f</span> (-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2))) (<span class="id">f</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)) &lt;= 0 &lt;= <span class="id">maxr</span> (<span class="id">f</span> (-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2))) (<span class="id">f</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> /<span class="id">minr</span> /<span class="id">maxr</span> <span class="id">ltr_add2r</span> -<span class="id">subr_gt0</span> <span class="id">opprK</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> : 1 + 1 = 2)// <span class="id">ltr0n</span>/= <span class="id">subr_le0</span> <span class="id">subr_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">subr_ge0</span> <span class="id">opprK</span> -<span class="id">splitr</span> <span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; *; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.normedtype.html#continuousB">continuousB</a></span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.topology.html#continuous_in_subspaceT">continuous_in_subspaceT</a></span> =&gt; ? ?;<br/>
&nbsp;&nbsp;&nbsp;[<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_sin">continuous_sin</a></span>| <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.topology.html#cst_continuous">cst_continuous</a></span>].<br/>
- <span class="id">rewrite</span> /<span class="id">f</span> =&gt; <span class="id">x1</span> /<span class="id">itvP</span> <span class="id">x1I</span> /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">sinx1E</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">He</span> <span class="id">x1</span>); <span class="id">rewrite</span> !<span class="id">x1I</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asin_geNpi2">asin_geNpi2</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#asin_def">asin_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asin_lepi2">asin_lepi2</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#asin_def">asin_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asinK">asinK</a></span> : {<span class="kwd">in</span> `[(-1),1], <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof131')">Proof.</span></div>
<div class="proofscript" id="proof131">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">in_itv</span>/= =&gt; /<span class="id"><a href="mathcomp.analysis.trigo.html#asin_def">asin_def</a></span>[/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asin_ltpi2">asin_ltpi2</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt; 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_geN1</span> <span class="id">x_lt1</span>]; <span class="id">move</span>: (<span class="id">x_lt1</span>).<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin_lepi2">asin_lepi2</a></span> // <span class="id">x_geN1</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>) = <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>// <span class="id">in_itv</span>/= <span class="id">x_geN1</span> <span class="id">ltW</span>.<br/>
<span class="id">case</span>: (<span class="id">ltrgtP</span> <span class="id">_</span> ((<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2))) =&gt; // -&gt;.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> =&gt; &lt;-; <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="asin_gtNpi2">asin_gtNpi2</a></span> <span class="id">x</span> : -1 &lt; <span class="id">x</span> &lt;= 1 -&gt; - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof133')">Proof.</span></div>
<div class="proofscript" id="proof133">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_le1</span>]; <span class="id">move</span>: (<span class="id">x_gtN1</span>).<br/>
<span class="id">have</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin_geNpi2">asin_geNpi2</a></span> // <span class="id">x_le1</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>) = <span class="id">x</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>// <span class="id">in_itv</span>/= <span class="id">x_le1</span> <span class="id">ltW</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">ltrgtP</span> (<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>)) =&gt; //-&gt;; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sinN">sinN</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_pihalf">sin_pihalf</a></span> =&gt; &lt;-; <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sinK">sinK</a></span> : {<span class="kwd">in</span> `[(- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)), <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2], <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof134')">Proof.</span></div>
<div class="proofscript" id="proof134">
<span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> !<span class="id">in_itv</span>/= =&gt; <span class="id">xB</span> ; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sin_inj">sin_inj</a></span> =&gt; //; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>// <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#sin_geN1">sin_geN1</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_le1">sin_le1</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#asin_geNpi2">asin_geNpi2</a></span>/= ?<span class="id"><a href="mathcomp.analysis.trigo.html#asin_lepi2">asin_lepi2</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#sin_geN1">sin_geN1</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#sin_le1">sin_le1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_asin">cos_asin</a></span> <span class="id">x</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 -&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span>) = <span class="id">Num.sqrt</span> (1 - <span class="id">x</span>^+2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
<span class="id">move</span>=&gt; <span class="id">xB</span>; <span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id">ger0_norm</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">sqrtr_sqr</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos2sin2">cos2sin2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_ge0_pihalf">cos_ge0_pihalf</a></span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin_lepi2">asin_lepi2</a></span> // <span class="id"><a href="mathcomp.analysis.trigo.html#asin_geNpi2">asin_geNpi2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_asin">continuous_asin</a></span> <span class="id">x</span> : -1 &lt; <span class="id">x</span> &lt; 1 -&gt; {<span class="kwd">for</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_lt1</span>]; <span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>; <span class="id">first</span> <span class="id">last</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ltW</span> //; <span class="id">case</span>/<span class="id">andP</span>: <span class="id">xB</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_singleton">nbhs_singleton</a></span> (<span class="id"><a href="mathcomp.analysis.realfun.html#near_can_continuous">near_can_continuous</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_sin">continuous_sin</a></span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin_gtNpi2">asin_gtNpi2</a></span> ?<span class="id">ltW</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#asin_ltpi2">asin_ltpi2</a></span> // <span class="id">ltW</span>.<br/>
<span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sinK">sinK</a></span>.<br/>
<span class="id">suff</span> /<span class="id">itvP</span> <span class="id">zI</span> : <span class="id">z</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id">z</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> ?<span class="id">zI</span>.<br/>
<span class="kwd">by</span> <span class="id">near</span>: <span class="id">z</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_derive1_asin">is_derive1_asin</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Asin.R">R</a></span>) :<br/>
&nbsp;&nbsp;-1 &lt; <span class="id">x</span> &lt; 1 -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> ((<span class="id">Num.sqrt</span> (1 - <span class="id">x</span> ^+ 2))^-1).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
<span class="id">move</span>=&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[<span class="id">x_gtN1</span> <span class="id">x_lt1</span>]; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cos_asin">cos_asin</a></span> ?<span class="id">ltW</span> //.<br/>
<span class="id">rewrite</span> -{1}[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#asinK">asinK</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">have</span> : -1 &lt;= <span class="id">x</span> &lt;= 1 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> // <span class="id">ltW</span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2 <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#asin_gtNpi2">asin_gtNpi2</a></span> ?<span class="id">ltW</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">andbT</a></span> //= <span class="id"><a href="mathcomp.analysis.trigo.html#asin_ltpi2">asin_ltpi2</a></span> // <span class="id">ltW</span>.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_inverse">is_derive_inverse</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Asin.R">R</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin">sin</a></span>).<br/>
- <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#sinK">sinK</a></span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> /<span class="id">itvP</span> <span class="id">zI</span> : <span class="id">z</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt;= <span class="id">z</span> &lt;= <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> ?<span class="id">zI</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>: <span class="id">z</span>.<br/>
- <span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#continuous_sin">continuous_sin</a></span>.<br/>
- <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_asin">cos_asin</a></span> ?<span class="id">ltW</span> // <span class="id">sqrtr_eq0</span> // -<span class="id">ltNge</span> <span class="id">subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">real_normK</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">qualifE</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">exprn_cp1</span> // <span class="id">ltr_norml</span> <span class="id">x_gtN1</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#Asin">Asin</a></span>.<br/>
<br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">_</span> 1 (@<span class="id"><a href="mathcomp.analysis.trigo.html#asin">asin</a></span> <span class="id">_</span>) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;(<span class="id">eapply</span> <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive1_asin">is_derive1_asin</a></span>; <span class="id">first</span> <span class="kwd">by</span> []) : <span class="id">typeclass_instances</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Atan">Atan</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Atan.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="atan">atan</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span>) : <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.classical_sets.html#get">get</a></span> [<span class="id">set</span> <span class="id">y</span> | -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id">y</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">y</span> = <span class="id">x</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atan_def">atan_def</a></span> <span class="id">x</span> : -(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 /\ <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>) = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span>; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.classical_sets.html#xgetP">xgetP</a></span> =&gt; //= <span class="id">He</span>.<br/>
<span class="id">pose</span> <span class="id">x1</span> := <span class="id">Num.sqrt</span> (1 + <span class="id">x</span>^+ 2) ^-1.<br/>
<span class="id">have</span> <span class="id">ox2_gt0</span> : 0 &lt; 1 + <span class="id">x</span>^2.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">lt_le_trans</span> (<span class="id">_</span> : 1 &lt;= <span class="id">_</span>); <span class="id">rewrite</span> ?<span class="id">ler_addl</span> ?<span class="id">sqr_ge0</span>.<br/>
<span class="id">have</span> <span class="id">ox2_ge0</span> : 0 &lt;= 1 + <span class="id">x</span>^2 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> <span class="id">x1B</span> : -1 &lt;= <span class="id">x1</span> &lt;= 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">ler_norml</span> /<span class="id">x1</span> <span class="id">ger0_norm</span> ?<span class="id">sqrtr_ge0</span> // -[<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS</a></span>]<span class="id">sqrtr1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_psqrt</span> ?<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">qualifE</a></span> ?<span class="id">invr_gte0</span> //= <span class="id">invf_cp1</span> // <span class="id">ler_addl</span> <span class="id">sqr_ge0</span>.<br/>
<span class="id">case</span>: (<span class="id">He</span> (<span class="id">Num.sg</span> <span class="id">x</span> * <span class="id"><a href="mathcomp.analysis.trigo.html#acos">acos</a></span> <span class="id">x1</span>)); <span class="id">split</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> 0) =&gt; [-&gt;|/<span class="id">eqP</span> <span class="id">xD0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id">sgr0</span> <span class="id">mul0r</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin0">sin0</a></span> <span class="id">mul0r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#sin_sg">sin_sg</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_sg">cos_sg</a></span> // <span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#sin_acos">sin_acos</a></span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">x1</span> <span class="id">sqr_sqrtr</span>// ?<span class="id">invr_ge0</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -{1}[<span class="id">_</span>^-1 <span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> / <span class="id">_</span> = <span class="id">_</span>]<span class="id">mul1r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -{1}[<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> - <span class="id">_</span>](<span class="id">divff</span> (<span class="id">_</span>: 1 != 0)) //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">mulNr</span> <span class="id">addf_div</span> ?<span class="id">lt0r_neq0</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mul1r</span> <span class="id">mulr1</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> - 1]<span class="id">addrC</span> <span class="id">addrK</span> // <span class="id">sqrtrM</span> ?<span class="id">sqr_ge0</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#sqrtrV">sqrtrV</a></span> // <span class="id">invrK</span> // <span class="id">mulrA</span> <span class="id">divfK</span> //; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrtr_eq0</span> -<span class="id">ltNge</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrtr_sqr</span> <span class="id">mulr_sg_norm</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ltr_norml</span> <span class="id">normrM</span>.<br/>
<span class="id">have</span> <span class="id">pi2</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span> // <span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>.<br/>
<span class="id">case</span>: (<span class="id">x</span> =<span class="id">P</span> 0) =&gt; [-&gt;|/<span class="id">eqP</span> <span class="id">xD0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sgr0</span> <span class="id">normr0</span> <span class="id">mul0r</span>.<br/>
<span class="id">rewrite</span> <span class="id">normr_sg</span> <span class="id">xD0</span> <span class="id">mul1r</span> <span class="id">ltr_norml</span>.<br/>
<span class="id">rewrite</span> (@<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">_</span> 0) ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span> ?<span class="id">oppr_cp0</span> //=.<br/>
<span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.trigo.html#ltr_cos">ltr_cos</a></span> ?<span class="id">in_itv</span>/= ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos_ge0">acos_ge0</a></span>/= ?<span class="id"><a href="mathcomp.analysis.trigo.html#acos_lepi">acos_lepi</a></span>//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_ge0</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_ge0">pi_ge0</a></span>//= <span class="id">ler_pdivr_mulr</span>// <span class="id">ler_pmulr</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>// <span class="id">ler1n</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos_pihalf">cos_pihalf</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#acosK">acosK</a></span> // ?<span class="id">sqrtr_gt0</span> ?<span class="id">invr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atan_gtNpi2">atan_gtNpi2</a></span> <span class="id">x</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
 <span class="kwd">by</span> <span class="id">case</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#atan_def">atan_def</a></span> <span class="id">x</span>) =&gt; [] /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atan_ltpi2">atan_ltpi2</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</span></div>
<div class="proofscript" id="proof140">
 <span class="kwd">by</span> <span class="id">case</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#atan_def">atan_def</a></span> <span class="id">x</span>) =&gt; [] /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">andP</a></span>[]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atanK">atanK</a></span> : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</span></div>
<div class="proofscript" id="proof141">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">case</span>: (<span class="id"><a href="mathcomp.analysis.trigo.html#atan_def">atan_def</a></span> <span class="id">x</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atan0">atan0</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> 0 = 0 :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</span></div>
<div class="proofscript" id="proof142">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#tan_inj">tan_inj</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan0">tan0</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id">oppr_cp0</span> <span class="id">divr_gt0</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atan1">atan1</a></span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> 1 = <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 4%:<span class="id">R</span> :&gt; <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</span></div>
<div class="proofscript" id="proof143">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#tan_inj">tan_inj</a></span>; <span class="id">first</span> 2 <span class="id">last</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan_piquarter">tan_piquarter</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">in_itv</span>/= -<span class="id">mulNr</span> (<span class="id">lt_trans</span> <span class="id">_</span> (<span class="id">_</span> : 0 &lt; <span class="id">_</span> )) /=; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulNr</span> <span class="id">oppr_cp0</span> <span class="id">divr_gt0</span> // <span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span> // <span class="id">ltr0n</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pdivr_mulr</span>// -<span class="id">mulrA</span> <span class="id">ltr_pmulr</span>// ?<span class="id"><a href="mathcomp.analysis.trigo.html#pi_gt0">pi_gt0</a></span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">natrM</span> <span class="id">_</span> 2 2) <span class="id">mulrA</span> <span class="id">mulVf</span>// <span class="id">mul1r</span> <span class="id">ltr1n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atanN">atanN</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> (- <span class="id">x</span>) = - <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</span></div>
<div class="proofscript" id="proof144">
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#tan_inj">tan_inj</a></span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id">ltr_oppl</span> <span class="id">opprK</span> <span class="id">ltr_oppl</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tanN">tanN</a></span> !<span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tanK">tanK</a></span> : {<span class="kwd">in</span> `](- (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)[ , <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#cancel">cancel</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</span></div>
<div class="proofscript" id="proof145">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">xB</span>; <span class="id">apply</span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan_inj">tan_inj</a></span> =&gt; //; <span class="id">rewrite</span> ?<span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="continuous_atan">continuous_atan</a></span> <span class="id">x</span> : {<span class="kwd">for</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.topology.html#continuous">continuous</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</span></div>
<div class="proofscript" id="proof146">
<span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2)[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_singleton">nbhs_singleton</a></span> (<span class="id"><a href="mathcomp.analysis.realfun.html#near_can_continuous">near_can_continuous</a></span> <span class="id">_</span> <span class="id">_</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#continuous_tan">continuous_tan</a></span>/<span class="id">lt0r_neq0</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>; <span class="id">near</span>: <span class="id">z</span>.<br/>
<span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#tanK">tanK</a></span>; <span class="id">near</span>: <span class="id">z</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cos_atan">cos_atan</a></span> <span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>) = (<span class="id">Num.sqrt</span> (1 + <span class="id">x</span> ^+ 2)) ^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</span></div>
<div class="proofscript" id="proof147">
<span class="id">have</span> <span class="id">cos_gt0</span> : 0 &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
<span class="id">have</span> <span class="id">cosD0</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>) != 0 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">lt0r_neq0</span>.<br/>
<span class="id">have</span> /<span class="id">eqP</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>) ^+2 = (<span class="id">Num.sqrt</span> (1 + <span class="id">x</span> ^+ 2))^-2.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS</a></span>]<span class="id">invrK</span> <span class="id"><a href="mathcomp.analysis.trigo.html#cos2_tan2">cos2_tan2</a></span> // <span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span> <span class="id">sqr_sqrtr</span> // <span class="id">addr_ge0</span> // <span class="id">sqr_ge0</span>.<br/>
<span class="id">rewrite</span> -<span class="id">exprVn</span> <span class="id">eqf_sqr</span> =&gt; /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orP">orP</a></span>[] /<span class="id">eqP</span> // <span class="id">cosE</span>.<br/>
<span class="id">move</span>: <span class="id">cos_gt0</span>; <span class="id">rewrite</span> <span class="id">cosE</span> <span class="id">ltNge</span>; <span class="id">case</span>/<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negP">negP</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">oppr_le0</span> <span class="id">invr_ge0</span> <span class="id">sqrtr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="is_derive1_atan">is_derive1_atan</a></span> (<span class="id">x</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span>) : <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">is_derive</a></span> <span class="id">x</span> 1 <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> (1 + <span class="id">x</span> ^+ 2)^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</span></div>
<div class="proofscript" id="proof148">
<span class="id">rewrite</span> -{1}[<span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span>.<br/>
<span class="id">have</span> <span class="id">cosD0</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#cos">cos</a></span> (<span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span>) != 0.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">lt0r_neq0</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.normedtype.html#near_in_itv">near_in_itv</a></span> <span class="id">aI</span> : <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> \<span class="kwd">in</span> `](-(<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)), (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span>/2)[.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : - (<span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2) &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#atan">atan</a></span> <span class="id">x</span> &lt; <span class="id"><a href="mathcomp.analysis.trigo.html#pi">pi</a></span> / 2 <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_gtNpi2">atan_gtNpi2</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#atan_ltpi2">atan_ltpi2</a></span>.<br/>
<span class="id">apply</span>: (@<span class="id"><a href="mathcomp.analysis.realfun.html#is_derive_inverse">is_derive_inverse</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#Atan.R">R</a></span> <span class="id"><a href="mathcomp.analysis.trigo.html#tan">tan</a></span>).<br/>
- <span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#tanK">tanK</a></span>; <span class="id">near</span>: <span class="id">z</span>.<br/>
- <span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#continuous_tan">continuous_tan</a></span>/<span class="id">lt0r_neq0</span>/<span class="id"><a href="mathcomp.analysis.trigo.html#cos_gt0_pihalf">cos_gt0_pihalf</a></span>; <span class="id">near</span>: <span class="id">z</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> 1 + <span class="id">X</span> ^+ 2]<span class="id"><a href="mathcomp.analysis.trigo.html#atanK">atanK</a></span> -<span class="id"><a href="mathcomp.analysis.trigo.html#cos2_tan2">cos2_tan2</a></span> //; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.trigo.html#is_derive_tan">is_derive_tan</a></span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">lt0r_neq0</span>/(@<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">_</span> 1) =&gt; //; <span class="id">rewrite</span> <span class="id">ler_addl</span> <span class="id">sqr_ge0</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.trigo.html#Atan">Atan</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
