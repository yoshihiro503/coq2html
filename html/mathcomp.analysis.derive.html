
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.derive</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.derive" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
  <link rel="stylesheet" href="../css/texmath.css">
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
  <script src="../texmath.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module mathcomp.analysis.derive</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">ssralg</span> <span class="id">ssrnum</span> <span class="id">matrix</span> <span class="id">interval</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.prodnormedzmodule.html">prodnormedzmodule</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.landau.html">landau</a></span> <span class="id"><a href="mathcomp.analysis.forms.html">forms</a></span>.<br/>
<br/>
<pre>
(******************************************************************************)
(* This file provides a theory of differentiation. It includes the standard   *)
(* rules of differentiation (differential of a sum, of a product, of          *)
(* exponentiation, of the inverse, etc.) as well as standard theorems (the    *)
(* Extreme Value Theorem, Rolle's theorem, the Mean Value Theorem).           *)
(*                                                                            *)
(* Parsable notations (in all of the following, f is not supposed to be       *)
(* differentiable):                                                           *)
(*               'd f x == the differential of a function f at a point x      *)
(*   differentiable f x == the function f is differentiable at a point x      *)
(*               'J f x == the Jacobian of f at a point x                     *)
(*               'D_v f == the directional derivative of f along v            *)
(*      derivable f a v == the function f is derivable at a with direction v  *)
(*                         The type of f is V -&gt; W with V W : normedModType R *)
(*                         and R : numFieldType                               *)
(*               f^`()  == the derivative of f of domain R                    *)
(*               f^`(n) == the nth derivative of f of domain R                *)
(******************************************************************************)</pre>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Theory</span>.<br/>
<span class="kwd">Import</span> <span class="id">numFieldNormedType.Exports</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "''<span class="id">d</span>' <span class="id">f</span> <span class="id">x</span>" (<span class="kwd">at</span> <span class="id">level</span> 0, <span class="id">f</span> <span class="kwd">at</span> <span class="id">level</span> 0, <span class="id">x</span> <span class="kwd">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;<span class="id">format</span> "''<span class="id">d</span>'  <span class="id">f</span>  <span class="id">x</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "'<span class="id">is_diff</span>' <span class="id">F</span>" (<span class="kwd">at</span> <span class="id">level</span> 0, <span class="id">F</span> <span class="kwd">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;<span class="id">format</span> "'<span class="id">is_diff</span>'  <span class="id">F</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "''<span class="id">J</span>' <span class="id">f</span> <span class="id">p</span>" (<span class="kwd">at</span> <span class="id">level</span> 10, <span class="id">p</span>, <span class="id">f</span> <span class="kwd">at</span> <span class="id">next</span> <span class="id">level</span>,<br/>
&nbsp;&nbsp;<span class="id">format</span> "''<span class="id">J</span>'  <span class="id">f</span>  <span class="id">p</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span>" (<span class="kwd">at</span> <span class="id">level</span> 10, <span class="id">v</span>, <span class="id">f</span> <span class="kwd">at</span> <span class="id">next</span> <span class="id">level</span>,<br/>
&nbsp;&nbsp;<span class="id">format</span> "''<span class="id">D_</span>' <span class="id">v</span>  <span class="id">f</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span> <span class="id">c</span>" (<span class="kwd">at</span> <span class="id">level</span> 10, <span class="id">v</span>, <span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">f</a></span> <span class="kwd">at</span> <span class="id">next</span> <span class="id">level</span>,<br/>
&nbsp;&nbsp;<span class="id">format</span> "''<span class="id">D_</span>' <span class="id">v</span>  <span class="id">f</span>  <span class="id">c</span>"). <br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> ^` ()" (<span class="kwd">at</span> <span class="id">level</span> 8, <span class="id">format</span> "<span class="id">f</span> ^` ()").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">f</span> ^` ( <span class="id">n</span> )" (<span class="kwd">at</span> <span class="id">level</span> 8, <span class="id">format</span> "<span class="id">f</span> ^` ( <span class="id">n</span> )").<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Differential</span>.<br/>
<span class="kwd">Context</span> {<span class="id">K</span> : <span class="id">numDomainType</span>} {<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">K</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#Phantom">diff</a></span> (<span class="id">F</span> : <span class="id">filter_on</span> <span class="id">V</span>) (<span class="id">_</span> : <span class="id">phantom</span> (<span class="id">set</span> (<span class="id">set</span> <span class="id">V</span>)) <span class="id">F</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :=<br/>
&nbsp;&nbsp;(<span class="id">get</span> (<span class="kwd">fun</span> (<span class="id">df</span> : {<span class="id">linear</span> <span class="id">V</span> -&gt; <span class="id">W</span>}) =&gt; <span class="id"><a name="differentiable_def">continuous</a></span> <span class="id">df</span> /\ <span class="kwd">forall</span> <span class="id"><a href="mathcomp.analysis.derive.html#Differential.V">x</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> (<span class="id">lim</span> <span class="id">F</span>) + <span class="id">df</span> (<span class="id">x</span> - <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#phantom">lim</a></span> <span class="id">F</span>) +<span class="id">o_</span>(<span class="id">x</span> \<span class="id"><a href="mathcomp.classical.classical_sets.html#set">near</a></span> <span class="id">F</span>) (<span class="id">x</span> - <span class="id">lim</span> <span class="id">F</span>))).<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "''<span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.topology.html#continuous">f</a></span> <span class="id">x</span>" := (@<span class="id">diff</span> <span class="id">_</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id"><a href="mathcomp.classical.functions.html#cst">filter</a></span> <span class="id">of</span> <span class="id">x</span>]) <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">diff_key</span> : <span class="kwd">forall</span> <span class="id">T</span>, <span class="id">T</span> -&gt; <span class="id">unit</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="kwd">by</span> <span class="id">constructor</span>. Qed.</div>
<span class="kwd">CoInductive</span> <span class="id">differentiable_def</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">x</span> : <span class="id">filter_on</span> <span class="id">V</span>)<br/>
&nbsp;&nbsp;(<span class="id">phF</span> : <span class="id">phantom</span> (<span class="id">set</span> (<span class="id">set</span> <span class="id">V</span>)) <span class="id">x</span>) : <span class="kwd">Prop</span> := <span class="id">DifferentiableDef</span> <span class="id">of</span><br/>
&nbsp;&nbsp;(<span class="id">continuous</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>) /\<br/>
&nbsp;&nbsp;<span class="id">f</span> = <span class="id">cst</span> (<span class="id"><a href="mathcomp.analysis.derive.html#Differential.V">f</a></span> (<span class="id">lim</span> <span class="id">x</span>)) + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> \<span class="id">o</span> <span class="id">center</span> (<span class="id">lim</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">x</a></span>) +<span class="id">o_x</span> (<span class="id">center</span> (<span class="id">lim</span> <span class="id">x</span>))).<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id">differentiable</span> <span class="id">f</span> <span class="id">F</span> := (@<span class="id">differentiable_def</span> <span class="id">f</span> <span class="id">_</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">F</span>])).<br/>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="diffP">is_diff_def</a></span> (<span class="id">x</span> : <span class="id">filter_on</span> <span class="id">V</span>) (<span class="id">Fph</span> : <span class="id">phantom</span> (<span class="id">set</span> (<span class="id">set</span> <span class="id">V</span>)) <span class="id">x</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>)<br/>
&nbsp;&nbsp;(<span class="id">df</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) := <span class="id">DiffDef</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_diff</span> : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">diff_val</span> : '<span class="id">d</span> <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.topology.html#lim">x</a></span> = <span class="id">df</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">W</span>)<br/>
&nbsp;&nbsp;}.<br/>
<span class="kwd">Hint</span> <span class="id">Mode</span> <span class="id">is_diff_def</span> - - ! - : <span class="id">typeclass_instances</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffP</span> (<span class="id">F</span> : <span class="id">filter_on</span> <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.derive.html#Differential.W">differentiable</a></span> <span class="id">f</span> <span class="id">F</span> &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">F</span>) /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> (<span class="id">lim</span> <span class="id">F</span>) + '<span class="id">d</span> <span class="id">f</span> <span class="id">F</span> (<span class="id">x</span> - <span class="id">lim</span> <span class="id">F</span>) +<span class="id">o_</span>(<span class="id">x</span> \<span class="id">near</span> <span class="id">F</span>) (<span class="id">x</span> - <span class="id">lim</span> <span class="id">F</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="kwd">by</span> <span class="id">split</span>=&gt; [[] |]; <span class="id">last</span> <span class="id">constructor</span>; <span class="id">rewrite</span> <span class="id">funeqE</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_continuous</span> (<span class="id">x</span> : <span class="id">filter_on</span> <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">continuous</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id"><a href="mathcomp.analysis.topology.html#lim">diffP</a></span> []. Qed.</div>
<span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id">continuous</span> <span class="id">_</span>) =&gt; <span class="id">exact</span>: <span class="id">diff_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffE</span> (<span class="id">F</span> : <span class="id">filter_on</span> <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.normedtype.html#shift">differentiable</a></span> <span class="id">f</span> <span class="id">F</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> (<span class="id">lim</span> <span class="id">F</span>) + '<span class="id">d</span> <span class="id">f</span> <span class="id">F</span> (<span class="id">x</span> - <span class="id">lim</span> <span class="id">F</span>) +<span class="id">o_</span>(<span class="id">x</span> \<span class="id">near</span> <span class="id">F</span>) (<span class="id">x</span> - <span class="id">lim</span> <span class="id">F</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">diffP</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">littleo_center0</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">e</span> : <span class="id">V</span> -&gt; <span class="id">V</span>) :<br/>
&nbsp;&nbsp;[<span class="id">o_x</span> <span class="id">e</span> <span class="id">of</span> <span class="id">f</span>] = [<span class="id">o_</span> (0 : <span class="id">V</span>) (<span class="id">e</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) <span class="id">of</span> <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>] \<span class="id">o</span> <span class="id">center</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">rewrite</span> /<span class="id">the_littleo</span> /<span class="id">insubd</span> /=; <span class="id">have</span> [<span class="id">g</span> /= <span class="id">_</span> &lt;-{<span class="id">f</span>}|/<span class="id">asboolP</span> <span class="id">Nfe</span>] /= := <span class="id">insubP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">insubT</span> //= ?<span class="id">comp_shiftK</span> //; <span class="id">apply</span>/<span class="id">asboolP</span> =&gt; <span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">eps</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> [\<span class="kwd">forall</span> <span class="id">x</span> \<span class="id">near</span> <span class="id">_</span>, <span class="id">_</span> &lt;= <span class="id">_</span>](<span class="id">near_shift</span> <span class="id">x</span>) <span class="id">sub0r</span>; <span class="id">near</span>=&gt; <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">subrK</span>; <span class="id">near</span>: <span class="id">y</span>; <span class="id">have</span> /<span class="id">eqoP</span> := <span class="id">littleo_eqo</span> <span class="id">g</span>; <span class="id">apply</span>.<br/>
<span class="id">rewrite</span> <span class="id">insubF</span> //; <span class="id">apply</span>/<span class="id">asboolP</span> =&gt; <span class="id">fe</span>; <span class="id">apply</span>: <span class="id">Nfe</span> =&gt; <span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">eps</span>].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [\<span class="kwd">forall</span> <span class="id">x</span> \<span class="id">near</span> <span class="id">_</span>, <span class="id">_</span> &lt;= <span class="id">_</span>](<span class="id">near_shift</span> 0) <span class="id">subr0</span>; <span class="id">apply</span>: <span class="id">fe</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Differential</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Differential_numFieldType</span>.<br/>
<span class="kwd">Context</span> {<span class="id">K</span> : <span class="id">numFieldType</span> } {<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">K</span>}.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> <span class="id">differentiable</span> <span class="id"><a href="mathcomp.analysis.derive.html#Differential_numFieldType.W">f</a></span> <span class="id">F</span> := (@<span class="id">differentiable_def</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.topology.html#continuous">_</a></span> <span class="id">_</span> <span class="id">f</span> <span class="id">_</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">F</span>])).<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "''<span class="id">d</span>' <span class="id">f</span> <span class="id">x</span>" := (@<span class="id">diff</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.derive.html#Differential_numFieldType.V">_</a></span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">x</span>]) <span class="id">f</span>).<br/>
<span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id">continuous</span> <span class="id">_</span>) =&gt; <span class="id">exact</span>: <span class="id">diff_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locallyxP</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> &lt;-&gt; <span class="id">continuous</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>) /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span>, <span class="id">f</span> (<span class="id">h</span> + <span class="id">x</span>) = <span class="id">f</span> <span class="id">x</span> + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">h</span> +<span class="id">o_</span>(<span class="id">h</span> \<span class="id">near</span> 0 : <span class="id">V</span>) <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">split</span>=&gt; [<span class="id">dxf</span>|[<span class="id">dfc</span> <span class="id">dxf</span>]].<br/>
&nbsp;&nbsp;<span class="id">split</span> =&gt; //; <span class="id">apply</span>: <span class="id">eqaddoEx</span> =&gt; <span class="id">h</span>; <span class="id">have</span> /<span class="id">diffE</span> -&gt; := <span class="id">dxf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#comp_centerK">lim_id</a></span> // <span class="id">addrK</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>); <span class="id">rewrite</span> <span class="id">littleo_center0</span> /= <span class="id">addrK</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">congr</span> ('<span class="id">o</span>); <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">k</span> /=; <span class="id">rewrite</span> <span class="id">addrK</span>.<br/>
<span class="id">apply</span>/<span class="id">diffP</span>; <span class="id">split</span>=&gt; //; <span class="id">apply</span>: <span class="id">eqaddoEx</span>; <span class="id">move</span>=&gt; <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id">lim_id</span> // -[<span class="kwd">in</span> <span class="id">LHS</span>](<span class="id">subrK</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">dxf</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="id">rewrite</span> -(<span class="id">comp_centerK</span> <span class="id">x</span> <span class="id">id</span>) -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">the_littleo</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span>](<span class="id">comp_centerK</span> <span class="id">x</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">_</span> (<span class="id">y</span> - <span class="id">x</span>)]/((<span class="id">_</span> \<span class="id">o</span> (<span class="id">center</span> <span class="id">x</span>)) <span class="id">y</span>) -<span class="id">littleo_center0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locallyx</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span>, <span class="id">f</span> (<span class="id">h</span> + <span class="id">x</span>) = <span class="id">f</span> <span class="id">x</span> + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">h</span> +<span class="id">o_</span>(<span class="id">h</span> \<span class="id">near</span> 0 : <span class="id">V</span>) <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">diff_locallyxP</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locallyxC</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span>, <span class="id">f</span> (<span class="id">x</span> + <span class="id">h</span>) = <span class="id">f</span> <span class="id">x</span> + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">h</span> +<span class="id">o_</span>(<span class="id">h</span> \<span class="id">near</span> 0 : <span class="id">V</span>) <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>/<span class="id">eqaddoEx</span> =&gt; <span class="id">h</span>; <span class="id">rewrite</span> [<span class="id">x</span> + <span class="id">h</span>]<span class="id">addrC</span> <span class="id">diff_locallyx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locallyP</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> ('<span class="id">d</span> <span class="id"><a href="mathcomp.analysis.derive.html#Differential_numFieldType.V">f</a></span> <span class="id">x</span>) /\ (<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>) + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">iff_trans</span> (<span class="id">diff_locallyxP</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">funeqE</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locally</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>) + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">diff_locallyP</span> []. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Differential_numFieldType</span>.<br/>
<br/>
<span class="kwd">Notation</span> "''<span class="id">d</span>' <span class="id">f</span> <span class="id">F</span>" := (@<span class="id">diff</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">F</span>]) <span class="id">f</span>).<br/>
<span class="kwd">Notation</span> <span class="id">differentiable</span> <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.topology.html#continuous">F</a></span> := (@<span class="id">differentiable_def</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> <span class="id">_</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">F</span>])).<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">is_diff</span>' <span class="id">F</span>" := (<span class="id">is_diff_def</span> (<span class="id">Phantom</span> <span class="id">_</span> [<span class="id">filter</span> <span class="id">of</span> <span class="id">F</span>])).<br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id">differentiable</span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">solve</span>[<span class="id">apply</span>: <span class="id">ex_diff</span>] : <span class="id">core</span>.<br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 ({<span class="kwd">for</span> <span class="id">_</span>, <span class="id">continuous</span> <span class="id">_</span>}) =&gt; <span class="id">exact</span>: <span class="id">diff_continuous</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableP</span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">DiffDef</span>. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">jacobian</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">jacobian</span> <span class="id">n</span> <span class="id">m</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">f</span> : '<span class="id">rV</span>[<span class="id">R</span>]<span class="id">_n</span>.+1 -&gt; '<span class="id">rV</span>[<span class="id">R</span>]<span class="id">_m</span>.+1) <span class="id">p</span> :=<br/>
&nbsp;&nbsp;<span class="id">lin1_mx</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">p</span>).<br/>
<br/>
<span class="kwd">End</span> <span class="id">jacobian</span>.<br/>
<br/>
<span class="kwd">Notation</span> "''<span class="id">J</span>' <span class="id">f</span> <span class="id">p</span>" := (<span class="id">jacobian</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR.V">f</a></span> <span class="id">p</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DifferentialR</span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">numFieldType</span>} {<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_continuous</span> (<span class="id">x</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id"><a href="mathcomp.analysis.landau.html#eqolim">f</a></span> <span class="id">x</span> -&gt; {<span class="kwd">for</span> <span class="id">x</span>, <span class="id">continuous</span> <span class="id">f</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move</span>=&gt; /<span class="id">diff_locallyP</span> [<span class="id">dfc</span>]; <span class="id">rewrite</span> -<span class="id">addrA</span>.<br/>
<span class="id">rewrite</span> (<span class="id">littleo_bigO_eqo</span> (<span class="id">cst</span> (1 : <span class="id">R</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqOP</span>; <span class="id">near</span>=&gt; <span class="id">k</span>; <span class="id">rewrite</span> /<span class="id"><a name="DifferentialR.littleo_lemmas.X">cst</a></span> [`|1|]<span class="id">normr1</span> <span class="id">mulr1</span>; <span class="id">near</span> <span class="id">do</span> <span class="kwd">by</span> [].<br/>
<span class="id">rewrite</span> <span class="id">addfo</span>; <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR.littleo_lemmas.X">first</a></span> <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">eqolim</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR.R">cvg_comp_shift</a></span> <span class="id">add0r</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqolim0P</span>; <span class="id">apply</span>: (<span class="id">cvg_trans</span> (<span class="id">dfc</span> 0)); <span class="id">rewrite</span> <span class="id">linear0</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">littleo_lemmas</span>.<br/>
<br/>
<span class="kwd">Variables</span> (<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">normm_littleo</span> <span class="id">x</span> (<span class="id">f</span> : <span class="id">X</span> -&gt; <span class="id">Y</span>) : `| [<span class="id">o_</span>(<span class="id">x</span> \<span class="id">near</span> <span class="id">x</span>) (1 : <span class="id">R</span>) <span class="id">of</span> <span class="id">f</span> <span class="id">x</span>]| = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">rewrite</span> /<span class="id">cst</span> /=; <span class="id">have</span> [<span class="id">e</span> /(<span class="id">_</span> (`|<span class="id">e</span> <span class="id">x</span>|/2) <span class="id">_</span>)/<span class="id">nbhs_singleton</span> /=] := <span class="id">littleo</span>.<br/>
<span class="id">rewrite</span> <span class="id">pmulr_lgt0</span> // [`|1|]<span class="id">normr1</span> <span class="id">mulr1</span> [<span class="id">leLHS</span>]<span class="id">splitr</span> <span class="id">ger_addr</span> <span class="id">pmulr_lle0</span> //.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">implyP</span>; <span class="id">case</span> : <span class="id">real_ltgtP</span>; <span class="id">rewrite</span> ?<span class="id">realE</span> ?<span class="id">normrE</span> //= <span class="id">lexx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">littleo_lim0</span> (<span class="id">f</span> : <span class="id">X</span> -&gt; <span class="id">Y</span>) (<span class="id">h</span> : <span class="id"><a name="DifferentialR.diff_locally_converse_tentative">_</a></span> -&gt; <span class="id">Z</span>) (<span class="id">x</span> : <span class="id">X</span>) :<br/>
&nbsp;&nbsp;<span class="id">f</span> @ <span class="id">x</span> --&gt; (0 : <span class="id">Y</span>) -&gt; [<span class="id">o_x</span> <span class="id">f</span> <span class="id">of</span> <span class="id">h</span>] <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">move</span>/<span class="id">eqolim0P</span> =&gt; -&gt;; <span class="id">have</span> [<span class="id">k</span> /(<span class="id">_</span> <span class="id">_</span> [<span class="id">gt0</span> <span class="id">of</span> 1 : <span class="id">R</span>])/=] := <span class="id">littleo</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">nbhs_singleton</span>; <span class="id">rewrite</span> <span class="id">mul1r</span> <span class="id">normm_littleo</span> <span class="id">normr_le0</span> =&gt; /<span class="id">eqP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">littleo_lemmas</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">diff_locally_converse_tentative</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">diff_locally_converse_part1</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">x</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> <span class="id">a</span> + <span class="id">b</span> *: <span class="id">idfun</span> +<span class="id">o_</span> (0 : <span class="id">R</span>) <span class="id">id</span> -&gt; <span class="id">f</span> <span class="id">x</span> = <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; /(<span class="id">_</span> 0) /=; <span class="id">rewrite</span> <span class="id">add0r</span> =&gt; -&gt;.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">LHS</span>]/(<span class="id"><a href="mathcomp.analysis.derive.html#derive">_</a></span> 0 + <span class="id">_</span> 0 + <span class="id">_</span> 0) /<span class="id">cst</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">a</span> + <span class="id">X</span>]<span class="id">scaler0</span> <span class="id">littleo_lim0</span> ?<span class="id">addr0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">diff_locally_converse_tentative</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">derive</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">a</span> <span class="id">v</span> :=<br/>
&nbsp;&nbsp;<span class="id">lim</span> ((<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: ((<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">a</span>) (<span class="id">h</span> *: <span class="id">v</span>) - <span class="id">f</span> <span class="id">a</span>)) @ 0^').<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span>" := (<span class="id">derive</span> <span class="id">f</span> ^~ <span class="id">v</span>).<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span> <span class="id">c</span>" := (<span class="id">derive</span> <span class="id">f</span> <span class="id">c</span> <span class="id">v</span>). <br/>
<br/>
<span class="kwd">Definition</span> <span class="id">derivable</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id"><a href="mathcomp.analysis.derive.html#derivable">a</a></span> <span class="id">v</span> :=<br/>
&nbsp;&nbsp;<span class="id">cvg</span> ((<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: ((<span class="id">f</span> \<span class="id"><a href="mathcomp.analysis.normedtype.html#shift">o</a></span> <span class="id">shift</span> <span class="id">a</span>) (<span class="id">h</span> *: <span class="id">v</span>) - <span class="id"><a href="mathcomp.classical.functions.html#cst">f</a></span> <span class="id">a</span>)) @ 0^').<br/>
<br/>
<span class="kwd">Class</span> <span class="id">is_derive</span> (<span class="id">a</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">df</span> : <span class="id">W</span>) := <span class="id">DeriveDef</span> {<br/>
&nbsp;&nbsp;<span class="id">ex_derive</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span>;<br/>
&nbsp;&nbsp;<span class="id">derive_val</span> : '<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span> = <span class="id"><a href="mathcomp.analysis.normedtype.html#NbhsNorm.nbhs_simpl">df</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_nbhs</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">a</span> <span class="id">v</span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; (<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">a</span>) (<span class="id">h</span> *: <span class="id">v</span>)) = (<span class="id">cst</span> (<span class="id">f</span> <span class="id">a</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> *: ('<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span>)) +<span class="id">o_</span> (<span class="id">nbhs</span> (0 :<span class="id">R</span>)) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">eqaddoP</span> =&gt; <span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">e</span>].<br/>
<span class="id">rewrite</span> -<span class="id">nbhs_nearE</span> <span class="id">nbhs_simpl</span> /= <span class="id">dnbhsE</span>; <span class="id">split</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">at_point</span> <span class="id">opprD</span> -![(<span class="id">_</span> + <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(<span class="id">_</span> + <span class="id">_</span>) <span class="id">scale0r</span> <span class="id">add0r</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addrA</span> <span class="id">subrr</span> <span class="id">add0r</span> <span class="id">normrN</span> <span class="id">scale0r</span> !<span class="id">normr0</span> <span class="id">mulr0</span>.<br/>
<span class="id">have</span> /<span class="id">eqolimP</span> := <span class="id">df</span>; <span class="id">rewrite</span> -[<span class="id">lim</span> <span class="id">_</span>]/(<span class="id">derive</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">move</span>=&gt; /<span class="id">eqaddoP</span> /(<span class="id">_</span> <span class="id">e</span>%:<span class="id">num</span>) /(<span class="id">_</span> [<span class="id">gt0</span> <span class="id">of</span> <span class="id">e</span>%:<span class="id">num</span>]).<br/>
<span class="id">apply</span>: <span class="id">filter_app</span>; <span class="id">rewrite</span> /= !<span class="id">near_simpl</span> <span class="id">near_withinE</span>; <span class="id">near</span>=&gt; <span class="id">h</span> =&gt; <span class="id">hN0</span>.<br/>
<span class="id">rewrite</span> /= <span class="id">opprD</span> -![(<span class="id">_</span> + <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(<span class="id">_</span> + <span class="id">_</span>) -![(- <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(- <span class="id">_</span>).<br/>
<span class="id">rewrite</span> /<span class="id">cst</span> /= [`|1|]<span class="id">normr1</span> <span class="id">mulr1</span> =&gt; <span class="id">dfv</span>.<br/>
<span class="id">rewrite</span> <span class="id">addrA</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> + <span class="id">_</span>]<span class="id">scale1r</span> -(@<span class="id">mulVf</span> <span class="id">_</span> <span class="id">h</span>) //.<br/>
<span class="id">rewrite</span> <span class="id">mulrC</span> -<span class="id">scalerA</span> -<span class="id"><a href="mathcomp.analysis.normedtype.html#shift">scalerBr</a></span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ler_pdivl_mull</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_gt0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrCA</span> <span class="id">mulVf</span> ?<span class="id">mulr1</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_eq0</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_nbhsP</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.topology.html#dnbhs_filter_on">v</a></span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.landau.html#eqaddoP">v</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id"><a href="mathcomp.analysis.signed.html#posnumP">h</a></span> =&gt; (<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">a</span>) (<span class="id">h</span> *: <span class="id">v</span>)) = (<span class="id">cst</span> (<span class="id">f</span> <span class="id">a</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> *: ('<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span>)) +<span class="id">o_</span> (<span class="id">nbhs</span> (0 : <span class="id">R</span>)) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivable_nbhs</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> ('<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span>).<br/>
<span class="id">apply</span>/(@<span class="id">eqolimP</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">dnbhs_filter_on</span> <span class="id">_</span>))/<span class="id">eqaddoP</span> =&gt; <span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">e</span>].<br/>
<span class="id">have</span> /<span class="id">eqaddoP</span> /(<span class="id">_</span> <span class="id">e</span>%:<span class="id">num</span>) /(<span class="id">_</span> [<span class="id">gt0</span> <span class="id">of</span> <span class="id">e</span>%:<span class="id">num</span>]) := <span class="id">df</span>.<br/>
<span class="id">rewrite</span> /= !(<span class="id">near_simpl</span>, <span class="id">near_withinE</span>); <span class="id">apply</span>: <span class="id">filter_app</span>; <span class="id">near</span>=&gt; <span class="id">h</span>.<br/>
<span class="id">rewrite</span> /= <span class="id">opprD</span> -![(<span class="id">_</span> + <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(<span class="id">_</span> + <span class="id">_</span>) -![(- <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(- <span class="id">_</span>).<br/>
<span class="id">rewrite</span> /<span class="id">cst</span> /= [`|1|]<span class="id">normr1</span> <span class="id">mulr1</span> <span class="id">addrA</span> =&gt; <span class="id">dfv</span> <span class="id">hN0</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> - <span class="id">X</span>]<span class="id">scale1r</span> -(@<span class="id">mulVf</span> <span class="id">_</span> <span class="id">h</span>) //.<br/>
<span class="id">rewrite</span> -<span class="id">scalerA</span> -<span class="id">scalerBr</span> <span class="id">normrZ</span> <span class="id">normfV</span> <span class="id">ler_pdivr_mull</span> ?<span class="id">normr_gt0</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_nbhsx</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">a</span> <span class="id">v</span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span> -&gt; <span class="kwd">forall</span> <span class="id">h</span>, <span class="id">f</span> (<span class="id">a</span> + <span class="id">h</span> *: <span class="id">v</span>) = <span class="id">f</span> <span class="id">a</span> + <span class="id">h</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span><br/>
&nbsp;&nbsp;+<span class="id">o_</span>(<span class="id">h</span> \<span class="id">near</span> (<span class="id">nbhs</span> (0 : <span class="id">R</span>))) <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id"><a href="mathcomp.analysis.topology.html#nbhs">move</a></span>=&gt; /<span class="id">derivable_nbhs</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">df</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eqaddoEx</span> =&gt; <span class="id">h</span>; <span class="id">have</span> /= := (<span class="id">df</span> <span class="id">h</span>); <span class="id">rewrite</span> <span class="id">addrC</span> =&gt; -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_nbhsxP</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">a</span> <span class="id">v</span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span> &lt;-&gt; <span class="kwd">forall</span> <span class="id">h</span>, <span class="id">f</span> (<span class="id">a</span> + <span class="id">h</span> *: <span class="id">v</span>) = <span class="id">f</span> <span class="id">a</span> + <span class="id">h</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span><br/>
&nbsp;&nbsp;+<span class="id">o_</span>(<span class="id">h</span> \<span class="id">near</span> (<span class="id">nbhs</span> (0 :<span class="id">R</span>))) <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivable_nbhsx</span>.<br/>
<span class="id"><a href="mathcomp.analysis.derive.html#derivable">move</a></span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">derivable_nbhsP</span>; <span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">h</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">addrC</span> <span class="id">df</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DifferentialR</span>.<br/>
<br/>
<span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span>" := (<span class="id">derive</span> <span class="id">f</span> ^~ <span class="id">v</span>).<br/>
<span class="kwd">Notation</span> "''<span class="id">D_</span>' <span class="id">v</span> <span class="id">f</span> <span class="id">c</span>" := (<span class="id">derive</span> <span class="id">f</span> <span class="id">c</span> <span class="id">v</span>). <br/>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Extern</span> 0 (<span class="id">derivable</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_locally">_</a></span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">solve</span>[<span class="id">apply</span>: <span class="id">ex_derive</span>] : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DifferentialR_numFieldType</span>.<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">numFieldType</span>} {<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveE</span> (<span class="id">f</span> : <span class="id"><a href="mathcomp.classical.functions.html#cst">V</a></span> -&gt; <span class="id">W</span>) (<span class="id">a</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">a</span> -&gt; '<span class="id">D_v</span> <span class="id">f</span> <span class="id">a</span> = '<span class="id">d</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">rewrite</span> /<span class="id">derive</span> =&gt; /<span class="id">diff_locally</span> -&gt; /=; <span class="id">set</span> <span class="id">k</span> := '<span class="id">o</span> <span class="id">_</span>.<br/>
<span class="id">evar</span> (<span class="id">g</span> : <span class="id">R</span> -&gt; <span class="id">W</span>); <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = <span class="id">g</span>) /=; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">funeqE</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> !<span class="id"><a href="mathcomp.classical.boolp.html#funeqE">scalerDr</a></span> <span class="id">scalerN</span> /<span class="id">cst</span> /=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addrC</span> !<span class="id">addrA</span> <span class="id">addNr</span> <span class="id">add0r</span> <span class="id">linearZ</span> /= <span class="id">scalerA</span> /<span class="id">g</span>.<br/>
<span class="id">apply</span>: <span class="id">cvg_lim</span> =&gt; //.<br/>
<span class="id">pose</span> <span class="id">g1</span> : <span class="id">R</span> -&gt; <span class="id">W</span> := <span class="kwd">fun</span> <span class="id">h</span> =&gt; (<span class="id">h</span>^-1 * <span class="id">h</span>) *: '<span class="id">d</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span>.<br/>
<span class="id">pose</span> <span class="id">g2</span> : <span class="id">R</span> -&gt; <span class="id">W</span> := <span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">h</span>^-1 *: <span class="id">k</span> (<span class="id">h</span> *: <span class="id">v</span> ).<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">g</span> = <span class="id">g1</span> + <span class="id">g2</span>) ?<span class="id">funeqE</span> // -(<span class="id">addr0</span> (<span class="id">_</span> <span class="id">_</span> <span class="id">v</span>)); <span class="id">apply</span>: <span class="id">cvgD</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -(<span class="id">scale1r</span> (<span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">v</a></span>)); <span class="id">apply</span>: <span class="id">cvgZl</span> =&gt; /= <span class="id">X</span> [<span class="id">e</span> <span class="id">e0</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">ball_</span> /= =&gt; <span class="id">eX</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">nbhs_ballP</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">e</span> =&gt; //= <span class="id">x</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#cvgrPdist_lt">x0</a></span>; <span class="id">apply</span> <span class="id">eX</span>; <span class="id">rewrite</span> <span class="id">mulVr</span> // ?<span class="id">unitfE</span> //= <span class="id">subrr</span> <span class="id">normr0</span>.<br/>
<span class="id">rewrite</span> /<span class="id">g2</span>.<br/>
<span class="id">have</span> [/<span class="id">eqP</span> -&gt;|<span class="id">v0</span>] := <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_ballP">boolP</a></span> (<span class="id">v</span> == 0).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">cst</span> 0); <span class="id">first</span> <span class="id">exact</span>: <span class="id">cvg_cst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; ?; <span class="id">rewrite</span> <span class="id">scaler0</span> /<span class="id">k</span> <span class="id">littleo_lim0</span> // <span class="id">scaler0</span>.<br/>
<span class="id">apply</span>/<span class="id">cvgrPdist_lt</span> =&gt; <span class="id">e</span> <span class="id">e0</span>.<br/>
<span class="id">rewrite</span> <span class="id">nearE</span> /=; <span class="id">apply</span>/<span class="id">nbhs_ballP</span>.<br/>
<span class="id">have</span> /(<span class="id">littleoP</span> [<span class="id">littleo</span> <span class="id">of</span> <span class="id">k</span>]) /<span class="id">nbhs_ballP</span>[<span class="id">i</span> <span class="id">i0</span> <span class="id">Hi</span>] : 0 &lt; <span class="id">e</span> / (2 * `|<span class="id">v</span>|).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span> // <span class="id">pmulr_rgt0</span> // <span class="id">normr_gt0</span>.<br/>
<span class="kwd">exists</span> (<span class="id">i</span> / `|<span class="id">v</span>|); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">divr_gt0</span> // <span class="id"><a href="mathcomp.analysis.normedtype.html#ball_normE">normr_gt0</a></span>.<br/>
<span class="id">move</span>=&gt; /= <span class="id">j</span>; <span class="id">rewrite</span> /<span class="id">ball</span> /= /<span class="id">ball_</span> <span class="id">add0r</span> <span class="id">normrN</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltr_pdivl_mulr</span> ?<span class="id">normr_gt0</span> // =&gt; <span class="id">jvi</span> <span class="id">j0</span>.<br/>
<span class="id">rewrite</span> <span class="id">add0r</span> <span class="id">normrN</span> <span class="id">normrZ</span> -<span class="id">ltr_pdivl_mull</span> ?<span class="id">normr_gt0</span> ?<span class="id">invr_neq0</span> //.<br/>
<span class="id">have</span> /<span class="id">Hi</span>/<span class="id">le_lt_trans</span> -&gt; // : <span class="id">ball</span> 0 <span class="id">i</span> (<span class="id">j</span> *: <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ball_normE</span>/= <span class="id">add0r</span> <span class="id">normrN</span> (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">jvi</span>) // <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> -(<span class="id">mulrC</span> <span class="id">e</span>) -<span class="id">mulrA</span> -<span class="id">ltr_pdivl_mull</span> // <span class="id">mulrA</span> <span class="id">mulVr</span> ?<span class="id">unitfE</span> ?<span class="id">gt_eqF</span> //.<br/>
<span class="id">rewrite</span> <span class="id">normrV</span> ?<span class="id">unitfE</span> // <span class="id">div1r</span> <span class="id">invrK</span> <span class="id">ltr_pdivr_mull</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">pmulr_rgt0</span> // <span class="id">normr_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">normrZ</span> <span class="id">mulrC</span> -<span class="id">mulrA</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_pmull</span> ?<span class="id">ltr1n</span> // <span class="id">pmulr_rgt0</span> ?<span class="id">normm_gt0</span> // <span class="id">normr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DifferentialR_numFieldType</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DifferentialR2</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">numFieldType</span>.<br/>
<span class="kwd">Implicit</span> <span class="kwd">Type</span> (<span class="id">V</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivemxE</span> <span class="id">m</span> <span class="id">n</span> (<span class="id">f</span> : '<span class="id">rV</span>[<span class="id">R</span>]<span class="id">_m</span>.+1 -&gt; '<span class="id">rV</span>[<span class="id">R</span>]<span class="id">_n</span>.+1) (<span class="id">a</span> <span class="id">v</span> : '<span class="id">rV</span>[<span class="id">R</span>]<span class="id">_m</span>.+1) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">a</span> -&gt; '<span class="id"><a name="derive1E">D_</a></span> <span class="id">v</span> <span class="id">f</span> <span class="id">a</span> = <span class="id">v</span> *<span class="id">m</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR2.R">jacobian</a></span> <span class="id">f</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">deriveE</span>-&gt;; <span class="id">rewrite</span> /<span class="id">jacobian</span> <span class="id">mul_rV_lin1</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">derive1</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR2.R">V</a></span>) (<span class="id">a</span> : <span class="id">R</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id">lim</span> ((<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (<span class="id">f</span> (<span class="id"><a href="mathcomp.classical.boolp.html#funeqE">h</a></span> + <span class="id">a</span>) - <span class="id">f</span> <span class="id">a</span>)) @ 0^').<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "<span class="id">f</span> ^` ()" := (<span class="id">derive1</span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1E</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) <span class="id">a</span> : <span class="id">f</span>^`() <span class="id">a</span> = '<span class="id">D_1</span> <span class="id">f</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">rewrite</span> /<span class="id">derive1</span> /<span class="id">derive</span>; <span class="id">set</span> <span class="id">d</span> := (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id">R</span> =&gt; <span class="id">_</span>); <span class="id">set</span> <span class="id">d</span>' := (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id">R</span> =&gt; <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">suff</span> -&gt; : <span class="id">d</span> = <span class="id">d</span>' <span class="kwd">by</span> []; <span class="id">rewrite</span> <span class="id">funeqE</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> /<span class="id">d</span> /<span class="id">d</span>' /= [<span class="id">h</span>%:<span class="id">A</span>](<span class="id">mulr1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="derive1n0">derive1E</a></span>' <span class="id">V</span> <span class="id">f</span> <span class="id">a</span> : <span class="id">differentiable</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f</span>^`() <span class="id">a</span> = '<span class="id">d</span> <span class="id">f</span> <span class="id">a</span> 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> <span class="id">derive1E</span> <span class="id">deriveE</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">derive1n</span> <span class="id">V</span> <span class="id">n</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) := <span class="id">iter</span> <span class="id">n</span> (@<span class="id">derive1</span> <span class="id">V</span>) <span class="id">f</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "<span class="id">f</span> ^` ( <span class="id">n</span> )" := (<span class="id">derive1n</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR2.R">n</a></span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1n0</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) : <span class="id">f</span>^`(0) = <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1n1</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) : <span class="id">f</span>^`(1) = <span class="id">f</span>^`().<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1nS</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) <span class="id">n</span> : <span class="id">f</span>^`(<span class="id">n</span>.+1) = <span class="id">f</span>^`(<span class="id">n</span>)^`().<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1Sn</span> <span class="id">V</span> (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">V</span>) <span class="id">n</span> : <span class="id">f</span>^`(<span class="id">n</span>.+1) = <span class="id">f</span>^`()^`(<span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="id">exact</span>: <span class="id">iterSr</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DifferentialR2</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">f</span> ^` ()" := (<span class="id">derive1</span> <span class="id">f</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">f</span> ^` ( <span class="id">n</span> )" := (<span class="id">derive1n</span> <span class="id"><a href="mathcomp.analysis.landau.html#eqaddoE">n</a></span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DifferentialR3</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">numFieldType</span>.<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">dcst</span> (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">a</span> : <span class="id">W</span>) (<span class="id">x</span> : <span class="id">V</span>) : <span class="id">continuous</span> (0 : <span class="id">V</span> -&gt; <span class="id">W</span>) /\<br/>
&nbsp;&nbsp;<span class="id">cst</span> <span class="id"><a name="DifferentialR3.V">a</a></span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3.R">cst</a></span> <span class="id">a</span> <span class="id">x</span>) + \0 +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">cst_continuous</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">addr0</span> <span class="id">funeqE</span> =&gt; ? /=; <span class="id">rewrite</span> -[<span class="id"><a href="mathcomp.analysis.normedtype.html#shift">LHS</a></span>]<span class="id">addr0</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">littleoE</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">littleo0_subproof</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variables</span> (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">dadd</span> (<span class="id"><a href="mathcomp.analysis.landau.html#eqaddoE">f</a></span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.boolp.html#funeqE">differentiable</a></span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> \+ '<span class="id"><a href="mathcomp.analysis.derive.html#diff_locallyx">d</a></span> <span class="id">g</span> <span class="id">x</span>) /\<br/>
&nbsp;&nbsp;(<span class="id">f</span> + <span class="id">g</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> ((<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span>) + ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> \+ '<span class="id">d</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3.W">g</a></span> <span class="id">x</span>) +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">split</span> =&gt; [?|]; <span class="id">do</span> ?<span class="id">exact</span>: <span class="id">continuousD</span>.<br/>
<span class="id">apply</span>/(@<span class="id">eqaddoE</span> <span class="id">R</span>); <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3.V">y</a></span> /=; <span class="id">rewrite</span> -[(<span class="id">f</span> + <span class="id">g</span>) <span class="id">_</span>]/(<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> ![<span class="id">_</span> (<span class="id">_</span> + <span class="id">x</span>)]<span class="id">diff_locallyx</span>// <span class="id">addrACA</span> <span class="id">addox</span> <span class="id">addrACA</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dopp</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">continuous</span> (- ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">V</span> -&gt; <span class="id"><a name="is_diff_eq">W</a></span>)) /\<br/>
&nbsp;&nbsp;(- <span class="id">f</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (- <span class="id">f</span> <span class="id">x</span>) \- '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">split</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">continuousN</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[(- <span class="id">f</span>) <span class="id">_</span>]/(- (<span class="id">_</span> <span class="id"><a href="mathcomp.analysis.topology.html#continuous">_</a></span>)) <span class="id">diff_locallyx</span>// !<span class="id">opprD</span> <span class="id">oppox</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">is_diff_eq</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> <span class="id">f</span>' <span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') (<span class="id">x</span> : <span class="id">V</span>') :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">f</span>' -&gt; <span class="id">f</span>' = <span class="id">g</span> -&gt; <span class="id">is_diff</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#continuousZr">x</a></span> <span class="id">f</span> <span class="id">g</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? &lt;-. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dscale</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">k</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">continuous</span> (<span class="id">k</span> \*: '<span class="id">d</span> <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.landau.html#scaleox">x</a></span>) /\<br/>
&nbsp;&nbsp;(<span class="id">k</span> *: <span class="id">f</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> ((<span class="id">k</span> *: <span class="id">f</span>) <span class="id">x</span>) + <span class="id">k</span> \*: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">move</span>=&gt; <span class="id"><a name="dscalel">df</a></span>; <span class="id">split</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">continuousZr</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -[(<span class="id">k</span> *: <span class="id">f</span>) <span class="id">_</span>]/(<span class="id">_</span> *: <span class="id">_</span>) <span class="id">diff_locallyx</span> // !<span class="id">scalerDr</span> <span class="id">scaleox</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dscalel</span> (<span class="id">k</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) (<span class="id">f</span> : <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.landau.html#eqaddoE">differentiable</a></span> <span class="id">k</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">z</span> : <span class="id"><a href="mathcomp.analysis.derive.html#diff_locallyx">V</a></span> =&gt; '<span class="id">d</span> <span class="id">k</span> <span class="id">x</span> <span class="id">z</span> *: <span class="id">f</span>) /\<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">k</span> <span class="id">z</span> *: <span class="id">f</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cst</span> (<span class="id">k</span> <span class="id">x</span> *: <span class="id">f</span>) + (<span class="kwd">fun</span> <span class="id">z</span> =&gt; '<span class="id">d</span> <span class="id">k</span> <span class="id">x</span> <span class="id">z</span> *: <span class="id">f</span>) +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; ?; <span class="id">exact</span>/<span class="id">continuousZl</span>/<span class="id">diff_continuous</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diff_locallyx</span> //= !<span class="id">scalerDl</span> <span class="id">scaleolx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dlin</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span>' -&gt; <span class="id">W</span>'}) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> <span class="id">f</span> -&gt; <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>) + <span class="id">f</span> +<span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">o_</a></span> (0 : <span class="id">V</span>') <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>: <span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="id">rewrite</span> <span class="id">linearD</span> <span class="id">addrC</span> -[<span class="id">LHS</span>]<span class="id">addr0</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.landau.html#eqoP">rewrite</a></span> <span class="id">littleoE</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">littleo0_subproof</span>. <span class="comment">(*fixme*)</span><br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">compoO_eqo</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') :<br/>
&nbsp;&nbsp;[<span class="id">o_</span> (0 : <span class="id">V</span>') <span class="id">id</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_ballP">g</a></span>] \<span class="id">o</span> [<span class="id">O_</span> (0 : <span class="id">U</span>) <span class="id"><a href="mathcomp.analysis.signed.html#posnumP">id</a></span> <span class="id">of</span> <span class="id">f</span>] =<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">apply</span>/<span class="id">eqoP</span> =&gt; <span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>].<br/>
<span class="id">have</span> /<span class="id">bigO_exP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">k</span>]] := <span class="id">bigOP</span> [<span class="id">bigO</span> <span class="id">of</span> [<span class="id">O_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>]].<br/>
<span class="id">have</span> := <span class="id">littleoP</span> [<span class="id">littleo</span> <span class="id">of</span> [<span class="id">o_</span> (0 : <span class="id">V</span>') <span class="id">id</span> <span class="id">of</span> <span class="id">g</span>]].<br/>
<span class="id">move</span>=&gt;  /(<span class="id">_</span> (<span class="id">e</span>%:<span class="id">num</span> / <span class="id">k</span>%:<span class="id">num</span>)) /(<span class="id">_</span> <span class="id">_</span>) /<span class="id"><a href="mathcomp.analysis.normedtype.html#ball_normE">nbhs_ballP</a></span> [//|<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">d</span>] <span class="id">hd</span>].<br/>
<span class="id">apply</span>: <span class="id">filter_app</span>; <span class="id">near</span>=&gt; <span class="id">x</span> =&gt; <span class="id">leOxkx</span>; <span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id">hd</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">ler_pdivl_mull</span> //; <span class="id">apply</span>: <span class="id">le_trans</span> <span class="id">leOxkx</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invf_div</span> <span class="id">mulrA</span> -[<span class="id">_</span> / <span class="id">_</span> * <span class="id">_</span>]<span class="id">mulrA</span> <span class="id">mulVf</span> // <span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span> (<span class="id">le_lt_trans</span> <span class="id">leOxkx</span>) // -<span class="id">ltr_pdivl_mull</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">compoO_eqox</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> : <span class="id">U</span>, [<span class="id">o_</span> (0 : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">V</a></span>') <span class="id">id</span> <span class="id">of</span> <span class="id">g</span>] ([<span class="id">O_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>] <span class="id">x</span>) =<span class="id">o_</span>(<span class="id">x</span> \<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">near</a></span> 0 : <span class="id">U</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> -[<span class="id">LHS</span>]/((<span class="id">_</span> \<span class="id">o</span> <span class="id">_</span>) <span class="id">x</span>) <span class="id">compoO_eqo</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">compOo_eqo</span>  (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') :<br/>
&nbsp;&nbsp;[<span class="id">O_</span> (0 : <span class="id">V</span>') <span class="id">id</span> <span class="id">of</span> <span class="id">g</span>] \<span class="id">o</span> [<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>] =<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">apply</span>/<span class="id">eqoP</span> =&gt; <span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>].<br/>
<span class="id">have</span> /<span class="id">bigO_exP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">k</span>]] := <span class="id">bigOP</span> [<span class="id">bigO</span> <span class="id">of</span> [<span class="id">O_</span> (0 : <span class="id">V</span>') <span class="id">id</span> <span class="id">of</span> <span class="id">g</span>]].<br/>
<span class="id">move</span>=&gt; /<span class="id">nbhs_ballP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">d</span>] <span class="id">hd</span>].<br/>
<span class="id">have</span> <span class="id">ekgt0</span> : <span class="id">e</span>%:<span class="id">num</span> / <span class="id">k</span>%:<span class="id">num</span> &gt; 0 <span class="kwd">by</span> [].<br/>
<span class="id">have</span> /(<span class="id">_</span> <span class="id">_</span> <span class="id">ekgt0</span>) := <span class="id">littleoP</span> [<span class="id">littleo</span> <span class="id">of</span> [<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>]].<br/>
<span class="id">apply</span>: <span class="id">filter_app</span>; <span class="id">near</span>=&gt; <span class="id">x</span> =&gt; <span class="id">leoxekx</span>; <span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id">hd</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_pdivl_mull</span> // <span class="id">mulrA</span> [<span class="id">_</span>^-1 * <span class="id">_</span>]<span class="id">mulrC</span>.<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">rewrite</a></span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span> (<span class="id">le_lt_trans</span> <span class="id">leoxekx</span>)// -<span class="id">ltr_pdivl_mull</span> //.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DifferentialR3</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DifferentialR3_numFieldType</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">numFieldType</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">littleo_linear0</span> (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span> -&gt; <span class="id">W</span>}) :<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) =<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span> -&gt; <span class="id">f</span> = <span class="id">cst</span> 0 :&gt; (<span class="id">V</span> -&gt; <span class="id">W</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">move</span>/<span class="id">eqoP</span> =&gt; <span class="id">oid</span>.<br/>
<span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">x</span>; <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">have</span> [|<span class="id">xn0</span>] := <span class="id">real_le0P</span> (<span class="id">normr_real</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_le0</span> =&gt; /<span class="id">eqP</span> -&gt;; <span class="id">rewrite</span> <span class="id">linear0</span>.<br/>
<span class="id">rewrite</span> -<span class="id">normr_le0</span> -(<span class="id"><a href="mathcomp.analysis.normedtype.html#normrZ">mul0r</a></span> `|<span class="id">x</span>|) -<span class="id">ler_pdivr_mulr</span> //.<br/>
<span class="id">apply</span>/<span class="id">ler_gtP</span> =&gt; <span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>]; <span class="id">rewrite</span> <span class="id">ler_pdivr_mulr</span> //.<br/>
<span class="id">have</span> /<span class="id">oid</span> /<span class="id">nbhs_ballP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">d</span>] <span class="id">dfe</span>] := !! <span class="id">gt0</span> <span class="id">e</span>.<br/>
<span class="id">set</span> <span class="id">k</span> := ((<span class="id">d</span>%:<span class="id">num</span> / 2) / (<span class="id">PosNum</span> <span class="id">xn0</span>)%:<span class="id">num</span>)^-1.<br/>
<span class="id">rewrite</span> -{1}(@<span class="id">scalerKV</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#normrZ">_</a></span> <span class="id">k</span> <span class="id">_</span> <span class="id">x</span>) /<span class="id">k</span> // <span class="id">linearZZ</span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ler_pdivl_mull</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gtr0_norm</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrCA</span> (@<span class="id">le_trans</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">e</span>%:<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ltRHS">num</a></span> * `|<span class="id">k</span>^-1 *: <span class="id">x</span>|)) //; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_pmul</span> // <span class="id">normrZ</span> <span class="id">normfV</span>.<br/>
<span class="id">apply</span>: <span class="id">dfe</span>; <span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">sub0r</span> <span class="id">normrN</span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> <span class="id">invrK</span> -<span class="id">ltr_pdivl_mulr</span> // <span class="id">ger0_norm</span> // <span class="id">ltr_pdivr_mulr</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrA</span> <span class="id">mulVf</span> ?<span class="id">lt0r_neq0</span> // <span class="id">mulr1</span> [<span class="id">ltRHS</span>]<span class="id">splitr</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">ltr_addl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_unique</span> (<span class="id">V</span> <span class="id"><a href="mathcomp.analysis.landau.html#eqoP">W</a></span> : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">W</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">df</span> : {<span class="id">linear</span> <span class="id">V</span> -&gt; <span class="id">W</span>}) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> <span class="id">df</span> -&gt; <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">x</a></span>) + <span class="id">df</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> = <span class="id">df</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">W</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">move</span>=&gt; <span class="id">dfc</span> <span class="id">dxf</span>; <span class="id">apply</span>/<span class="id">subr0_eq</span>; <span class="id">rewrite</span> -[<span class="id">LHS</span>]/(<span class="id">_</span> \- <span class="id">_</span>).<br/>
<span class="id">apply</span>/<span class="id">littleo_linear0</span>/<span class="id">eqoP</span>/<span class="id">eq_some_oP</span> =&gt; /=; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="id">have</span> <span class="id">hdf</span> <span class="id">h</span> :<br/>
&nbsp;&nbsp;(<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>) + <span class="id">h</span> +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">h</span> = <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> - <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">cst</a></span> (<span class="id">f</span> <span class="id">x</span>) +<span class="id">o_</span> (0 : <span class="id">V</span>) <span class="id">id</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">hdf</span>; <span class="id">apply</span>: <span class="id">eqaddoE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hdf</span> <span class="id">addrAC</span> (<span class="id">addrC</span> <span class="id">_</span> <span class="id">h</span>) <span class="id">addrK</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="id">LHS</span>]<span class="id">addr0</span> -<span class="id">addrA</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_sym</span> <span class="id">addrC</span> <span class="id">addr_eq0</span> <span class="id">oppo</span>.<br/>
<span class="id">rewrite</span> (<span class="id">hdf</span> <span class="id">_</span> <span class="id">dxf</span>).<br/>
<span class="id">suff</span> /<span class="id">diff_locally</span> /<span class="id">hdf</span> -&gt; : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">opprD</span> <span class="id">addrCA</span> -(<span class="id">addrA</span> (<span class="id">_</span> - <span class="id">_</span>)) <span class="id">addKr</span> <span class="id">oppox</span> <span class="id">addox</span>.<br/>
<span class="id">apply</span>/<span class="id">diffP</span>; <span class="id">apply</span>: (@<span class="id">getPex</span> <span class="id">_</span> (<span class="kwd">fun</span> (<span class="id">df</span> : {<span class="id">linear</span> <span class="id">V</span> -&gt; <span class="id">W</span>}) =&gt; <span class="id">continuous</span> <span class="id">df</span> /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">y</span> = <span class="id">f</span> (<span class="id">lim</span> <span class="id">x</span>) + <span class="id">df</span> (<span class="id">y</span> - <span class="id">lim</span> <span class="id">x</span>) +<span class="id">o_</span>(<span class="id">y</span> \<span class="id">near</span> <span class="id">x</span>) (<span class="id">y</span> - <span class="id">lim</span> <span class="id">x</span>))).<br/>
<span class="kwd">exists</span> <span class="id">df</span>; <span class="id">split</span>=&gt; //; <span class="id">apply</span>: <span class="id">eqaddoEx</span> =&gt; <span class="id">z</span>.<br/>
<span class="id">rewrite</span> (<span class="id">hdf</span> <span class="id">_</span> <span class="id">dxf</span>) !<span class="id">addrA</span> <span class="id"><a name="diff_cst">lim_id</a></span> // /(<span class="id">_</span> \<span class="id">o</span> <span class="id">_</span>) /= <span class="id">subrK</span> [<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">f</a></span> <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrC</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">addrK</a></span>.<br/>
<span class="id">rewrite</span> -<span class="id">addrA</span> -[<span class="id">LHS</span>]<span class="id">addr0</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_sym</span> <span class="id">addrC</span> <span class="id">addr_eq0</span> <span class="id"><a name="DifferentialR3_numFieldType.V">oppox</a></span>; <span class="id">apply</span>/<span class="id">eqP</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">littleo_center0</span> (<span class="id">comp_centerK</span> <span class="id">x</span> <span class="id">id</span>) -[- <span class="id">_</span> <span class="kwd">in</span> <span class="id">RHS</span>](<span class="id">comp_centerK</span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_cst</span> (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>) <span class="id">a</span> <span class="id">x</span> : ('<span class="id">d</span> (<span class="id">cst</span> <span class="id">a</span>) <span class="id"><a href="mathcomp.analysis.derive.html#diff_cst">x</a></span> : <span class="id">V</span> -&gt; <span class="id">W</span>) = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dcst</span> <span class="id">a</span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="kwd">Variables</span> (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.derive.html#DiffDef">differentiable_cst</a></span> (<span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">a</span> : <span class="id">W</span>') (<span class="id">x</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> (<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.W">cst</a></span> <span class="id">a</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diff_cst</span>; <span class="id">have</span> := <span class="id">dcst</span> <span class="id">a</span> <span class="id">x</span>. Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_cst</span> (<span class="id">a</span> : <span class="id">W</span>) (<span class="id">x</span> : <span class="id">V</span>) : <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">cst</span> <span class="id">a</span>) 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="id">exact</span>: <span class="id">DiffDef</span> (<span class="id">differentiable_cst</span> <span class="id">_</span> <span class="id">_</span>) (<span class="id">diff_cst</span> <span class="id">_</span> <span class="id">_</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffD</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span> = '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> \+ '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">W</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dadd</span> <span class="id">df</span> <span class="id">dg</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableD</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_val">diffD</a></span> //; <span class="id">have</span> := <span class="id">dadd</span> <span class="id">df</span> <span class="id">dg</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffD</span> (<span class="id">f</span> <span class="id">g</span> <span class="id">df</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">dg</a></span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">x</a></span> <span class="id">g</span> <span class="id">dg</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">f</span> + <span class="id">g</span>) (<span class="id">df</span> + <span class="id">dg</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>; <span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">differentiableD</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diffD</span> // !<span class="id">diff_val</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_sum</span> <span class="id">n</span> (<span class="id">f</span> : '<span class="id">I_n</span> -&gt; <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">x</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.W">i</a></span>, <span class="id">differentiable</span> (<span class="id">f</span> <span class="id">i</span>) <span class="id">x</span>) -&gt; <span class="id">differentiable</span> (\<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">f</span> <span class="id">i</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_ind</span> : <span class="id">_</span> =&gt; // ? ? <span class="id">g</span> <span class="id">h</span> ?; <span class="id">apply</span>: <span class="id">differentiableD</span>; [<span class="id">exact</span>:<span class="id">g</span>|<span class="id">exact</span>:<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.W">h</a></span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffN</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; '<span class="id">d</span> (- <span class="id">f</span>) <span class="id">x</span> = - ('<span class="id">d</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_locallyP">f</a></span> <span class="id">x</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) :&gt; (<span class="id">V</span> -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#diffN">W</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
<span class="id">move</span>=&gt; <span class="id"><a href="mathcomp.analysis.derive.html#dopp">df</a></span>; <span class="id">rewrite</span> -[<span class="id">RHS</span>]/(@<span class="id">GRing.opp</span> <span class="id"><a name="is_diffN">_</a></span> \<span class="id">o</span> <span class="id">_</span>); <span class="id">apply</span>/<span class="id">diff_unique</span>;<br/>
<span class="kwd">by</span> <span class="id">have</span> [] := <span class="id">dopp</span> <span class="id">df</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableN</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (- <span class="id">f</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diffN</span> //; <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">dopp</a></span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.W">df</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffN</span> (<span class="id">f</span> <span class="id">df</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (- <span class="id">f</span>) (- <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">differentiableN</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diffN</span> // <span class="id">diff_val</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffB</span> (<span class="id">f</span> <span class="id">g</span> <span class="id">df</span> <span class="id">dg</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> <span class="id">g</span> <span class="id">dg</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">f</span> - <span class="id">g</span>) (<span class="id">df</span> - <span class="id">dg</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>; <span class="id">apply</span>: <span class="id">is_diff_eq</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">diffB</a></span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">x</a></span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="id">f</span> - <span class="id">g</span>) <span class="id">x</span> = '<span class="id"><a href="mathcomp.analysis.derive.html#differentiableP">d</a></span> <span class="id">f</span> <span class="id">x</span> \- '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> :&gt; (<span class="id"><a href="mathcomp.analysis.derive.html#differentiableP">V</a></span> -&gt; <span class="id">W</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">df</a></span> /<span class="id">differentiableP</span> <span class="id">dg</span>; <span class="id">rewrite</span> <span class="id">diff_val</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableB</span> (<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">f</a></span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="id">f</span> \- <span class="id"><a name="differentiableZ">g</a></span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span> <span class="id">df</span> /<span class="id">differentiableP</span> <span class="id">dg</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffZ</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">k</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; '<span class="id">d</span> (<span class="id">k</span> *: <span class="id">f</span>) <span class="id">x</span> = <span class="id">k</span> \*: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">W</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dscale</span> <span class="id">k</span> <span class="id">df</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableZ</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">k</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="id"><a href="mathcomp.analysis.derive.html#differentiableZ">k</a></span> *: <span class="id">f</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id"><a href="mathcomp.analysis.derive.html#diffZ">df</a></span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diffZ</span> //; <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">have</a></span> := <span class="id">dscale</span> <span class="id">k</span> <span class="id">df</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffZ</span> (<span class="id">f</span> <span class="id">df</span> : <span class="id">V</span> -&gt; <span class="id">W</span>) <span class="id">k</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">k</span> *: <span class="id">f</span>) (<span class="id">k</span> *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">differentiableZ</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diffZ</span> // <span class="id">diff_val</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffZl</span> (<span class="id">k</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) (<span class="id">f</span> : <span class="id">W</span>) <span class="id">x</span> : <span class="id">differentiable</span> <span class="id">k</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">k</span> <span class="id">z</span> *: <span class="id">f</span>) <span class="id">x</span> = (<span class="kwd">fun</span> <span class="id">z</span> =&gt; '<span class="id">d</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">k</a></span> <span class="id">x</span> <span class="id">z</span> *: <span class="id">f</span>) :&gt; (<span class="id">_</span> -&gt; <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">set</span> <span class="id">g</span> := <span class="id">RHS</span>; <span class="id">have</span> <span class="id">glin</span> : <span class="id">linear</span> <span class="id">g</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a</span> <span class="id">u</span> <span class="id">v</span>; <span class="id">rewrite</span> /<span class="id">g</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_locallyP">linearP</a></span> /= <span class="id">scalerDl</span> -<span class="id">scalerA</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>:(@<span class="id">diff_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">Linear</span> <span class="id">glin</span>)); <span class="id">have</span> [] := <span class="id">dscalel</span> <span class="id">f</span> <span class="id">df</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableZl</span> (<span class="id">k</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) (<span class="id">f</span> : <span class="id">W</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">k</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">k</span> <span class="id">z</span> *: <span class="id">f</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diffZl</span> //; <span class="id">have</span> [] := <span class="id">dscalel</span> <span class="id">f</span> <span class="id">df</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_lin</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">R</a></span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span>' -&gt; <span class="id">W</span>'}) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> <span class="id">f</span> -&gt; '<span class="id"><a href="mathcomp.analysis.derive.html#diff_locallyP">d</a></span> <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> :&gt; (<span class="id">V</span>' -&gt; <span class="id">W</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fcont</span>; <span class="id">apply</span>/<span class="id">diff_unique</span> =&gt; //; <span class="id">apply</span>: <span class="id">dlin</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">linear_differentiable</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span>' -&gt; <span class="id">W</span>'})<br/>
&nbsp;&nbsp;<span class="id">x</span> : <span class="id">continuous</span> <span class="id">f</span> -&gt; <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fcont</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diff_lin</span> //; <span class="id">have</span> := <span class="id">dlin</span> <span class="id">x</span> <span class="id">fcont</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_id</span> (<span class="id">x</span> : <span class="id">V</span>) : <span class="id">is_diff</span> <span class="id">x</span> <span class="id">id</span> <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
<span class="id">apply</span>: <span class="id">DiffDef</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: (@<span class="id">linear_differentiable</span> <span class="id">_</span> <span class="id">_</span> [<span class="id">linear</span> <span class="id">of</span> <span class="id">idfun</span>]) =&gt; ? //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (@<span class="id">diff_lin</span> <span class="id">_</span> <span class="id">_</span> [<span class="id">linear</span> <span class="id">of</span> <span class="id">idfun</span>]) // =&gt; ? //.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_scaler</span> (<span class="id">k</span> : <span class="id">R</span>) (<span class="id">x</span> : <span class="id">V</span>) : <span class="id">is_diff</span> <span class="id">x</span> ( *:%<span class="id">R</span> <span class="id">k</span>) ( *:%<span class="id">R</span> <span class="id">k</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
<span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>/<span class="id">linear_differentiable</span>/<span class="id">scaler_continuous</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diff_lin</span> //; <span class="id">apply</span>: <span class="id">scaler_continuous</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_scalel</span> (<span class="id">k</span> : <span class="id">R</span>) (<span class="id">x</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">k</span> ( *:%<span class="id">R</span> ^~ <span class="id">x</span>) ( *:%<span class="id">R</span> ^~ <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
<span class="id">have</span> <span class="id">sx_lin</span> : <span class="id">linear</span> ( *:%<span class="id">R</span> ^~ <span class="id">x</span>) <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">u</span> <span class="id">y</span> <span class="id">z</span>; <span class="id">rewrite</span> <span class="id">scalerDl</span> <span class="id">scalerA</span>.<br/>
<span class="id"><a href="mathcomp.analysis.derive.html#differentiable">have</a></span> -&gt; : *:%<span class="id">R</span> ^~ <span class="id">x</span> = <span class="id">Linear</span> <span class="id">sx_lin</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span>.<br/>
<span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>/<span class="id">linear_differentiable</span>/<span class="id">scalel_continuous</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diff_lin</span>//; <span class="id">apply</span>: <span class="id">scalel_continuous</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_coord</span> <span class="id">m</span> <span class="id">n</span> (<span class="id">M</span> : '<span class="id">M</span>[<span class="id">R</span>]<span class="id">_</span>(<span class="id">m</span>.+1, <span class="id">n</span>.+1)) <span class="id">i</span> <span class="id">j</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> (<span class="kwd">fun</span> <span class="id">N</span> : '<span class="id">M</span>[<span class="id">R</span>]<span class="id">_</span>(<span class="id">m</span>.+1, <span class="id">n</span>.+1) =&gt; <span class="id">N</span> <span class="id">i</span> <span class="id">j</span> : <span class="id">R</span> ) <span class="id">M</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">have</a></span> @<span class="id">f</span> : {<span class="id">linear</span> '<span class="id">M</span>[<span class="id">R</span>]<span class="id">_</span>(<span class="id">m</span>.+1, <span class="id">n</span>.+1) -&gt; <span class="id">R</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">N</span> : '<span class="id">M</span>[<span class="id">R</span>]<span class="id">_</span>(<span class="id">_</span>, <span class="id">_</span>) =&gt; <span class="id">N</span> <span class="id">i</span> <span class="id">j</span>); <span class="id">eexists</span>; <span class="id">move</span>=&gt; ? ?; <span class="id">rewrite</span> !<span class="id">mxE</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">f</span>) //; <span class="id">exact</span>/<span class="id">linear_differentiable</span>/<span class="id">coord_continuous</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">linear_lipschitz</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span>' -&gt; <span class="id">W</span>'}) :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> <span class="id">f</span> -&gt; <span class="kwd">exists2</span> <span class="id">k</span>, <span class="id">k</span> &gt; 0 &amp; <span class="kwd">forall</span> <span class="id">x</span>, `|<span class="id">f</span> <span class="id">x</span>| &lt;= <span class="id">k</span> * `|<span class="id">x</span>|.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
<span class="id">move</span>=&gt; /(<span class="id">_</span> 0); <span class="id">rewrite</span> <span class="id">linear0</span> =&gt; /(<span class="id">_</span> <span class="id">_</span> (<span class="id">nbhsx_ballx</span> 0 1%:<span class="id">pos</span>)).<br/>
<span class="id">move</span>=&gt; /<span class="id">nbhs_ballP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>] <span class="id">he</span>]; <span class="kwd">exists</span> (2 / <span class="id">e</span>%:<span class="id">num</span>) =&gt; // <span class="id">x</span>.<br/>
<span class="id">have</span> [|<span class="id">xn0</span>] := <span class="id">real_le0P</span> (<span class="id">normr_real</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_le0</span> =&gt; /<span class="id">eqP</span>-&gt;; <span class="id">rewrite</span> <span class="id">linear0</span> !<span class="id">normr0</span> <span class="id">mulr0</span>.<br/>
<span class="id">set</span> <span class="id">k</span> := 2 / <span class="id">e</span>%:<span class="id">num</span> * (<span class="id">PosNum</span> <span class="id">xn0</span>)%:<span class="id">num</span>.<br/>
<span class="id">have</span> <span class="id">kn0</span> : <span class="id">k</span> != 0 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">k</span>.<br/>
<span class="id">have</span> <span class="id">abskgt0</span> : `|<span class="id">k</span>| &gt; 0 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_gt0</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">x</span> <span class="kwd">in</span> <span class="id">leLHS</span>](<span class="id">scalerKV</span> <span class="id">kn0</span>) <span class="id">linearZZ</span> <span class="id">normrZ</span> -<span class="id">ler_pdivl_mull</span> //.<br/>
<span class="id">suff</span> /<span class="id">he</span> : <span class="id">ball</span> 0 <span class="id">e</span>%:<span class="id">num</span> (<span class="id">k</span>^-1 *: <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span> =&gt; /<span class="id">ltW</span> /<span class="id">le_trans</span>; <span class="id">apply</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ger0_norm</span> /<span class="id">k</span> // <span class="id">mulVf</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> <span class="id">normfV</span> <span class="id">ger0_norm</span> /<span class="id">k</span> // <span class="id">invrM</span> ?<span class="id">unitfE</span> // <span class="id">mulrAC</span> <span class="id">mulVf</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invf_div</span> <span class="id">mul1r</span> [<span class="id"><a href="mathcomp.analysis.topology.html#filterE">ltRHS</a></span>]<span class="id">splitr</span>; <span class="id">apply</span>: <span class="id"><a name="diff_eqO">ltr_spaddr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">linear_eqO</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">linear</span> <span class="id">V</span>' -&gt; <span class="id">W</span>'}) :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> <span class="id">f</span> -&gt; (<span class="id">f</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') =<span class="id">O_</span> (0 : <span class="id">V</span>') <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
<span class="id">move</span>=&gt; /<span class="id">linear_lipschitz</span> [<span class="id">k</span> <span class="id">kgt0</span> <span class="id">flip</span>]; <span class="id">apply</span>/<span class="id">eqO_exP</span>; <span class="kwd">exists</span> <span class="id">k</span> =&gt; //.<br/>
<span class="id">exact</span>: <span class="id">filterE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_eqO</span> (<span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">x</span> : <span class="id">filter_on</span> <span class="id">V</span>') (<span class="id">f</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') =<span class="id">O_</span> (0 : <span class="id">V</span>') <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">diff_continuous</span> /<span class="id">linear_eqO</span>; <span class="id">apply</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">compOo_eqox</span> (<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">U</a></span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') : <span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;[<span class="id">O_</span> (0 : <span class="id">V</span>') <span class="id">id</span> <span class="id"><a href="mathcomp.analysis.topology.html#continuous">of</a></span> <span class="id">g</span>] ([<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>] <span class="id">x</span>) =<span class="id">o_</span>(<span class="id">x</span> \<span class="id">near</span> 0 : <span class="id">U</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> -[<span class="id">LHS</span>]/((<span class="id">_</span> \<span class="id">o</span> <span class="id">_</span>) <span class="id">x</span>) <span class="id">compOo_eqo</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dcomp</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>') (<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> ('<span class="id">d</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) \<span class="id">o</span> '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>) /\ <span class="kwd">forall</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">g</span> (<span class="id">f</span> (<span class="id">y</span> + <span class="id">x</span>)) = <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) + ('<span class="id">d</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) \<span class="id">o</span> '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span>) <span class="id">y</span> +<span class="id">o_</span>(<span class="id">y</span> \<span class="id"><a href="mathcomp.analysis.derive.html#diff_eqO">near</a></span> 0 : <span class="id">U</span>) <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id"><a href="mathcomp.analysis.landau.html#addOx">dg</a></span>; <span class="id">split</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id"><a href="mathcomp.analysis.landau.html#addox">apply</a></span>: <span class="id">continuous_comp</span>.<br/>
<span class="id">apply</span>: <span class="id">eqaddoEx</span> =&gt; <span class="id">y</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">diff_locallyx</a></span>// -<span class="id">addrA</span> <span class="id">diff_locallyxC</span>// <span class="id">linearD</span>.<br/>
<span class="id">rewrite</span> <span class="id">addrA</span> -<span class="id">addrA</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">diff_eqO</span> // ['<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">_</span> -&gt; <span class="id">_</span>]<span class="id">diff_eqO</span> //.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> {2}<span class="id">eqoO</span> <span class="id">addOx</span> <span class="id">compOo_eqox</span> <span class="id">compoO_eqox</span> <span class="id">addox</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_comp</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>') (<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;'<span class="id"><a href="mathcomp.analysis.derive.html#differentiable">d</a></span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) <span class="id">x</span> = '<span class="id">d</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) \<span class="id">o</span> '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> :&gt; (<span class="id">U</span> -&gt; <span class="id">W</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">diff_unique</span>; <span class="id">have</span> [? /<span class="id">funext</span>] := <span class="id">dcomp</span> <span class="id">df</span> <span class="id">dg</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_comp</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') <span class="id">x</span> : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diff_comp</span> //;<br/>
<span class="kwd">by</span> <span class="id">have</span> [? /<span class="id">funext</span>]:= <span class="id">dcomp</span> <span class="id">df</span> <span class="id">dg</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_comp</span> (<span class="id">U</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_val">V</a></span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id"><a name="bilinear_schwarz">R</a></span>) (<span class="id">f</span> <span class="id">df</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> <span class="id">dg</span> : <span class="id">V</span>' -&gt; <span class="id">W</span>') <span class="id">x</span> : <span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">g</span> <span class="id">dg</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> (<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>) (<span class="id">dg</span> \<span class="id">o</span> <span class="id">df</span>) | 99.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgfx</span>; <span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">differentiable_comp</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.forms.html#linear0r">diff_comp</a></span> // !<span class="id">diff_val</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">bilinear_schwarz</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> : {<span class="id">bilinear</span> <span class="id">U</span> -&gt; <span class="id">V</span>' -&gt; <span class="id">W</span>'}) : <span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists2</span> <span class="id">k</span>, <span class="id">k</span> &gt; 0 &amp; <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>, `|<span class="id">f</span> <span class="id">u</span> <span class="id">v</span>| &lt;= <span class="id">k</span> * `|<span class="id"><a href="mathcomp.analysis.forms.html#linear0l">u</a></span>| * `|<span class="id">v</span>|.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
<span class="id">move</span>=&gt; /(<span class="id">_</span> 0); <span class="id">rewrite</span> <span class="id">linear0r</span> =&gt; /(<span class="id">_</span> <span class="id">_</span> (<span class="id">nbhsx_ballx</span> 0 1%:<span class="id">pos</span>)).<br/>
<span class="id">move</span>=&gt; /<span class="id">nbhs_ballP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>] <span class="id">he</span>]; <span class="kwd">exists</span> ((2 / <span class="id">e</span>%:<span class="id">num</span>) ^+2) =&gt; // <span class="id"><a href="mathcomp.analysis.signed.html#PosNum">u</a></span> <span class="id">v</span>.<br/>
<span class="id">have</span> [|<span class="id">un0</span>] := <span class="id">real_le0P</span> (<span class="id">normr_real</span> <span class="id">u</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_le0</span> =&gt; /<span class="id">eqP</span>-&gt;; <span class="id">rewrite</span> <span class="id">linear0l</span> !<span class="id">normr0</span> <span class="id">mulr0</span> <span class="id">mul0r</span>.<br/>
<span class="id">have</span> [|<span class="id">vn0</span>] := <span class="id">real_le0P</span> (<span class="id">normr_real</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr_le0</span> =&gt; /<span class="id">eqP</span>-&gt;; <span class="id">rewrite</span> <span class="id">linear0r</span> !<span class="id">normr0</span> <span class="id">mulr0</span>.<br/>
<span class="id">rewrite</span> -[`|<span class="id">u</span>|]/((<span class="id">PosNum</span> <span class="id">un0</span>)%:<span class="id">num</span>) -[`|<span class="id">v</span>|]/((<span class="id">PosNum</span> <span class="id">vn0</span>)%:<span class="id"><a href="mathcomp.analysis.forms.html#linearZr_LR">num</a></span>).<br/>
<span class="id">set</span> <span class="id">ku</span> := 2 / <span class="id">e</span>%:<span class="id">num</span> * (<span class="id">PosNum</span> <span class="id">un0</span>)%:<span class="id">num</span>.<br/>
<span class="id">set</span> <span class="id">kv</span> := 2 / <span class="id">e</span>%:<span class="id">num</span> * (<span class="id"><a href="mathcomp.analysis.topology.html#ball">PosNum</a></span> <span class="id">vn0</span>)%:<span class="id">num</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">f</span> <span class="id">X</span>](@<span class="id">scalerKV</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ku</span>) /<span class="id">ku</span> // <span class="id">linearZl_LR</span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> <span class="id">gtr0_norm</span> // -<span class="id">ler_pdivl_mull</span> //.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">f</span> <span class="id">_</span> <span class="id">X</span>](@<span class="id">scalerKV</span> <span class="id">_</span> <span class="id">_</span> <span class="id">kv</span>) /<span class="id">kv</span> // <span class="id">linearZr_LR</span> <span class="id">normrZ</span>.<br/>
<span class="id">rewrite</span> <span class="id">gtr0_norm</span> // -<span class="id">ler_pdivl_mull</span> //.<br/>
<span class="id">suff</span> /<span class="id">he</span> : <span class="id">ball</span> 0 <span class="id">e</span>%:<span class="id">num</span> (<span class="id">ku</span>^-1 *: <span class="id">u</span>, <span class="id">kv</span>^-1 *: <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span> =&gt; /<span class="id">ltW</span> /<span class="id">le_trans</span>; <span class="id">apply</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ler_pdivl_mull</span> 1?<span class="id">pmulr_lgt0</span>// <span class="id">mulr1</span> <span class="id">ler_pdivl_mull</span> 1?<span class="id">pmulr_lgt0</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrA</span> [<span class="id">ku</span> * <span class="id">_</span>]<span class="id">mulrAC</span> <span class="id">expr2</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ball_normE</span> /= <span class="id">distrC</span> <span class="id">subr0</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="id">ku</span>^-1 *: <span class="id">u</span>, <span class="id">kv</span>^-1 *: <span class="id">v</span>) =<br/>
&nbsp;&nbsp;(<span class="id">e</span>%:<span class="id">num</span> / 2) *: ((<span class="id">PosNum</span> <span class="id">un0</span>)%:<span class="id">num</span> ^-1 *: <span class="id">u</span>, (<span class="id">PosNum</span> <span class="id">vn0</span>)%:<span class="id">num</span> ^-1 *: <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">invrM</span> ?<span class="id">unitfE</span> // [<span class="id">kv</span> ^-1]<span class="id">invrM</span> ?<span class="id">unitfE</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulrC</span> -[<span class="id">_</span> *: <span class="id">u</span>]<span class="id">scalerA</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">X</a></span> *: <span class="id">v</span>]<span class="id">mulrC</span> -[<span class="id">_</span> *: <span class="id">v</span>]<span class="id">scalerA</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invf_div</span>.<br/>
<span class="id">rewrite</span> <span class="id">normrZ</span> <span class="id">ger0_norm</span> // -<span class="id">mulrA</span> <span class="id">gtr_pmulr</span> // <span class="id">ltr_pdivr_mull</span> // <span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">prod_normE</span>/= !<span class="id">normrZ</span> !<span class="id">normfV</span> !<span class="id">normr_id</span> !<span class="id">mulVf</span> ?<span class="id">gt_eqF</span>// <span class="id">maxxx</span> <span class="id">ltr1n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">bilinear_eqo</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">bilinear</span> <span class="id">U</span> -&gt; <span class="id">V</span>' -&gt; <span class="id">W</span>'}) :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) -&gt; (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) =<span class="id">o_</span> (0 : <span class="id">U</span> * <span class="id">V</span>') <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
<span class="id">move</span>=&gt; <span class="id">fc</span>; <span class="id">have</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">k</span>] <span class="id">fschwarz</span>] := <span class="id">bilinear_schwarz</span> <span class="id">fc</span>.<br/>
<span class="id">apply</span>/<span class="id">eqoP</span>=&gt; <span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>]; <span class="id">near</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">fschwarz</span> <span class="id">_</span> <span class="id">_</span>))//.<br/>
<span class="id">rewrite</span> <span class="id">ler_pmul</span> ?<span class="id">pmulr_rge0</span> //; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">num_le_maxr</span> /= <span class="id">lexx</span> <span class="id">orbT</span>.<br/>
<span class="id">rewrite</span> -<span class="id">ler_pdivl_mull</span> //.<br/>
<span class="id">suff</span> : `|<span class="id">x</span>| &lt;= <span class="id">k</span>%:<span class="id">num</span> ^-1 * <span class="id">e</span>%:<span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">num</a></span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">le_trans</a></span>; <span class="id">rewrite</span> <span class="id">num_le_maxr</span> /= <span class="id">lexx</span>.<br/>
<span class="id">near</span>: <span class="id">x</span>; <span class="id">rewrite</span> !<span class="id">near_simpl</span>; <span class="id">apply</span>/<span class="id">nbhs_le_nbhs_norm</span>.<br/>
<span class="kwd">by</span> <span class="kwd">exists</span> (<span class="id">k</span>%:<span class="id">num</span> ^-1 * <span class="id">e</span>%:<span class="id">num</span>) =&gt; //= ? /=; <span class="id">rewrite</span> /= <span class="id">distrC</span> <span class="id">subr0</span> =&gt; /<span class="id">ltW</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dbilin</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">bilinear</span> <span class="id">U</span> -&gt; <span class="id">V</span>' -&gt; <span class="id">W</span>'}) <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) -&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">q</span> =&gt; (<span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2 + <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2)) /\<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">q</span>.1 <span class="id">q</span>.2) \<span class="id">o</span> <span class="id"><a href="mathcomp.analysis.signed.html#posnumP">shift</a></span> <span class="id">p</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2 + <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2) +<span class="id">o_</span> (0 : <span class="id">U</span> * <span class="id">V</span>') <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
<span class="id">move</span>=&gt; <span class="id">fc</span>; <span class="id">split</span>=&gt; [<span class="id">q</span>|].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">apply</a></span>: (@<span class="id">continuousD</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2) (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">A</span> /(<span class="id">fc</span> (<span class="id">_</span>.1, <span class="id">_</span>.2)) /= /<span class="id">nbhs_ballP</span> [<span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>] <span class="id">fpqe_A</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">nbhs_ballP</span>; <span class="kwd">exists</span> <span class="id">e</span>%:<span class="id">num</span> =&gt; //= <span class="id">r</span> [? ?]; <span class="id">exact</span>: (<span class="id">fpqe_A</span> (<span class="id">_</span>.1, <span class="id">_</span>.2)).<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">q</a></span> /=.<br/>
<span class="id">rewrite</span> <span class="id">linearDl</span> !<span class="id">linearDr</span> <span class="id">addrA</span> <span class="id">addrC</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">f</span> <span class="id">q</span>.1 <span class="id">_</span> + <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrA</span> [<span class="id">f</span> <span class="id">q</span>.1 <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrC</span> <span class="id">addrA</span> [<span class="id">f</span> <span class="id">q</span>.1 <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrC</span>.<br/>
<span class="kwd">by</span> <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>); <span class="id">rewrite</span> -[<span class="id">LHS</span>]/((<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) <span class="id">q</span>) <span class="id">bilinear_eqo</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_bilin</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : {<span class="id">bilinear</span> <span class="id">U</span> -&gt; <span class="id">V</span>' -&gt; <span class="id">W</span>'}) <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) -&gt; '<span class="id">d</span> (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">q</span>.1 <span class="id">q</span>.2) <span class="id">p</span> =<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2 + <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2) :&gt; (<span class="id">U</span> * <span class="id">V</span>' -&gt; <span class="id">W</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
<span class="id">move</span>=&gt; <span class="id">fc</span>; <span class="id">have</span> <span class="id">lind</span> : <span class="id">linear</span> (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2 + <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; ???; <span class="id">rewrite</span> <span class="id">linearPr</span> <span class="id">linearPl</span> <span class="id">scalerDr</span> <span class="id">addrACA</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">q</span>.2 + <span class="id">f</span> <span class="id">q</span>.1 <span class="id">p</span>.2) = <span class="id">Linear</span> <span class="id">lind</span> <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dbilin</span> <span class="id">p</span> <span class="id">fc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_bilin</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> : {<span class="id">bilinear</span> <span class="id">U</span> -&gt; <span class="id">V</span>' -&gt; <span class="id">W</span>'}) <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) -&gt; <span class="id">differentiable</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">f</span> <span class="id">p</span>.1 <span class="id">p</span>.2) <span class="id">p</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fc</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diff_bilin</span> //; <span class="id">apply</span>: <span class="id">dbilin</span> <span class="id">p</span> <span class="id">fc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">mulr_rev</span> (<span class="id">y</span> <span class="id">x</span> : <span class="id">R</span>) := <span class="id">x</span> * <span class="id">y</span>.<br/>
<span class="kwd">Canonical</span> <span class="id">rev_mulr</span> := @<span class="id">RevOp</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">mulr_rev</span> (@<span class="id">GRing.mul</span> [<span class="id">ringType</span> <span class="id">of</span> <span class="id">R</span>])<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">erefl</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">mulr_is_linear</span> <span class="id">x</span> : <span class="id">linear</span> (@<span class="id">GRing.mul</span> [<span class="id">ringType</span> <span class="id">of</span> <span class="id">R</span>] <span class="id">x</span> : <span class="id">R</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ???; <span class="id">rewrite</span> <span class="id">mulrDr</span> <span class="id">scalerAr</span>. Qed.</div>
<span class="kwd">Canonical</span> <span class="id">mulr_linear</span> <span class="id">x</span> := <span class="id">Linear</span> (<span class="id">mulr_is_linear</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">mulr_rev_is_linear</span> <span class="id">y</span> : <span class="id">linear</span> (<span class="id">mulr_rev</span> <span class="id">y</span> : <span class="id">R</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ???; <span class="id">rewrite</span> /<span class="id">mulr_rev</span> <span class="id">mulrDl</span> <span class="id">scalerAl</span>. Qed.</div>
<span class="kwd">Canonical</span> <span class="id">mulr_rev_linear</span> <span class="id">y</span> := <span class="id">Linear</span> (<span class="id">mulr_rev_is_linear</span> <span class="id">y</span>).<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id">mulr_bilinear</span> :=<br/>
&nbsp;&nbsp;[<span class="id">bilinear</span> <span class="id">of</span> @<span class="id">GRing.mul</span> [<span class="id">ringType</span> <span class="id">of</span> [<span class="id">lmodType</span> <span class="id">R</span> <span class="id">of</span> <span class="id">R</span>]]].<br/>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_mulr</span> (<span class="id">p</span> : <span class="id">R</span> * <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">p</span> (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">q</span>.1 * <span class="id">q</span>.2) (<span class="kwd">fun</span> <span class="id">q</span> =&gt; <span class="id">p</span>.1 * <span class="id">q</span>.2 + <span class="id">q</span>.1 * <span class="id">p</span>.2).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
<span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diff_bilin</span> // =&gt; ?; <span class="id">apply</span>: <span class="id">mul_continuous</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">differentiable_bilin</span> =&gt;?; <span class="id">apply</span>: <span class="id">mul_continuous</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eqo_pair</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">F</span> : <span class="id">filter_on</span> <span class="id">U</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>') (<span class="id">g</span> : <span class="id">U</span> -&gt; <span class="id">W</span>') :<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">t</span> =&gt; ([<span class="id">o_F</span> <span class="id">id</span> <span class="id">of</span> <span class="id">f</span>] <span class="id">t</span>, [<span class="id">o_F</span> <span class="id">id</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">of</a></span> <span class="id">g</span>] <span class="id">t</span>)) =<span class="id">o_F</span> <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
<span class="id">apply</span>/<span class="id">eqoP</span> =&gt; <span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">e</span>]; <span class="id">near</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">num_le_maxl</span> /=.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">andP</span>; <span class="id">split</span>; <span class="id">near</span>: <span class="id">x</span>; <span class="id"><a href="mathcomp.analysis.normedtype.html#shift">apply</a></span>: <span class="id">littleoP</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dpair</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">normedModType</a></span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>') (<span class="id">g</span> : <span class="id">U</span> -&gt; <span class="id">W</span>') <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>)) /\<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">y</span>)) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>, <span class="id">g</span> <span class="id">x</span>) +<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>)) +<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">split</span>=&gt; [?|]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvg_pair</span>; <span class="id">apply</span>: <span class="id">diff_continuous</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span> /=.<br/>
<span class="id">rewrite</span> ![<span class="id">_</span> (<span class="id">_</span> + <span class="id">x</span>)]<span class="id">diff_locallyx</span>//.<br/>
<span class="comment">(*&nbsp;fixme&nbsp;*)</span><br/>
<span class="id">have</span> -&gt; : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">e</span>, (<span class="id">f</span> <span class="id">x</span> + '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> + [<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">h</span>] <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">g</span> <span class="id">x</span> + '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span> + [<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">e</span>] <span class="id">y</span>) =<br/>
&nbsp;&nbsp;(<span class="id">f</span> <span class="id">x</span>, <span class="id">g</span> <span class="id">x</span>) + ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>) +<br/>
&nbsp;&nbsp;([<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">h</span>] <span class="id">y</span>, [<span class="id">o_</span> (0 : <span class="id">U</span>) <span class="id">id</span> <span class="id">of</span> <span class="id">e</span>] <span class="id">y</span>) <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span>); <span class="id">rewrite</span> -[<span class="id">LHS</span>]/((<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">_</span> <span class="id">y</span>, <span class="id">_</span> <span class="id">y</span>)) <span class="id">y</span>) <span class="id">eqo_pair</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_pair</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>') (<span class="id">g</span> : <span class="id">U</span> -&gt; <span class="id">W</span>') <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt; '<span class="id">d</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">y</span>)) <span class="id">x</span> =<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id"><a href="mathcomp.analysis.derive.html#dpair">d</a></span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>)) :&gt; (<span class="id">U</span> -&gt; <span class="id">V</span>' * <span class="id">W</span>').<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>.<br/>
<span class="id">have</span> <span class="id">lin_pair</span> : <span class="id">linear</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; ???; <span class="id">rewrite</span> !<span class="id">linearPZ</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">y</span> =&gt; ('<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>, '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> <span class="id">y</span>)) = <span class="id">Linear</span> <span class="id">lin_pair</span> <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dpair</span> <span class="id">df</span> <span class="id">dg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_pair</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> : <span class="id">U</span> -&gt; <span class="id">W</span>') <span class="id">x</span> : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">y</span>)) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id">diff_pair</span> //; <span class="id"><a href="mathcomp.analysis.derive.html#DiffDef">apply</a></span>: <span class="id">dpair</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diff_pair</span> (<span class="id">U</span> <span class="id">V</span>' <span class="id">W</span>' : <span class="id">normedModType</span> <span class="id">R</span>) (<span class="id">f</span> <span class="id">df</span> : <span class="id">U</span> -&gt; <span class="id">V</span>')<br/>
&nbsp;&nbsp;(<span class="id">g</span> <span class="id">dg</span> : <span class="id">U</span> -&gt; <span class="id">W</span>') <span class="id">x</span> : <span class="id">is_diff</span> <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">f</a></span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> <span class="id">g</span> <span class="id">dg</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">y</span>)) (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">df</span> <span class="id">y</span>, <span class="id">dg</span> <span class="id">y</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>; <span class="id">apply</span>: <span class="id">DiffDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">differentiable_pair</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">diff_pair</span> // !<span class="id">diff_val</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffM</span> (<span class="id">f</span> <span class="id">g</span> <span class="id">df</span> <span class="id">dg</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id"><a name="diffM">df</a></span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> <span class="id">g</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">dg</a></span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">f</span> * <span class="id">g</span>) (<span class="id">f</span> <span class="id">x</span> *: <span class="id">dg</span> + <span class="id">g</span> <span class="id">x</span> *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>.<br/>
<span class="id">have</span> -&gt; : <span class="id">f</span> * <span class="id">g</span> = (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">p</span>.1 * <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">p</a></span>.2) \<span class="id">o</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">y</span>)) <span class="kwd">by</span> [].<br/>
<span class="id">apply</span>: <span class="id">is_diff_eq</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; ?; <span class="id">rewrite</span> /= [<span class="id">_</span> * <span class="id">g</span> <span class="id">_</span>]<span class="id">mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffM</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span> \*: '<span class="id">d</span> <span class="id">g</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span> \*: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span> <span class="id">df</span> /<span class="id">differentiableP</span> <span class="id">dg</span>; <span class="id">rewrite</span> <span class="id">diff_val</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableM</span> (<span class="id"><a name="dinv">f</a></span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> <span class="id">g</span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span> <span class="id">df</span> /<span class="id">differentiableP</span> <span class="id">dg</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">dinv</span> (<span class="id">x</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">x</span> != 0 -&gt; <span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">x</a></span> ^- 2 *: <span class="id">h</span>) /\<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>^-1)%<span class="id">R</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">x</span>^-1)%<span class="id">R</span> +<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - <span class="id">x</span> ^- 2 *: <span class="id">h</span>) +<span class="id">o_</span> (0 : <span class="id">R</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
<span class="id">move</span>=&gt; <span class="id">xn0</span>; <span class="id">suff</span>: <span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - (1 / <span class="id">x</span>) ^+ 2 *: <span class="id">h</span>) /\<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; 1 / <span class="id">x</span> ) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (1 / <span class="id">x</span>) +<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - (1 / <span class="id">x</span>) ^+ 2 *: <span class="id">h</span>) +<span class="id">o_</span> (0 : <span class="id">R</span>) <span class="id">id</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">mul1r</span> !<span class="id">GRing.exprVn</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>^-1) =  (<span class="kwd">fun</span> <span class="id">x</span> =&gt; 1 / <span class="id">x</span> ))//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">y</span>; <span class="id">rewrite</span> <span class="id">mul1r</span>.<br/>
<span class="id">split</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">continuousZr</span>.<br/>
<span class="id">apply</span>/<span class="id">eqaddoP</span> =&gt; <span class="id">_</span> /<span class="id">posnumP</span>[<span class="id">e</span>]; <span class="id">near</span>=&gt; <span class="id">h</span>.<br/>
<span class="id">rewrite</span> -[(<span class="id">_</span> + <span class="id">_</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) <span class="id">h</span>]/(<span class="id">_</span> + <span class="id">_</span>) -[(- <span class="id">_</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) <span class="id">h</span>]/(- <span class="id">_</span>) /=.<br/>
<span class="id">rewrite</span> <span class="id">opprD</span> <span class="id">scaleNr</span> <span class="id">opprK</span> /<span class="id">cst</span> /=.<br/>
<span class="id">rewrite</span> -[- <span class="id">_</span>]<span class="id">mulr1</span> -[<span class="id">X</span> <span class="kwd">in</span> - <span class="id">_</span> * <span class="id">X</span>](<span class="id">mulfVK</span> <span class="id">xn0</span>) <span class="id">mulrA</span> <span class="id">mulNr</span> -<span class="id">expr2</span> <span class="id">mulNr</span>.<br/>
<span class="id">rewrite</span> [- <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrC</span> -<span class="id">mulrBr</span>.<br/>
<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> + <span class="id">_</span>]<span class="id">mulr1</span> -[<span class="id">X</span> <span class="kwd">in</span> 1 / <span class="id">_</span> * <span class="id">X</span>](@<span class="id">mulfVK</span> <span class="id">_</span> (<span class="id">x</span> ^+ 2)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">sqrf_eq0</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrA</span> <span class="id">mulf_div</span> <span class="id">mulr1</span>.<br/>
<span class="id">have</span> <span class="id">hDx_neq0</span> : <span class="id">h</span> + <span class="id">x</span> != 0.<br/>
&nbsp;&nbsp;<span class="id">near</span>: <span class="id">h</span>; <span class="id">rewrite</span> !<span class="id">nbhs_simpl</span>; <span class="id">apply</span>/<span class="id">nbhs_normP</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> `|<span class="id">x</span>|; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">normr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">h</span> /=; <span class="id">rewrite</span> /= <span class="id">distrC</span> <span class="id">subr0</span> -<span class="id">subr_gt0</span> =&gt; <span class="id">lthx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -(<span class="id">normr_gt0</span> (<span class="id">h</span> + <span class="id">x</span>)) <span class="id">addrC</span> -[<span class="id">h</span>]<span class="id">opprK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">lt_le_trans</span> (<span class="id">ler_dist_dist</span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ger0_norm</span> <span class="id">normrN</span> //; <span class="id">apply</span>: <span class="id">ltW</span>.<br/>
<span class="id">rewrite</span> <span class="id">addrC</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> * <span class="id">_</span>]<span class="id">mulr1</span> -{2}[1](@<span class="id">mulfVK</span> <span class="id">_</span> (<span class="id">h</span> + <span class="id">x</span>)) //.<br/>
<span class="id">rewrite</span> <span class="id">mulrA</span> <span class="id">expr_div_n</span> <span class="id">expr1n</span> <span class="id">mulf_div</span> <span class="id">mulr1</span> [<span class="id">_</span> ^+ 2 * <span class="id">_</span>]<span class="id">mulrC</span> -<span class="id">mulrA</span>.<br/>
<span class="id">rewrite</span> -<span class="id">mulrDr</span> <span class="id">mulrBr</span> [1 / <span class="id">_</span> * <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">normrM</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrDl</span> <span class="id">mulrDl</span> <span class="id">opprD</span> <span class="id">addrACA</span> <span class="id">addrA</span> [<span class="id">x</span> * <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">expr2</span>.<br/>
<span class="id">do</span> 2 ?[<span class="id">rewrite</span> -<span class="id">addrA</span> [- <span class="id">_</span> + <span class="id">_</span>]<span class="id">addrC</span> <span class="id">subrr</span> <span class="id">addr0</span>].<br/>
<span class="id">rewrite</span> <span class="id">div1r</span> <span class="id">normfV</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> / <span class="id">X</span>]<span class="id">normrM</span> <span class="id">invfM</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span>]<span class="id">mulrC</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrA</span> <span class="id">mulrAC</span> <span class="id">ler_pdivr_mulr</span> ?<span class="id">normr_gt0</span> ?<span class="id">mulf_neq0</span> //.<br/>
<span class="id">rewrite</span> <span class="id">mulrAC</span> <span class="id">ler_pdivr_mulr</span> ?<span class="id">normr_gt0</span> //.<br/>
<span class="id">have</span> : `|<span class="id">h</span> * <span class="id">h</span>| &lt;= `|<span class="id">x</span> / 2| * (<span class="id">e</span>%:<span class="id">num</span> * `|<span class="id">x</span> * <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leLHS">x</a></span>| * `|<span class="id">h</span>|).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">mulrA</span>; <span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> (`|<span class="id">x</span> / 2| * <span class="id">e</span>%:<span class="id">num</span> * `|<span class="id">x</span> * <span class="id">x</span>|).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /= !<span class="id">pmulr_rgt0</span> // <span class="id">normr_gt0</span> <span class="id">mulf_neq0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">h</span> /<span class="id">ltW</span>; <span class="id">rewrite</span> <span class="id">distrC</span> <span class="id">subr0</span> [`|<span class="id">h</span> * <span class="id">_</span>|]<span class="id">normrM</span> =&gt; /<span class="id">ler_pmul</span>; <span class="id">apply</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id">le_trans</span>-&gt; //; <span class="id">rewrite</span> [<span class="id">leLHS</span>]<span class="id">mulrC</span> <span class="id">ler_pmul</span> ?<span class="id">mulr_ge0</span> //.<br/>
<span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> (`|<span class="id">x</span>| / 2); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">divr_gt0</span> ?<span class="id">normr_gt0</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> /= <span class="id">distrC</span> <span class="id">subr0</span> =&gt; <span class="id">lthhx</span>; <span class="id">rewrite</span> <span class="id">addrC</span> -[<span class="id">h</span>]<span class="id">opprK</span>.<br/>
<span class="id">apply</span>: <span class="id">le_trans</span> (@<span class="id">ler_dist_dist</span>  <span class="id">_</span> <span class="id">R</span>  <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">normrN</span> [<span class="id">leRHS</span>]<span class="id">ger0_norm</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">subr_ge0</span>; <span class="id">apply</span>: <span class="id">ltW</span>; <span class="id">apply</span>: <span class="id">lt_le_trans</span> <span class="id">lthhx</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_pdivr_mulr</span> // -{1}(<span class="id">mulr1</span> `|<span class="id">x</span>|) <span class="id">ler_pmul</span> // <span class="id">ler1n</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">ler_subr_addr</a></span> -<span class="id">ler_subr_addl</span> (<span class="id">splitr</span> `|<span class="id">x</span>|).<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">rewrite</a></span> <span class="id">normrM</span> <span class="id">normfV</span> (@<span class="id">ger0_norm</span> <span class="id">_</span> 2) // -<span class="id">addrA</span> <span class="id">subrr</span> <span class="id">addr0</span>; <span class="id">apply</span>: <span class="id">ltW</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_Rinv</span> (<span class="id">x</span> : <span class="id">R</span>) : <span class="id">x</span> != 0 -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> <span class="id">GRing.inv</span> <span class="id">x</span> = (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - <span class="id">x</span> ^- 2 *: <span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.R">h</a></span>) :&gt; (<span class="id">R</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
<span class="id">move</span>=&gt; <span class="id">xn0</span>; <span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; - <span class="id">x</span> ^- 2 *: <span class="id">h</span>) =<br/>
&nbsp;&nbsp;<span class="id">GRing.scale_linear</span> <span class="id">_</span> (- <span class="id">x</span> ^- 2) <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">diff_unique</span>; <span class="id">have</span> [] := <span class="id">dinv</span> <span class="id">xn0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiable_Rinv</span> (<span class="id">x</span> : <span class="id">R</span>) : <span class="id">x</span> != 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.derive.html#DifferentialR3_numFieldType.V">differentiable</a></span> (<span class="id">GRing.inv</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_comp">move</a></span>=&gt; <span class="id">xn0</span>; <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_Rinv">diff_Rinv</a></span> //; <span class="id">apply</span>: <span class="id">dinv</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffV</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">x</a></span> : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">f</span> <span class="id">x</span> != 0 -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>)^-1) <span class="id">x</span> = - (<span class="id">f</span> <span class="id">x</span>) ^- 2 \*: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">fxn0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">LHS</span>](<span class="id">diff_comp</span> <span class="id">df</span> (<span class="id">differentiable_Rinv</span> <span class="id">fxn0</span>)) <span class="id">diff_Rinv</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableV</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; <span class="id">f</span> <span class="id">x</span> != 0 -&gt; <span class="id">differentiable</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>)^-1) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">fxn0</span>; <span class="id">apply</span>: <span class="id">differentiable_comp</span> <span class="id">_</span> (<span class="id">differentiable_Rinv</span> <span class="id">fxn0</span>).<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_diffX</span> (<span class="id">f</span> <span class="id">df</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">n</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">is_diff</span> <span class="id">x</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_diff</span> <span class="id">x</span> (<span class="id">f</span> ^+ <span class="id">n</span>.+1) (<span class="id">n</span>.+1%:<span class="id">R</span> * <span class="id">f</span> <span class="id"><a name="differentiableX">x</a></span> ^+ <span class="id">n</span> *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">elim</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> <span class="id">ihn</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expr1</span> <span class="id">expr0</span> <span class="id">mulr1</span> <span class="id">scale1r</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.derive.html#differentiableP">exprS</a></span>; <span class="id">apply</span>: <span class="id">is_diff_eq</span>.<br/>
<span class="id">rewrite</span> <span class="id">scalerA</span> <span class="id">mulrCA</span> -<span class="id">exprS</span> -<span class="id">scalerDl</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="kwd">in</span> <span class="id">LHS</span>]<span class="id">mulr_natl</span> <span class="id">exprfctE</span> -<span class="id">mulrSr</span> <span class="id">mulr_natl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">differentiableX</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">n</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_val">f</a></span> <span class="id">x</span> -&gt; <span class="id">differentiable</span> (<span class="id">f</span> ^+ <span class="id">n</span>.+1) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diffX</span> (<span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">R</span>) <span class="id">n</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">d</span> (<span class="id"><a href="mathcomp.analysis.derive.html#DeriveRU.R">f</a></span> ^+ <span class="id"><a href="mathcomp.analysis.derive.html#DeriveRU.U">n</a></span>.+1) <span class="id">x</span> = <span class="id">n</span>.+1%:<span class="id">R</span> * <span class="id">f</span> <span class="id">x</span> ^+ <span class="id">n</span> \*: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> :&gt; (<span class="id">V</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">differentiableP</span> <span class="id">df</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#id">diff_val</a></span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DifferentialR3_numFieldType</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DeriveRU</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">U</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">U</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">der1</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span> = <span class="id">cst</span> (<span class="id">f</span> <span class="id">x</span>) + ( *:%<span class="id">R</span>^~ (<span class="id"><a href="mathcomp.analysis.derive.html#derivable">f</a></span>^`() <span class="id">x</span>)) +<span class="id">o_</span> (0 : <span class="id">R</span>) <span class="id">id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">eqaddoE</span>; <span class="id">have</span> /<span class="id">derivable_nbhsP</span> := <span class="id">df</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">h</span> =&gt; (<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) <span class="id">h</span>%:<span class="id">A</span>) = <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span>=&gt; ?; <span class="id">rewrite</span> [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive1E</span> =&gt;-&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriv1E</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1 -&gt; '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> = ( *:%<span class="id">R</span>^~ (<span class="id">f</span>^`() <span class="id">x</span>)) :&gt; (<span class="id">R</span> -&gt; <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">have</span> <span class="id">lin_scal</span> : <span class="id">linear</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">h</span> *: <span class="id">f</span>^`() <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; ? ? ?; <span class="id">rewrite</span> <span class="id">scalerDl</span> <span class="id">scalerA</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> *: <span class="id">f</span>^`() <span class="id">x</span>) = <span class="id">Linear</span> <span class="id">lin_scal</span> <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">diff_unique</span>; [<span class="id">apply</span>: <span class="id">scalel_continuous</span>|<span class="id">apply</span>: <span class="id">der1</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff1E</span> <span class="id">f</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span> -&gt; '<span class="id">d</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_unique">f</a></span> <span class="id">x</span> = (<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> *: <span class="id">f</span>^`() <span class="id">x</span>) :&gt; (<span class="id">R</span> -&gt; <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">have</span> <span class="id"><a href="mathcomp.analysis.derive.html#diff_locally">lin_scal</a></span> : <span class="id">linear</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">h</span> *: '<span class="id">d</span> <span class="id">f</span> <span class="id">x</span> 1).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">move</a></span>=&gt; ? ? ?; <span class="id">rewrite</span> <span class="id">scalerDl</span> <span class="id">scalerA</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> *: <span class="id">f</span>^`() <span class="id">x</span>) = <span class="id">Linear</span> <span class="id">lin_scal</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive1E</span>'.<br/>
<span class="id">apply</span>: <span class="id">diff_unique</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">scalel_continuous</span>.<br/>
<span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.derive.html#deriv1E">eqaddoE</a></span>; <span class="id">have</span> /<span class="id">diff_locally</span> -&gt; := <span class="id">df</span>; <span class="id">congr</span> (<span class="id">_</span> + <span class="id">_</span> + <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">h</span> /=; <span class="id">rewrite</span> -{1}[<span class="id">h</span>]<span class="id">mulr1</span> <span class="id">linearZ</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable1_diffP</span> <span class="id">f</span> <span class="id">x</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1 &lt;-&gt; <span class="id">differentiable</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
<span class="id">split</span>=&gt; <span class="id">dfx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">diff_locallyP</span>; <span class="id"><a href="mathcomp.analysis.derive.html#diff1E">rewrite</a></span> <span class="id">deriv1E</span> //; <span class="id">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">apply</span>: <span class="id">scalel_continuous</span>|<span class="id">apply</span>: <span class="id">der1</span>].<br/>
<span class="id">apply</span>/<span class="id">derivable_nbhsP</span>/<span class="id">eqaddoE</span>.<br/>
<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">h</span> =&gt; (<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) <span class="id">h</span>%:<span class="id">A</span>) = <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span>=&gt; ?; <span class="id">rewrite</span> [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">have</span> /<span class="id">diff_locally</span> := <span class="id"><a href="mathcomp.analysis.derive.html#differentiable_continuous">dfx</a></span>; <span class="id">rewrite</span> <span class="id">diff1E</span> // <span class="id">derive1E</span> =&gt;-&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_within_continuous</span> <span class="id">f</span> (<span class="id">i</span> : <span class="id">interval</span> <span class="id">R</span>) :<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">i</span>, <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1} -&gt; {<span class="id">within</span> [<span class="id">set</span>` <span class="id"><a name="DeriveVW.W">i</a></span>], <span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">continuous</a></span> <span class="id">f</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
<span class="id">move</span>=&gt; <span class="id">di</span>; <span class="id">apply</span>/<span class="id">continuous_in_subspaceT</span> =&gt; <span class="id">z</span> /[1!<span class="id">inE</span>] <span class="id">zA</span>.<br/>
<span class="id">apply</span>/<span class="id">differentiable_continuous</span>; <span class="id">rewrite</span> -<span class="id">derivable1_diffP</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">di</span>; <span class="id"><a href="mathcomp.analysis.derive.html#derivable">rewrite</a></span> <span class="id">inE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DeriveRU</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DeriveVW</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">f</span> : <span class="id">V</span> -&gt; <span class="id">W</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable1P</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> &lt;-&gt; <span class="id">derivable</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>)) 0 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
<span class="id">rewrite</span> /<span class="id">derivable</span>; <span class="id">set</span> <span class="id">g1</span> := <span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: <span class="id">_</span>; <span class="id">set</span> <span class="id">g2</span> := <span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: <span class="id">_</span>.<br/>
<span class="id">suff</span> -&gt; : <span class="id"><a href="mathcomp.analysis.derive.html#differentiable">g1</a></span> = <span class="id">g2</span> <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> /<span class="id">g1</span> /<span class="id">g2</span> =&gt; <span class="id">h</span> /=; <span class="id">rewrite</span> <span class="id">addr0</span> <span class="id"><a href="mathcomp.analysis.derive.html#derivable1P">scale0r</a></span> <span class="id">add0r</span> [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableP</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> ('<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">diff_derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span> : <span class="id">differentiable</span> <span class="id">f</span> <span class="id">a</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">a</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
<span class="id">move</span>=&gt; <span class="id">dfa</span>; <span class="id">apply</span>/<span class="id">derivable1P</span>/<span class="id">derivable1_diffP</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">differentiable_comp</span>; <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">rewrite</a></span> ?<span class="id">scale0r</span> ?<span class="id">add0r</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_derive_cst</span> (<span class="id">a</span> : <span class="id">W</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">cst</span> <span class="id">a</span>) 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
<span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveE</span> // <span class="id"><a href="mathcomp.analysis.normedtype.html#NormedModule.Exports.normedModType">diff_val</a></span>.<br/>
<span class="id">exact</span>/<span class="id">diff_derivable</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVW.W">is_derive_eq</a></span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> <span class="id">f</span>' : <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">f</span>' -&gt; <span class="id">f</span>' = <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
 <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#shift">move</a></span>=&gt; ? &lt;-. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DeriveVW</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Derive_lemmasVW</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">V</span> <span class="id">W</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">W</span>.<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">der_add</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (((<span class="id">f</span> + <span class="id">g</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) (<span class="id">h</span> *: <span class="id">v</span>) - (<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span>)) @<br/>
&nbsp;&nbsp;0^'  --&gt; '<span class="id">D_v</span> <span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVW.V">f</a></span> <span class="id">x</span> + '<span class="id">D_v</span> <span class="id">g</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>.<br/>
<span class="id">evar</span> (<span class="id">fg</span> : <span class="id">R</span> -&gt; <span class="id">W</span>); <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = <span class="id">fg</span>) /=; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">scalerDr</span> <span class="id">scalerN</span> <span class="id">scalerDr</span> <span class="id">opprD</span> <span class="id">addrACA</span> -!<span class="id">scalerBr</span> /<span class="id">fg</span>.<br/>
<span class="id"><a href="mathcomp.analysis.derive.html#derivable">exact</a></span>: <span class="id">cvgD</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveD</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span> = '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span> + '<span class="id">D_v</span> <span class="id"><a href="mathcomp.analysis.derive.html#der_add">g</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>: <span class="id">cvg_lim</span> (<span class="id">der_add</span> <span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVW.V">df</a></span> <span class="id">dg</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableD</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">v</a></span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="id">f</span> + <span class="id">g</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> (<span class="id">derive</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> + <span class="id">derive</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span>).<br/>
<span class="id">exact</span>: <span class="id">der_add</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveD</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> <span class="id">dg</span> : <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">g</a></span> <span class="id">dg</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">f</span> + <span class="id">g</span>) (<span class="id">df</span> + <span class="id">dg</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivableD</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveD</span> // !<span class="id">derive_val</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_derive_sum</span> <span class="id">n</span> (<span class="id">h</span> : '<span class="id">I_n</span> -&gt; <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>)<br/>
&nbsp;&nbsp;(<span class="id">dh</span> : '<span class="id">I_n</span> -&gt; <span class="id">W</span>) : (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">h</span> <span class="id">i</span>) (<span class="id">dh</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (\<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">h</span> <span class="id">i</span>) (\<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">dh</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
<span class="kwd">by</span> <span class="id">elim</span>/<span class="id">big_ind2</span> : <span class="id">_</span> =&gt; // [|] *; [<span class="id">exact</span>: <span class="id">is_derive_cst</span>|<span class="id">exact</span>: <span class="id">is_deriveD</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_sum</span> <span class="id">n</span> (<span class="id">h</span> : '<span class="id">I_n</span> -&gt; <span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVW.W">V</a></span> -&gt; <span class="id">W</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">derivable</span> (<span class="id">h</span> <span class="id">i</span>) <span class="id">x</span> <span class="id">v</span>) -&gt; <span class="id">derivable</span> (\<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">h</span> <span class="id">i</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">suff</span> : <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">h</span> <span class="id">i</span>) ('<span class="id"><a href="mathcomp.analysis.derive.html#is_derive">D_v</a></span> (<span class="id">h</span> <span class="id">i</span>) <span class="id">x</span>) <span class="kwd">by</span> [].<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">derivableP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive_sum</span> <span class="id">n</span> (<span class="id">h</span> : '<span class="id">I_n</span> -&gt; <span class="id">V</span> -&gt; <span class="id">W</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">derivable</span> (<span class="id">h</span> <span class="id">i</span>) <span class="id">x</span> <span class="id">v</span>) -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (\<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">h</span> <span class="id">i</span>) <span class="id">x</span> = \<span class="id">sum_</span>(<span class="id">i</span> &lt; <span class="id">n</span>) '<span class="id">D_v</span> (<span class="id">h</span> <span class="id">i</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">suff</span> <span class="id">dfx</span> : <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVW.R">h</a></span> <span class="id">i</span>) ('<span class="id">D_v</span> (<span class="id">h</span> <span class="id">i</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive_val</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">derivableP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">der_opp</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (((- <span class="id">f</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) (<span class="id">h</span> *: <span class="id">v</span>) - (- <span class="id">f</span>) <span class="id">x</span>)) @<br/>
&nbsp;&nbsp;0^' --&gt; - '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">evar</span> (<span class="id">g</span> : <span class="id">R</span> -&gt; <span class="id">W</span>); <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = <span class="id">g</span>) /=; <span class="id"><a name="derivableN">last</a></span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">h</span>; <span class="id">rewrite</span> !<span class="id">scalerDr</span> !<span class="id">scalerN</span> -<span class="id">opprD</span> -<span class="id">scalerBr</span> /<span class="id">g</span>.<br/>
<span class="id">exact</span>: <span class="id">cvgN</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveN</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (- <span class="id">f</span>) <span class="id">x</span> = - '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>: <span class="id">cvg_lim</span> (<span class="id">der_opp</span> <span class="id">df</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableN</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (- <span class="id">f</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
 <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.derive.html#deriveN">move</a></span>=&gt; <span class="id">df</span>; <span class="id"><a href="mathcomp.analysis.derive.html#derive_val">apply</a></span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> (- '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>); <span class="id">apply</span>: <span class="id">der_opp</span>. Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveN</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id"><a href="mathcomp.analysis.derive.html#is_derive">df</a></span> : <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">x</a></span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (- <span class="id">f</span>) (- <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivableN</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveN</span> // <span class="id">derive_val</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveB</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> <span class="id">dg</span> : <span class="id">W</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">g</span> <span class="id">dg</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">f</span> - <span class="id">g</span>) (<span class="id">df</span> - <span class="id">dg</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ??; <span class="id">apply</span>: <span class="id">is_derive_eq</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveB</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="id">f</span> - <span class="id">g</span>) <span class="id">x</span> = '<span class="id">D_v</span> <span class="id">f</span> <span class="id"><a name="der_scal">x</a></span> - '<span class="id">D_v</span> <span class="id">g</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">derivableP</span> <span class="id">df</span> /<span class="id">derivableP</span> <span class="id">dg</span>; <span class="id">rewrite</span> <span class="id">derive_val</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableB</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="id">f</span> - <span class="id">g</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">derivableP</span> <span class="id">df</span> /<span class="id">derivableP</span> <span class="id">dg</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">der_scal</span> <span class="id">f</span> (<span class="id">k</span> : <span class="id">R</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: ((<span class="id">k</span> \*: <span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) (<span class="id">h</span> *: <span class="id">v</span>) - (<span class="id">k</span> \*: <span class="id">f</span>) <span class="id">x</span>)) @<br/>
&nbsp;&nbsp;(0 : <span class="id">R</span>)^' --&gt; <span class="id">k</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
<span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">evar</span> (<span class="id">h</span> : <span class="id">R</span> -&gt; <span class="id">W</span>); <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = <span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">h</a></span>) /=; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">scalerBr</span> !<span class="id">scalerA</span> <span class="id">mulrC</span> -!<span class="id">scalerA</span> -!<span class="id">scalerBr</span> /<span class="id">h</span>.<br/>
<span class="id">exact</span>: <span class="id">cvgZr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveZ</span> <span class="id">f</span> (<span class="id"><a href="mathcomp.analysis.topology.html#cvg_ex">k</a></span> : <span class="id">R</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="id">k</span> \*: <span class="id">f</span>) <span class="id">x</span> = <span class="id">k</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id"><a name="is_deriveZ">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>: <span class="id">cvg_lim</span> (<span class="id">der_scal</span> <span class="id">df</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.derive.html#is_derive">derivableZ</a></span> <span class="id">f</span> (<span class="id">k</span> : <span class="id">R</span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="id">k</span> \*: <span class="id">f</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span>; <span class="id">apply</span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> (<span class="id">k</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>); <span class="id">apply</span>: <span class="id">der_scal</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveZ</span> <span class="id">f</span> (<span class="id">k</span> : <span class="id"><a name="Derive_lemmasVR.R">R</a></span>) (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> : <span class="id"><a name="Derive_lemmasVR.V">W</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">k</span> \*: <span class="id">f</span>) (<span class="id">k</span> *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivableZ</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveZ</span> // <span class="id">derive_val</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Derive_lemmasVW</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVR.R">Derive_lemmasVR</a></span>.<br/>
<span class="kwd">Variables</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">V</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">f</span> <span class="id">g</span> : <span class="id">V</span> -&gt; <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">der_mult</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (((<span class="id">f</span> * <span class="id">g</span>) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) (<span class="id">h</span> *: <span class="id">v</span>) - (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span>)) @<br/>
&nbsp;&nbsp;(0 : <span class="id">R</span>)^' --&gt; <span class="id">f</span> <span class="id">x</span> *: '<span class="id">D_v</span> <span class="id">g</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>.<br/>
<span class="id">evar</span> (<span class="id">fg</span> : <span class="id">R</span> -&gt; <span class="id">R</span>); <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = <span class="id">fg</span>) /=; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : (<span class="id">f</span> * <span class="id">g</span>) (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) - (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) *: (<span class="id">g</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) - <span class="id">g</span> <span class="id">x</span>) + <span class="id">g</span> <span class="id">x</span> *: (<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) - <span class="id">f</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">scalerBr</span> -<span class="id">addrA</span> ![<span class="id">g</span> <span class="id">x</span> *: <span class="id">_</span>]<span class="id">mulrC</span> <span class="id">addKr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">scalerDr</span> <span class="id">scalerA</span> <span class="id">mulrC</span> -<span class="id">scalerA</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">_</span> *: (<span class="id">g</span> <span class="id">x</span> *: <span class="id">_</span>)]<span class="id">scalerA</span> <span class="id">mulrC</span> -<span class="id">scalerA</span> /<span class="id">fg</span>.<br/>
<span class="id">apply</span>: <span class="id">cvgD</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">cvgZr</span> <span class="id">df</span>.<br/>
<span class="id">apply</span>: <span class="id">cvg_comp2</span> (@<span class="id">mul_continuous</span> <span class="id">_</span> (<span class="id">_</span>, <span class="id">_</span>)) =&gt; /=; <span class="id">last</span> <span class="id">exact</span>: <span class="id">dg</span>.<br/>
<span class="id">suff</span> : {<span class="kwd">for</span> 0, <span class="id">continuous</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">f</span>(<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>))}.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">continuous_withinNx</span>; <span class="id">rewrite</span> <span class="id">scale0r</span> <span class="id">add0r</span>.<br/>
<span class="id">exact</span>/<span class="id">differentiable_continuous</span>/<span class="id">derivable1_diffP</span>/(<span class="id">derivable1P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).1.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveM</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span> *: '<span class="id">D_v</span> <span class="id">g</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>: <span class="id">cvg_lim</span> (<span class="id">der_mult</span> <span class="id">df</span> <span class="id">dg</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableM</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="id">f</span> * <span class="id">g</span>) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> (<span class="id">f</span> <span class="id">x</span> *: '<span class="id">D_v</span> <span class="id">g</span> <span class="id">x</span> + <span class="id">g</span> <span class="id"><a href="mathcomp.analysis.derive.html#derivableM">x</a></span> *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>).<br/>
<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.derive.html#deriveM">der_mult</a></span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveM</span> <span class="id">f</span> <span class="id">g</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> <span class="id">dg</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">g</span> <span class="id">dg</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">f</span> * <span class="id">g</span>) (<span class="id">f</span> <span class="id">x</span> *: <span class="id">dg</span> + <span class="id">g</span> <span class="id">x</span> *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
<span class="id">move</span>=&gt; <span class="id">dfx</span> <span class="id">dgx</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">derivableM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveM</span> // !<span class="id">derive_val</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveX</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) (<span class="id">df</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">f</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> (<span class="id">f</span> ^+ <span class="id">n</span>.+1) ((<span class="id">n</span>.+1%:<span class="id">R</span> * <span class="id">f</span> <span class="id">x</span> ^+<span class="id">n</span>) *: <span class="id">df</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
<span class="id">move</span>=&gt; <span class="id">dfx</span>; <span class="id">elim</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> <span class="id">ihn</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expr1</span> <span class="id">expr0</span> <span class="id">mulr1</span> <span class="id">scale1r</span>.<br/>
<span class="id"><a href="mathcomp.analysis.derive.html#derivableP">rewrite</a></span> <span class="id">exprS</span>; <span class="id">apply</span>: <span class="id">is_derive_eq</span>.<br/>
<span class="id">rewrite</span> <span class="id">scalerA</span> -<span class="id">scalerDl</span> <span class="id">mulrCA</span> -[<span class="id">f</span> <span class="id">x</span> * <span class="id">_</span>]<span class="id">exprS</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="kwd">in</span> <span class="id">LHS</span>]<span class="id">mulr_natl</span> <span class="id">exprfctE</span> -<span class="id">mulrSr</span> <span class="id">mulr_natl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableX</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="id">f</span> ^+ <span class="id">n</span>.+1) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">derivableP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveX</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id"><a href="mathcomp.analysis.normedtype.html#shift">V</a></span>) : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="id">f</span> ^+ <span class="id">n</span>.+1) <span class="id">x</span> = (<span class="id">n</span>.+1%:<span class="id">R</span> * <span class="id">f</span> <span class="id">x</span> ^+ <span class="id">n</span>) *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">derivableP</span> <span class="id">df</span>; <span class="id">rewrite</span> <span class="id">derive_val</span>. Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">der_inv</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">f</span> <span class="id">x</span> != 0 -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (((<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>)^-1) \<span class="id">o</span> <span class="id">shift</span> <span class="id">x</span>) (<span class="id">h</span> *: <span class="id">v</span>) - (<span class="id">f</span> <span class="id">x</span>)^-1)) @<br/>
&nbsp;&nbsp;(0 : <span class="id">R</span>)^' --&gt; - (<span class="id">f</span> <span class="id">x</span>) ^-2 *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof131')">Proof.</span></div>
<div class="proofscript" id="proof131">
<span class="id">move</span>=&gt; <span class="id">fxn0</span> <span class="id">df</span>.<br/>
<span class="id">have</span> /<span class="id">derivable1P</span>/<span class="id">derivable1_diffP</span>/<span class="id">differentiable_continuous</span> := <span class="id">df</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id">continuous_withinNx</span>; <span class="id">rewrite</span> <span class="id">scale0r</span> <span class="id">add0r</span> =&gt; <span class="id">fc</span>.<br/>
<span class="id">have</span> <span class="id">fn0</span> : (0 : <span class="id">R</span>)^' [<span class="id">set</span> <span class="id">h</span> | <span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) != 0].<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (<span class="id">fc</span> [<span class="id">set</span> <span class="id">x</span> | <span class="id">x</span> != 0]); <span class="kwd">exists</span> `|<span class="id">f</span> <span class="id">x</span>|; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">normr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">y</span>; <span class="id">rewrite</span> /= =&gt; <span class="id">yltfx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span> =&gt; <span class="id">y0</span>; <span class="id">move</span>: <span class="id">yltfx</span>; <span class="id">rewrite</span> <span class="id">y0</span> <span class="id">subr0</span> <span class="id">ltxx</span>.<br/>
<span class="id">have</span> : (<span class="kwd">fun</span> <span class="id">h</span> =&gt; - ((<span class="id">f</span> <span class="id">x</span>)^-1 * (<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>))^-1) *:<br/>
&nbsp;&nbsp;(<span class="id">h</span>^-1 *: (<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) - <span class="id">f</span> <span class="id">x</span>))) @ (0 : <span class="id">R</span>)^' --&gt;<br/>
&nbsp;&nbsp;- (<span class="id">f</span> <span class="id">x</span>) ^- 2 *: '<span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVR.R">D_v</a></span> <span class="id">f</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvgM</span> =&gt; //; <span class="id">apply</span>: <span class="id">cvgN</span>; <span class="id">rewrite</span> <span class="id">expr2</span> <span class="id">invfM</span>; <span class="id">apply</span>: <span class="id">cvgM</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">exact</span>: <span class="id">cvg_cst</span>|  <span class="id">exact</span>: <span class="id">cvgV</span>].<br/>
<span class="id">apply</span>: <span class="id">cvg_trans</span> =&gt; <span class="id">A</span> [<span class="id">_</span>/<span class="id">posnumP</span>[<span class="id">e</span>] /= <span class="id">Ae</span>].<br/>
<span class="id">move</span>: <span class="id">fn0</span>; <span class="id">apply</span>: <span class="id">filter_app</span>; <span class="id">near</span>=&gt; <span class="id">h</span> =&gt; /= <span class="id">fhvxn0</span>.<br/>
<span class="id">have</span> <span class="id">he</span> : <span class="id">ball</span> 0 <span class="id">e</span>%:<span class="id">num</span> (<span class="id">h</span> : <span class="id">R</span>) <span class="kwd">by</span> <span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">e</span>%:<span class="id">num</span> =&gt; /=.<br/>
<span class="id">have</span> <span class="id">hn0</span> : <span class="id">h</span> != 0 <span class="kwd">by</span> <span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">e</span>%:<span class="id">num</span> =&gt; /=.<br/>
<span class="id">suff</span> &lt;- :<br/>
&nbsp;&nbsp;- ((<span class="id">f</span> <span class="id">x</span>)^-1 * (<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>))^-1) *: (<span class="id">h</span>^-1 *: (<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>) - <span class="id">f</span> <span class="id">x</span>)) =<br/>
&nbsp;&nbsp;<span class="id">h</span>^-1 *: ((<span class="id">f</span> (<span class="id">h</span> *: <span class="id">v</span> + <span class="id">x</span>))^-1 - (<span class="id">f</span> <span class="id">x</span>)^-1) <span class="kwd">by</span> <span class="id">exact</span>: <span class="id">Ae</span>.<br/>
<span class="id">rewrite</span> <span class="id">scalerA</span> <span class="id">mulrC</span> -<span class="id">scalerA</span>; <span class="id">congr</span> (<span class="id">_</span> *: <span class="id">_</span>).<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">scaleNr</span> <span class="id">eqr_oppLR</span> <span class="id">opprB</span> <span class="id">scalerBr</span>.<br/>
<span class="id">rewrite</span> -<span class="id">scalerA</span> [<span class="id">_</span> *: <span class="id">f</span> <span class="id">_</span>]<span class="id">mulVf</span> // [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span> -<span class="id">scalerA</span> [<span class="id">_</span> *: <span class="id">f</span> <span class="id">_</span>]<span class="id">mulVf</span> // [<span class="id">_</span>%:<span class="id">A</span>]<span class="id"><a href="mathcomp.analysis.derive.html#Derive_lemmasVR.V">mulr1</a></span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">deriveV</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> : <span class="id">f</span> <span class="id">x</span> != 0 -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">D_v</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>)^-1) <span class="id">x</span> = - (<span class="id">f</span> <span class="id">x</span>) ^- 2 *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fxn0</span> <span class="id">df</span>; <span class="id">apply</span>: <span class="id">cvg_lim</span> (<span class="id">der_inv</span> <span class="id">fxn0</span> <span class="id">df</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivableV</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) :<br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">x</span> != 0 -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id">derivable</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id">f</span> <span class="id">y</span>)^-1) <span class="id">x</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof133')">Proof.</span></div>
<div class="proofscript" id="proof133">
<span class="id">move</span>=&gt; <span class="id">df</span> <span class="id">dg</span>; <span class="id">apply</span>/<span class="id">cvg_ex</span>; <span class="kwd">exists</span> (- (<span class="id">f</span> <span class="id">x</span>) ^- 2 *: '<span class="id">D_v</span> <span class="id">f</span> <span class="id">x</span>).<br/>
<span class="id">exact</span>: <span class="id">der_inv</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1_cst</span> (<span class="id">k</span> : <span class="id">V</span>) <span class="id">t</span> : (<span class="id">cst</span> <span class="id">k</span>)^`() <span class="id">t</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof134')">Proof.</span></div>
<div class="proofscript" id="proof134">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive1E</span> <span class="id">derive_val</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Derive_lemmasVR</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">EVT_max</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) : <br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; {<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt; <span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> &amp;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id">t</span> &lt;= <span class="id">f</span> <span class="id">c</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
<span class="id">move</span>=&gt; <span class="id">leab</span> <span class="id">fcont</span>; <span class="id">set</span> <span class="id">imf</span> := <span class="id">f</span> @` `[<span class="id">a</span>, <span class="id">b</span>].<br/>
<span class="id">have</span> <span class="id">imf_sup</span> : <span class="id">has_sup</span> <span class="id">imf</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="kwd">exists</span> (<span class="id">f</span> <span class="id">a</span>); <span class="id">apply</span>/<span class="id">imageP</span>; <span class="id">rewrite</span> /= <span class="id">in_itv</span> /= <span class="id">lexx</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> [<span class="id">M</span> [<span class="id">Mreal</span> <span class="id">imfltM</span>]] : <span class="id">bounded_set</span> (<span class="id">f</span> @` `[<span class="id">a</span>, <span class="id"><a href="mathcomp.analysis.reals.html#sup">b</a></span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">compact_bounded</span>/<span class="id">continuous_compact</span> =&gt; //; <span class="id">exact</span>: <span class="id">segment_compact</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">M</span> + 1) =&gt; <span class="id">y</span> /<span class="id">imfltM</span> <span class="id">yleM</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">yleM</span> <span class="id">_</span> <span class="id">_</span>)) ?<span class="id">ler_norm</span> ?<span class="id">ltr_addl</span>.<br/>
<span class="id">have</span> [|<span class="id">imf_ltsup</span>] := <span class="id">pselect</span> (<span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> &amp; <span class="id">f</span> <span class="id">c</span> = <span class="id">sup</span> <span class="id">imf</span>).<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; [<span class="id">c</span> <span class="id">cab</span> <span class="id">fceqsup</span>]; <span class="kwd">exists</span> <span class="id">c</span> =&gt; // <span class="id">t</span> <span class="id">tab</span>; <span class="id">rewrite</span> <span class="id">fceqsup</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">sup_upper_bound</span> =&gt; //; <span class="id">exact</span>/<span class="id">imageP</span>.<br/>
<span class="id">have</span> {}<span class="id">imf_ltsup</span> <span class="id">t</span> : <span class="id">t</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id">t</span> &lt; <span class="id">sup</span> <span class="id">imf</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">tab</span>; <span class="id">case</span>: (<span class="id">ltrP</span> (<span class="id">f</span> <span class="id">t</span>) (<span class="id">sup</span> <span class="id">imf</span>)) =&gt; // <span class="id">supleft</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">falseE</span>; <span class="id">apply</span>: <span class="id">imf_ltsup</span>; <span class="kwd">exists</span> <span class="id">t</span> =&gt; //; <span class="id">apply</span>/<span class="id">eqP</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">eq_le</span> <span class="id">supleft</span> <span class="id">andbT</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">sup_upper_bound</a></span>//; <span class="id">exact</span>/<span class="id">imageP</span>.<br/>
<span class="id">pose</span> <span class="id"><a href="mathcomp.analysis.topology.html#cst_continuous">g</a></span> <span class="id">t</span> : <span class="id">R</span> := (<span class="id">sup</span> <span class="id">imf</span> - <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.normedtype.html#cvgN">t</a></span>)^-1.<br/>
<span class="id">have</span> <span class="id">invf_continuous</span> : {<span class="id"><a href="mathcomp.analysis.normedtype.html#ex_strict_bound_gt0">within</a></span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">g</span>}.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">continuous_subspace_in</span> =&gt; <span class="id">t</span> <span class="id">tab</span>; <span class="id">apply</span>: <span class="id">cvgV</span> =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_eq0</span> <span class="id">gt_eqF</span> // <span class="id">imf_ltsup</span> //; <span class="id">rewrite</span> <span class="id">inE</span> <span class="kwd">in</span> <span class="id">tab</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvgD</span>; [<span class="id">exact</span>: <span class="id">cst_continuous</span> | <span class="id">apply</span>: <span class="id">cvgN</span>; <span class="id">exact</span>: (<span class="id">fcont</span> <span class="id">t</span>)].<br/>
<span class="id">have</span> /<span class="id"><a href="mathcomp.analysis.reals.html#sup_adherent">ex_strict_bound_gt0</a></span> [<span class="id">k</span> <span class="id">k_gt0</span> /= <span class="id">imVfltk</span>] : <span class="id">bounded_set</span> (<span class="id">g</span> @` `[<span class="id">a</span>, <span class="id">b</span>]).<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">compact_bounded</span>/<span class="id">continuous_compact</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">segment_compact</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">invf_continuous</span>.<br/>
<span class="id">have</span> [<span class="id">_</span> [<span class="id">t</span> <span class="id">tab</span> &lt;-]] : <span class="kwd">exists2</span> <span class="id">y</span>, <span class="id">imf</span> <span class="id">y</span> &amp; <span class="id">sup</span> <span class="id">imf</span> - <span class="id">k</span>^-1 &lt; <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">sup_adherent</span> =&gt; //; <span class="id">rewrite</span> <span class="id">invr_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">ltr_subl_addr</span> -<span class="id"><a name="EVT_min">ltr_subl_addl</a></span>.<br/>
<span class="id">suff</span> : <span class="id">sup</span> <span class="id">imf</span> - <span class="id">f</span> <span class="id">t</span> &gt; <span class="id">k</span>^-1 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">ltW</span>; <span class="id">rewrite</span> <span class="id">leNgt</span> =&gt; /<span class="id">negbTE</span> -&gt;.<br/>
<span class="id">rewrite</span> -[<span class="id">ltRHS</span>]<span class="id">invrK</span> <span class="id">ltf_pinv</span>// ?<span class="id">qualifE</span> ?<span class="id">invr_gt0</span> ?<span class="id">subr_gt0</span> ?<span class="id">imf_ltsup</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_norm</span> <span class="id">_</span>) <span class="id">_</span>) ?<span class="id">imVfltk</span>//; <span class="id">exact</span>: <span class="id">imageP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">EVT_min</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; {<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt; <span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> &amp;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id">c</span> &lt;= <span class="id">f</span> <span class="id">t</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
<span class="id">move</span>=&gt; <span class="id">leab</span> <span class="id">fcont</span>.<br/>
<span class="id">have</span> /(<span class="id">EVT_max</span> <span class="id">leab</span>) [<span class="id">c</span> <span class="id">clr</span> <span class="id">fcmax</span>] : {<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> (- <span class="id">f</span>)}.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">apply</span>: <span class="id">continuousN</span> =&gt; ?; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">fcont</a></span>.<br/>
<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">c</span> =&gt; // ? /<span class="id">fcmax</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.topology.html#nbhs_ballP">ler_opp2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">__deprecated__le0r_cvg_map</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">T</span> : <span class="id">topologicalType</span>) (<span class="id">F</span> : <span class="id">set</span> (<span class="id">set</span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;(<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id">F</span>) (<span class="id">f</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(\<span class="kwd">forall</span> <span class="id"><a name="cvg_at_leftE">x</a></span> \<span class="id">near</span> <span class="id">F</span>, 0 &lt;= <span class="id">f</span> <span class="id">x</span>) -&gt; <span class="id">cvg</span> (<span class="id">f</span> @ <span class="id">F</span>) -&gt; 0 &lt;= <span class="id">lim</span> (<span class="id">f</span> @ <span class="id">F</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">rewrite</span> <span class="id">limr_ge</span>. Qed.</div>
#[<span class="id">deprecated</span>(<span class="id">since</span>="<span class="id">mathcomp</span>-<span class="id">analysis</span> 0.6.0",<br/>
&nbsp;&nbsp;<span class="id">note</span>="<span class="id">generalized</span> <span class="kwd">by</span> `<span class="id">limr_ge</span>`")]<br/>
<span class="kwd">Notation</span> <span class="id">le0r_cvg_map</span> := <span class="id">__deprecated__le0r_cvg_map</span> (<span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">__deprecated__ler0_cvg_map</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">T</span> : <span class="id">topologicalType</span>) (<span class="id">F</span> : <span class="id">set</span> (<span class="id">set</span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;(<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id">F</span>) (<span class="id">f</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(\<span class="kwd">forall</span> <span class="id">x</span> \<span class="id"><a name="__deprecated__le0r_cvg_map">near</a></span> <span class="id">F</span>, <span class="id">f</span> <span class="id">x</span> &lt;= 0) -&gt; <span class="id">cvg</span> (<span class="id">f</span> @ <span class="id">F</span>) -&gt; <span class="id">lim</span> (<span class="id">f</span> @ <span class="id">F</span>) &lt;= 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ?; <span class="id">rewrite</span> <span class="id">limr_le</span>. Qed.</div>
#[<span class="id">deprecated</span>(<span class="id">since</span>="<span class="id">mathcomp</span>-<span class="id">analysis</span> 0.6.0",<br/>
&nbsp;&nbsp;<span class="id">note</span>="<span class="id">generalized</span> <span class="kwd">by</span> `<span class="id">limr_le</span>`")]<br/>
<span class="kwd">Notation</span> <span class="id">ler0_cvg_map</span> := <span class="id">__deprecated__ler0_cvg_map</span> (<span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">__deprecated__ler_cvg_map</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">T</span> : <span class="id">topologicalType</span>) (<span class="id">F</span> : <span class="id">set</span> (<span class="id">set</span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id">F</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(\<span class="kwd">forall</span> <span class="id">x</span> \<span class="id">near</span> <span class="id">F</span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>) -&gt; <span class="id">cvg</span> (<span class="id">f</span> @ <span class="id">F</span>) -&gt; <span class="id">cvg</span> (<span class="id">g</span> @ <span class="id">F</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">lim</span> (<span class="id">f</span> @ <span class="id">F</span>) &lt;= <span class="id">lim</span> (<span class="id">g</span> @ <span class="id">F</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ? ? ?; <span class="id">rewrite</span> <span class="id">ler_lim</span>. Qed.</div>
#[<span class="id">deprecated</span>(<span class="id">since</span>="<span class="id">mathcomp</span>-<span class="id"><a href="mathcomp.analysis.topology.html#lim">analysis</a></span> 0.6.0",<br/>
&nbsp;&nbsp;<span class="id">note</span>="<span class="id">subsumed</span> <span class="kwd">by</span> `<span class="id">ler_lim</span>`")]<br/>
<span class="kwd">Notation</span> <span class="id">ler_cvg_map</span> := <span class="id">__deprecated__ler_cvg_map</span> (<span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1_at_max</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; (<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">t</span> 1) -&gt; <span class="id">c</span> \<span class="kwd">in</span> `]<span class="id"><a href="mathcomp.analysis.topology.html#Topological.Exports.topologicalType">a</a></span>, <span class="id">b</span>[%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id"><a href="mathcomp.analysis.topology.html#ProperFilter">t</a></span> &lt;= <span class="id">f</span> <span class="id">c</span>) -&gt; <span class="id">is_derive</span> <span class="id">c</span> 1 <span class="id">f</span> 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof140')">Proof.</span></div>
<div class="proofscript" id="proof140">
<span class="id">move</span>=&gt; <span class="id">leab</span> <span class="id">fdrvbl</span> <span class="id">cab</span> <span class="id">cmax</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_le</span>; <span class="id">apply</span>/<span class="id">andP</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> ['<span class="id">D_1</span> <span class="id">f</span> <span class="id">c</span>]<span class="id">cvg_at_rightE</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">limr_le</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span> /<span class="id">fdrvbl</span> <span class="id">dfc</span> := <span class="id">cab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> -(<span class="id">cvg_at_rightE</span> (<span class="kwd">fun</span> <span class="id">h</span> : <span class="id">R</span> =&gt; <span class="id">h</span>^-1 *: ((<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">c</span>) <span class="id">_</span> - <span class="id">f</span> <span class="id">c</span>))) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">cvg_trans</span> <span class="id">dfc</span>; <span class="id">apply</span>: <span class="id">cvg_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">A</span> [<span class="id">e</span> <span class="id">egt0</span> <span class="id">Ae</span>]; <span class="kwd">exists</span> <span class="id">e</span> =&gt; // <span class="id">x</span> <span class="id">xe</span> <span class="id">xgt0</span>; <span class="id">apply</span>: <span class="id">Ae</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">lt0r_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">near</span>=&gt; <span class="id">h</span>; <span class="id">apply</span>: <span class="id">mulr_ge0_le0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_ge0</span>; <span class="id">apply</span>: <span class="id">ltW</span>; <span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> 1 =&gt; /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">subr_le0</span> [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>; <span class="id">apply</span>: <span class="id">cmax</span>; <span class="id">near</span>: <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">b</span> - <span class="id">c</span>); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">subr_gt0</span> (<span class="id">itvP</span> <span class="id">cab</span>).<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> /= <span class="id">distrC</span> <span class="id">subr0</span> /= <span class="id">in_itv</span> /= -<span class="id">ltr_subr_addr</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; /(<span class="id">le_lt_trans</span> (<span class="id">ler_norm</span> <span class="id">_</span>)) -&gt; /<span class="id">ltr_spsaddl</span> -&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">itvP</span> <span class="id">cab</span>).<br/>
<span class="id">rewrite</span> ['<span class="id">D_1</span> <span class="id">f</span> <span class="id">c</span>]<span class="id">cvg_at_leftE</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
<span class="id">apply</span>: <span class="id">limr_ge</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> /<span class="id">fdrvbl</span> <span class="id">dfc</span> := <span class="id">cab</span>; <span class="id">rewrite</span> -(<span class="id">cvg_at_leftE</span> (<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: ((<span class="id">f</span> \<span class="id">o</span> <span class="id">shift</span> <span class="id">c</span>) <span class="id">_</span> - <span class="id">f</span> <span class="id">c</span>))) //.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">cvg_trans</span> <span class="id">dfc</span>; <span class="id">apply</span>: <span class="id">cvg_app</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">A</span> [<span class="id">e</span> <span class="id">egt0</span> <span class="id">Ae</span>]; <span class="kwd">exists</span> <span class="id">e</span> =&gt; // <span class="id">x</span> <span class="id">xe</span> <span class="id">xgt0</span>; <span class="id">apply</span>: <span class="id">Ae</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">ltr0_neq0</span>.<br/>
<span class="id">near</span>=&gt; <span class="id">h</span>; <span class="id">apply</span>: <span class="id">mulr_le0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_le0</span>; <span class="id">apply</span>: <span class="id">ltW</span>; <span class="id">near</span>: <span class="id">h</span>; <span class="kwd">exists</span> 1 =&gt; /=.<br/>
<span class="id">rewrite</span> <span class="id">subr_le0</span> [<span class="id">_</span>%:<span class="id">A</span>]<span class="id">mulr1</span>; <span class="id">apply</span>: <span class="id">cmax</span>; <span class="id">near</span>: <span class="id">h</span>.<br/>
<span class="kwd">exists</span> (<span class="id">c</span> - <span class="id">a</span>); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">subr_gt0</span> (<span class="id">itvP</span> <span class="id">cab</span>).<br/>
<span class="id">move</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> /= <span class="id">distrC</span> <span class="id">subr0</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id">ltr_normlP</span> []; <span class="id">rewrite</span> <span class="id">ltr_subr_addl</span> <span class="id">ltr_subl_addl</span> <span class="id">in_itv</span> /= =&gt; -&gt; <span class="id">_</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">ltr_snsaddl</span> -&gt; //; <span class="id">rewrite</span> (<span class="id">itvP</span> <span class="id">cab</span>).<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1_at_min</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; (<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">t</span> 1) -&gt; <span class="id">c</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">t</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id">c</span> &lt;= <span class="id">f</span> <span class="id">t</span>) -&gt; <span class="id">is_derive</span> <span class="id">c</span> 1 <span class="id">f</span> 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</span></div>
<div class="proofscript" id="proof141">
<span class="id">move</span>=&gt; <span class="id">leab</span> <span class="id">fdrvbl</span> <span class="id">cab</span> <span class="id">cmin</span>; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> -<span class="id">oppr_eq0</span>; <span class="id">apply</span>/<span class="id">eqP</span>.<br/>
<span class="id">rewrite</span> -<span class="id">deriveN</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
<span class="id">suff</span> <span class="id">df</span> : <span class="id">is_derive</span> <span class="id">c</span> 1 (- <span class="id">f</span>) 0 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive_val</span>.<br/>
<span class="id">apply</span>: <span class="id">derive1_at_max</span> <span class="id">leab</span> <span class="id">_</span> (<span class="id">cab</span>) <span class="id">_</span> =&gt; <span class="id">t</span> <span class="id">tab</span>; <span class="id">first</span> <span class="id">exact</span>/<span class="id">derivableN</span>/<span class="id">fdrvbl</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_opp2</span>; <span class="id">apply</span>: <span class="id">cmin</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rolle</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt; <span class="id"><a href="mathcomp.analysis.derive.html#derivable">b</a></span> -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt; <span class="id">f</span> <span class="id">a</span> = <span class="id">f</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> &amp; <span class="id">is_derive</span> <span class="id">c</span> 1 <span class="id">f</span> 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</span></div>
<div class="proofscript" id="proof142">
<span class="id">move</span>=&gt; <span class="id">ltab</span> <span class="id">fdrvbl</span> <span class="id">fcont</span> <span class="id">faefb</span>.<br/>
<span class="id">have</span> [<span class="id">cmax</span> <span class="id">cmaxab</span> <span class="id">fcmax</span>] := <span class="id">EVT_max</span> (<span class="id"><a href="mathcomp.analysis.derive.html#deriveN">ltW</a></span> <span class="id">ltab</span>) <span class="id">fcont</span>.<br/>
<span class="id">have</span> [<span class="id">cmaxeaVb</span>|] := <span class="id">boolP</span> (<span class="id">cmax</span> \<span class="kwd">in</span> [<span class="id">set</span> <span class="id">a</span>; <span class="id">b</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">notin_set</span> =&gt; /<span class="id">not_orP</span>[/<span class="id">eqP</span> <span class="id">cnea</span> /<span class="id">eqP</span> <span class="id">cneb</span>].<br/>
&nbsp;&nbsp;<span class="id">have</span> {}<span class="id">cmaxab</span> : <span class="id">cmax</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span> /= !<span class="id">lt_def</span> !(<span class="id">itvP</span> <span class="id">cmaxab</span>) <span class="id">cnea</span> <span class="id">eq_sym</span> <span class="id">cneb</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">cmax</span> =&gt; //; <span class="id">apply</span>: <span class="id">derive1_at_max</span> (<span class="id">ltW</span> <span class="id">ltab</span>) <span class="id">fdrvbl</span> <span class="id">cmaxab</span> <span class="id">_</span> =&gt; <span class="id">t</span> <span class="id">tab</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">fcmax</span>; <span class="id">rewrite</span> <span class="id">in_itv</span> /= !<span class="id">ltW</span> // (<span class="id">itvP</span> <span class="id">tab</span>).<br/>
<span class="id">have</span> [<span class="id">cmin</span> <span class="id">cminab</span> <span class="id">fcmin</span>] := <span class="id">EVT_min</span> (<span class="id">ltW</span> <span class="id">ltab</span>) <span class="id">fcont</span>.<br/>
<span class="id">have</span> [<span class="id">cmineaVb</span>|] := <span class="id">boolP</span> (<span class="id">cmin</span> \<span class="kwd">in</span> [<span class="id">set</span> <span class="id">a</span>; <span class="id">b</span>]); <span class="id">last</span> <span class="id"><a href="mathcomp.analysis.derive.html#EVT_max">first</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">notin_set</span> =&gt; /<span class="id">not_orP</span>[/<span class="id">eqP</span> <span class="id">cnea</span> /<span class="id">eqP</span> <span class="id">cneb</span>].<br/>
&nbsp;&nbsp;<span class="id">have</span> {}<span class="id">cminab</span> : <span class="id">cmin</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span> /= !<span class="id">lt_def</span> !(<span class="id">itvP</span> <span class="id">cminab</span>) <span class="id">cnea</span> <span class="id">eq_sym</span> <span class="id">cneb</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">cmin</span> =&gt; //; <span class="id">apply</span>: <span class="id">derive1_at_min</span> (<span class="id">ltW</span> <span class="id">ltab</span>) <span class="id">fdrvbl</span> <span class="id">cminab</span> <span class="id">_</span> =&gt; <span class="id">t</span> <span class="id">tab</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">fcmin</span>; <span class="id">rewrite</span> <span class="id">in_itv</span> /= !<span class="id">ltW</span> // (<span class="id">itvP</span> <span class="id">tab</span>).<br/>
<span class="id">have</span> <span class="id">midab</span> : (<span class="id">a</span> + <span class="id">b</span>) / 2 \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">mid_in_itvoo</span>.<br/>
<span class="kwd">exists</span> ((<span class="id">a</span> + <span class="id">b</span>) / 2) =&gt; //; <span class="id">apply</span>: <span class="id">derive1_at_max</span> (<span class="id">ltW</span> <span class="id">ltab</span>) <span class="id">fdrvbl</span> (<span class="id">midab</span>) <span class="id">_</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">t</span> <span class="id">tab</span>.<br/>
<span class="id">suff</span> <span class="id">fcst</span> <span class="id">s</span> : <span class="id">s</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">f</span> <span class="id">s</span> = <span class="id">f</span> <span class="id">cmax</span> <span class="kwd">by</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_set">rewrite</a></span> !<span class="id">fcst</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">sab</span>.<br/>
<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eq_le</span> <span class="id">fcmax</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">in_itv</span> /= !<span class="id">ltW</span> ?(<span class="id">itvP</span> <span class="id">sab</span>).<br/>
<span class="id">suff</span> -&gt; : <span class="id">f</span> <span class="id">cmax</span> = <span class="id">f</span> <span class="id">cmin</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fcmin</span> // <span class="id">in_itv</span> /= !<span class="id">ltW</span> ?(<span class="id">itvP</span> <span class="id">sab</span>).<br/>
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">cmaxeaVb</span> <span class="id">cmineaVb</span>; <span class="id">rewrite</span> 2!<span class="id">inE</span> =&gt; -[|] -&gt; [|] -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">MVT</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> <span class="id">df</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt; <span class="id">b</span> -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> 1 <span class="id">f</span> (<span class="id">df</span> <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> &amp; <span class="id">f</span> <span class="id">b</span> - <span class="id">f</span> <span class="id">a</span> = <span class="id">df</span> <span class="id">c</span> * (<span class="id">b</span> - <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</span></div>
<div class="proofscript" id="proof143">
<span class="id">move</span>=&gt; <span class="id">altb</span> <span class="id">fdrvbl</span> <span class="id">fcont</span>.<br/>
<span class="id">set</span> <span class="id">g</span> := <span class="id">f</span> + (- ( *:%<span class="id">R</span>^~ ((<span class="id">f</span> <span class="id">b</span> - <span class="id">f</span> <span class="id">a</span>) / (<span class="id">b</span> - <span class="id">a</span>)) : <span class="id">R</span> -&gt; <span class="id">R</span>)).<br/>
<span class="id">have</span> <span class="id">gdrvbl</span> <span class="id">x</span> : <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">g</span> <span class="id">x</span> 1.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">fdrvbl</span> <span class="id">dfx</span>; <span class="id">apply</span>: <span class="id">derivableB</span> =&gt; //; <span class="id">exact</span>/<span class="id">derivable1_diffP</span>.<br/>
<span class="id">have</span> <span class="id">gcont</span> : {<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">g</span>}.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">apply</span>: <span class="id">continuousD</span> <span class="id">_</span> ; <span class="id">first</span> <span class="kwd">by</span> <span class="id">move</span>=&gt;?; <span class="id">exact</span>: <span class="id">fcont</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">continuousN</span>/<span class="id">continuous_subspaceT</span>=&gt; ?; <span class="id">exact</span>: <span class="id">scalel_continuous</span>.<br/>
<span class="id">have</span> <span class="id">gaegb</span> : <span class="id">g</span> <span class="id">a</span> = <span class="id">g</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">g</span> -![(<span class="id">_</span> - <span class="id">_</span> : <span class="id">_</span> -&gt; <span class="id">_</span>) <span class="id">_</span>]/(<span class="id">_</span> - <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> -<span class="id">subr_eq</span> /= <span class="id">opprK</span> <span class="id">addrAC</span> -<span class="id">addrA</span> -<span class="id">scalerBl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">_</span> *: <span class="id">_</span>]<span class="id">mulrA</span> <span class="id">mulrC</span> <span class="id">mulrA</span> <span class="id">mulVf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul1r</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">lt0r_neq0</span>; <span class="id">rewrite</span> <span class="id">subr_gt0</span>.<br/>
<span class="id">have</span> [<span class="id">c</span> <span class="id">cab</span> <span class="id">dgc0</span>] := <span class="id">Rolle</span> <span class="id"><a href="mathcomp.analysis.derive.html#derivable1_diffP">altb</a></span> <span class="id">gdrvbl</span> <span class="id">gcont</span> <span class="id">gaegb</span>.<br/>
<span class="kwd">exists</span> <span class="id">c</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">cab</span>.<br/>
<span class="id">have</span> /<span class="id">fdrvbl</span> <span class="id">dfc</span> := <span class="id">cab</span>; <span class="id">move</span>/@<span class="id">derive_val</span>: <span class="id">dgc0</span>; <span class="id">rewrite</span> <span class="id">deriveB</span> //; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">derivable1_diffP</span>.<br/>
<span class="id">move</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> - <span class="id">X</span>]<span class="id">deriveE</span> // <span class="id">derive_val</span> <span class="id">diff_val</span> <span class="id">scale1r</span> <span class="id">subr_eq0</span>.<br/>
<span class="id">move</span>/<span class="id">eqP</span>-&gt;; <span class="id">rewrite</span> -<span class="id">mulrA</span> <span class="id">mulVf</span> ?<span class="id">mulr1</span> //; <span class="id">apply</span>: <span class="id">lt0r_neq0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">MVT_segment</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> <span class="id">df</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> 1 <span class="id">f</span> (<span class="id">df</span> <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">within</span> `[<span class="id">a</span>, <span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists2</span> <span class="id">c</span>, <span class="id">c</span> \<span class="kwd">in</span> `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span> &amp; <span class="id">f</span> <span class="id">b</span> - <span class="id">f</span> <span class="id">a</span> = <span class="id"><a href="mathcomp.analysis.derive.html#deriveB">df</a></span> <span class="id">c</span> * (<span class="id">b</span> - <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</span></div>
<div class="proofscript" id="proof144">
<span class="id">move</span>=&gt; <span class="id">leab</span> <span class="id">fdrvbl</span> <span class="id">fcont</span>; <span class="id">case</span>: <span class="id">ltgtP</span> <span class="id">leab</span> =&gt; // [<span class="id">altb</span>|<span class="id">aeb</span>]; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">a</span>; [<span class="id">rewrite</span> <span class="id">inE</span>/= <span class="id">aeb</span> <span class="id">lexx</span>|<span class="id">rewrite</span> <span class="id">aeb</span> !<span class="id">subrr</span> <span class="id">mulr0</span>].<br/>
<span class="id">have</span> [<span class="id">c</span> <span class="id">cab</span> <span class="id">D</span>] := <span class="id">MVT</span> <span class="id">altb</span> <span class="id">fdrvbl</span> <span class="id">fcont</span>.<br/>
<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">c</span> =&gt; //; <span class="id">rewrite</span> <span class="id">in_itv</span> /= <span class="id">ltW</span> (<span class="id">itvP</span> <span class="id">cab</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler0_derive1_nincr</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">f</span>^`() <span class="id">x</span> &lt;= 0) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">within</span> `[<span class="id">a</span>,<span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id">f</span> <span class="id">y</span> &lt;= <span class="id">f</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</span></div>
<div class="proofscript" id="proof145">
<span class="id">move</span>=&gt; <span class="id">fdrvbl</span> <span class="id">dfle0</span> <span class="id">ctsf</span> <span class="id">x</span> <span class="id">y</span> <span class="id">leax</span> <span class="id">lexy</span> <span class="id">leyb</span>; <span class="id">rewrite</span> -<span class="id">subr_ge0</span>.<br/>
<span class="id">case</span>: <span class="id">ltgtP</span> <span class="id">lexy</span> =&gt; // [<span class="id">xlty</span>|-&gt;]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subrr</span>.<br/>
<span class="id">have</span> <span class="id">itvW</span> : {<span class="id">subset</span> `[<span class="id">x</span>, <span class="id">y</span>]%<span class="id">R</span> &lt;= `[<span class="id">a</span>, <span class="id">b</span>]%<span class="id">R</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">subitvP</span>; <span class="id">rewrite</span> /&lt;=%<span class="id">O</span> /= /&lt;=%<span class="id">O</span> /= <span class="id">leyb</span> <span class="id">leax</span>.<br/>
<span class="id">have</span> <span class="id">itvWlt</span> : {<span class="id">subset</span> `]<span class="id">x</span>, <span class="id">y</span>[%<span class="id">R</span> &lt;= `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span> <span class="id">subitvP</span>; <span class="id">rewrite</span> /&lt;=%<span class="id">O</span> /= /&lt;=%<span class="id">O</span> /= <span class="id">leyb</span> <span class="id">leax</span>.<br/>
<span class="id">have</span> <span class="id">fdrv</span> <span class="id">z</span> : <span class="id">z</span> \<span class="kwd">in</span> `]<span class="id">x</span>, <span class="id">y</span>[%<span class="id">R</span> -&gt; <span class="id">is_derive</span> <span class="id">z</span> 1 <span class="id">f</span> (<span class="id">f</span>^`()<span class="id">z</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">in_itv</span>/= =&gt; /<span class="id">andP</span>[<span class="id">xz</span> <span class="id">zy</span>]; <span class="id">apply</span>: <span class="id">DeriveDef</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">derive1E</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">fdrvbl</span>; <span class="id">rewrite</span> <span class="id">in_itv</span>/= (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">xz</span>)// (<span class="id">lt_le_trans</span> <span class="id">zy</span>).<br/>
<span class="id">have</span> [] := @<span class="id">MVT</span> <span class="id">_</span> <span class="id">f</span> (<span class="id">f</span>^`()) <span class="id">x</span> <span class="id">y</span> <span class="id">xlty</span> <span class="id">fdrv</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (@<span class="id">continuous_subspaceW</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> `[<span class="id">a</span>,<span class="id">b</span>]); <span class="id">first</span> <span class="id">exact</span>: <span class="id">itvW</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">continuous_subspace_in</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">t</span> /<span class="id">itvWlt</span> <span class="id">dft</span> <span class="id">dftxy</span> <span class="id">_</span>; <span class="id">rewrite</span> -<span class="id">oppr_le0</span> <span class="id">opprB</span> <span class="id">dftxy</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">mulr_le0_ge0</span> =&gt; //; [<span class="id">exact</span>: <span class="id">dfle0</span>|<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_ge0</span> <span class="id">ltW</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">le0r_derive1_ndecr</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">x</span> \<span class="kwd">in</span> `]<span class="id">a</span>, <span class="id">b</span>[%<span class="id">R</span> -&gt; 0 &lt;= <span class="id">f</span>^`() <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;{<span class="id">within</span> `[<span class="id">a</span>,<span class="id">b</span>], <span class="id">continuous</span> <span class="id">f</span>} -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">f</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</span></div>
<div class="proofscript" id="proof146">
<span class="id">move</span>=&gt; <span class="id">fdrvbl</span> <span class="id">dfge0</span> <span class="id">fcont</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> -[<span class="id">f</span> <span class="id">_</span> &lt;= <span class="id">_</span>]<span class="id">ler_opp2</span>.<br/>
<span class="id">apply</span> (@<span class="id">ler0_derive1_nincr</span> <span class="id">_</span> (- <span class="id">f</span>)) =&gt; <span class="id">t</span> <span class="id">tab</span>; <span class="id">first</span> <span class="id">exact</span>/<span class="id">derivableN</span>/<span class="id">fdrvbl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">derive1E</span> <span class="id">deriveN</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">fdrvbl</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">oppr_le0</span> -<span class="id">derive1E</span>; <span class="id">apply</span>: <span class="id">dfge0</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">continuousN</span>; <span class="id">exact</span>: <span class="id">fcont</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive1_comp</span> (<span class="id">R</span> : <span class="id">realFieldType</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1 -&gt; <span class="id">derivable</span> <span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) 1 -&gt;<br/>
&nbsp;&nbsp;(<span class="id">g</span> \<span class="id">o</span> <span class="id">f</span>)^`() <span class="id">x</span> = <span class="id">g</span>^`() (<span class="id">f</span> <span class="id">x</span>) * <span class="id">f</span>^`() <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</span></div>
<div class="proofscript" id="proof147">
<span class="id">move</span>=&gt; /<span class="id">derivable1_diffP</span> <span class="id">df</span> /<span class="id">derivable1_diffP</span> <span class="id">dg</span>.<br/>
<span class="id">rewrite</span> <span class="id">derive1E</span>'; <span class="id">last</span> <span class="id">exact</span>/<span class="id">differentiable_comp</span>.<br/>
<span class="id">rewrite</span> <span class="id">diff_comp</span> // !<span class="id">derive1E</span>' //= -[<span class="id">X</span> <span class="kwd">in</span> '<span class="id">d</span>  <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> = <span class="id">_</span>]<span class="id">mulr1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">LHS</span>]<span class="id">linearZ</span> <span class="id">mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">is_derive_instances</span>.<br/>
<span class="kwd">Variables</span> (<span class="id">R</span> : <span class="id">numFieldType</span>) (<span class="id">V</span> : <span class="id">normedModType</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_cst</span> (<span class="id">x</span> : <span class="id">V</span>) : <span class="id">derivable</span> (<span class="kwd">fun</span>=&gt; <span class="id">x</span>) 0 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</span></div>
<div class="proofscript" id="proof148">
 <span class="id">exact</span>/<span class="id">diff_derivable</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_id</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">derivable</span> <span class="id">id</span> <span class="id"><a href="mathcomp.analysis.derive.html#derivable">x</a></span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</span></div>
<div class="proofscript" id="proof149">
 <span class="id">exact</span>/<span class="id">diff_derivable</span>. Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_derive_id</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> <span class="id">id</span> <span class="id">v</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</span></div>
<div class="proofscript" id="proof150">
<span class="id">apply</span>: (<span class="id">DeriveDef</span> (@<span class="id">derivable_id</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">deriveE</span>// (@<span class="id">diff_lin</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> [<span class="id">linear</span> <span class="id">of</span> <span class="id">idfun</span>]).<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_deriveNid</span> (<span class="id">x</span> <span class="id">v</span> : <span class="id">V</span>) : <span class="id">is_derive</span> <span class="id">x</span> <span class="id">v</span> -%<span class="id">R</span> (- <span class="id">v</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</span></div>
<div class="proofscript" id="proof151">
 <span class="id">exact</span>: <span class="id">is_deriveN</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a name="is_derive_instances.R">is_derive_instances</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">trigger_derive</span> (<span class="id">R</span> : <span class="id">realType</span>) (<span class="id">f</span> : <span class="id">R</span> -&gt; <span class="id">R</span>) <span class="id">x</span> <span class="id">x1</span> <span class="id">y1</span> :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id"><a name="derivable_id">x</a></span> 1 <span class="id">f</span> <span class="id">x1</span> -&gt; <span class="id">x1</span> = <span class="id">y1</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> 1 <span class="id">f</span> <span class="id">y1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</span></div>
<div class="proofscript" id="proof152">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Hi</span> &lt;-. Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
